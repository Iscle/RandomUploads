diff -ur a/packages/apps/Bluetooth/AndroidManifest.xml b/packages/apps/Bluetooth/AndroidManifest.xml
--- a/packages/apps/Bluetooth/AndroidManifest.xml	2018-08-06 15:42:22.108693819 +0200
+++ b/packages/apps/Bluetooth/AndroidManifest.xml	2017-11-23 05:22:29.000000000 +0100
@@ -385,5 +385,13 @@
                 android:name="android.accounts.AccountAuthenticator"
                 android:resource="@xml/authenticator" />
         </service>
+        <service
+            android:process="@string/process"
+            android:name = ".rtkbt.RtkbtService"
+            android:enabled="@bool/profile_supported_rtkbt">
+            <intent-filter>
+                <action android:name="android.bluetooth.IBluetoothRtkbt" />
+            </intent-filter>
+        </service>
     </application>
 </manifest>
diff -ur a/packages/apps/Bluetooth/Android.mk b/packages/apps/Bluetooth/Android.mk
--- a/packages/apps/Bluetooth/Android.mk	2018-08-06 15:42:22.084693511 +0200
+++ b/packages/apps/Bluetooth/Android.mk	2017-11-23 05:22:29.000000000 +0100
@@ -26,7 +26,7 @@
 LOCAL_STATIC_JAVA_LIBRARIES := com.android.vcard bluetooth.mapsapi sap-api-java-static android-support-v4 services.net
 LOCAL_PROTOC_OPTIMIZE_TYPE := micro
 
-LOCAL_REQUIRED_MODULES := bluetooth.default
+LOCAL_REQUIRED_MODULES := bluetooth.bcm.default bluetooth.usb.default bluetooth.rtk.default
 LOCAL_MULTILIB := 32
 
 LOCAL_PROGUARD_ENABLED := disabled
diff -ur a/packages/apps/Bluetooth/jni/Android.mk b/packages/apps/Bluetooth/jni/Android.mk
--- a/packages/apps/Bluetooth/jni/Android.mk	2018-08-06 15:42:22.108693819 +0200
+++ b/packages/apps/Bluetooth/jni/Android.mk	2017-11-23 05:22:29.000000000 +0100
@@ -16,8 +16,17 @@
     com_android_bluetooth_gatt.cpp \
     com_android_bluetooth_sdp.cpp
 
+ifeq ($(BOARD_HAVE_BLUETOOTH_RTK),true)
+LOCAL_CFLAGS += \
+    -DBLUETOOTH_RTK \
+    -DBLUETOOTH_RTK_API
+LOCAL_SRC_FILES += \
+    com_android_bluetooth_rtkbt.cpp
+endif
+
 LOCAL_C_INCLUDES += \
     $(JNI_H_INCLUDE) \
+    $(TOP)/hardware/aw/bluetooth/libaw/include
 
 LOCAL_SHARED_LIBRARIES := \
     libandroid_runtime \
@@ -27,6 +36,8 @@
     liblog \
     libhardware
 
+LOCAL_STATIC_LIBRARIES += libbt-aw libwifi_hardware_info
+
 LOCAL_MULTILIB := 32
 
 LOCAL_CFLAGS += -Wall -Wextra -Wno-unused-parameter
diff -ur a/packages/apps/Bluetooth/jni/com_android_bluetooth_btservice_AdapterService.cpp b/packages/apps/Bluetooth/jni/com_android_bluetooth_btservice_AdapterService.cpp
--- a/packages/apps/Bluetooth/jni/com_android_bluetooth_btservice_AdapterService.cpp	2018-08-06 15:42:22.108693819 +0200
+++ b/packages/apps/Bluetooth/jni/com_android_bluetooth_btservice_AdapterService.cpp	2017-11-23 05:22:29.000000000 +0100
@@ -23,6 +23,10 @@
 #include "android_runtime/AndroidRuntime.h"
 #include "android_runtime/Log.h"
 
+extern "C" {
+#include "module_info.h"
+}
+
 #include <string.h>
 #include <pthread.h>
 
@@ -632,7 +636,7 @@
 
 
 static void classInitNative(JNIEnv* env, jclass clazz) {
-    int err;
+    int err = -1;
     hw_module_t* module;
 
 
@@ -676,9 +680,18 @@
     char value[PROPERTY_VALUE_MAX];
     property_get("bluetooth.mock_stack", value, "");
 
-    const char *id = (strcmp(value, "1")? BT_STACK_MODULE_ID : BT_STACK_TEST_MODULE_ID);
-
-    err = hw_get_module(id, (hw_module_t const**)&module);
+    const char *id = BT_STACK_MODULE_ID;
+    aw_get_wifi_module_info();
+    if (module_info.vendor_id == 0) {
+        ALOGI("use bluetooth.%s.default.so", BT_HARDWARE_BCM_MODULE_ID);
+        err = hw_get_module_by_class(BT_STACK_MODULE_ID, BT_HARDWARE_BCM_MODULE_ID, (hw_module_t const**)&module);
+    } else if (module_info.vendor_id == 1) {
+        ALOGI("use bluetooth.%s.default.so", BT_HARDWARE_RTK_MODULE_ID);
+        err = hw_get_module_by_class(BT_STACK_MODULE_ID, BT_HARDWARE_RTK_MODULE_ID, (hw_module_t const**)&module);
+    } else if (module_info.vendor_id == 2) {
+        ALOGI("use bluetooth.%s.default.so", BT_HARDWARE_USB_MODULE_ID);
+        err = hw_get_module_by_class(BT_STACK_MODULE_ID, BT_HARDWARE_USB_MODULE_ID, (hw_module_t const**)&module);
+    }
 
     if (err == 0) {
         hw_device_t* abstraction;
@@ -1383,5 +1396,11 @@
         return JNI_ERR;
     }
 
+#ifdef BLUETOOTH_RTK_API
+    if ((status = android::register_com_android_bluetooth_rtkbt(e)) < 0) {
+        ALOGE("jni rtkbt registration failure: %d", status);
+        return JNI_ERR;
+    }
+#endif
     return JNI_VERSION_1_6;
 }
diff -ur a/packages/apps/Bluetooth/jni/com_android_bluetooth.h b/packages/apps/Bluetooth/jni/com_android_bluetooth.h
--- a/packages/apps/Bluetooth/jni/com_android_bluetooth.h	2018-08-06 15:42:22.108693819 +0200
+++ b/packages/apps/Bluetooth/jni/com_android_bluetooth.h	2017-11-23 05:22:29.000000000 +0100
@@ -54,6 +54,9 @@
 
 int register_com_android_bluetooth_sdp (JNIEnv* env);
 
+#ifdef BLUETOOTH_RTK_API
+int register_com_android_bluetooth_rtkbt(JNIEnv* env);
+#endif
 }
 
 #endif /* COM_ANDROID_BLUETOOTH_H */
Only in b/packages/apps/Bluetooth/jni: com_android_bluetooth_rtkbt.cpp
diff -ur a/packages/apps/Bluetooth/res/values/config.xml b/packages/apps/Bluetooth/res/values/config.xml
--- a/packages/apps/Bluetooth/res/values/config.xml	2018-08-06 15:42:22.168694588 +0200
+++ b/packages/apps/Bluetooth/res/values/config.xml	2017-11-23 05:22:29.000000000 +0100
@@ -13,6 +13,7 @@
    limitations under the License.
 -->
 <resources>
+    <bool name="profile_supported_rtkbt">true</bool>
     <bool name="profile_supported_a2dp">true</bool>
     <bool name="profile_supported_a2dp_sink">false</bool>
     <bool name="profile_supported_hdp">true</bool>
diff -ur a/packages/apps/Bluetooth/src/com/android/bluetooth/avrcp/Avrcp.java b/packages/apps/Bluetooth/src/com/android/bluetooth/avrcp/Avrcp.java
--- a/packages/apps/Bluetooth/src/com/android/bluetooth/avrcp/Avrcp.java	2018-08-06 15:42:22.172694640 +0200
+++ b/packages/apps/Bluetooth/src/com/android/bluetooth/avrcp/Avrcp.java	2017-11-23 05:22:29.000000000 +0100
@@ -289,6 +289,7 @@
                 if (DEBUG) Log.v(TAG, "MESSAGE_GET_RC_FEATURES: address="+address+
                                                              ", features="+msg.arg1);
                 mFeatures = msg.arg1;
+                mFeatures &= ~BTRC_FEAT_ABSOLUTE_VOLUME;
                 mFeatures = modifyRcFeatureFromBlacklist(mFeatures, address);
                 mAudioManager.avrcpSupportsAbsoluteVolume(address, isAbsoluteVolumeSupported());
                 mLastLocalVolume = -1;
diff -ur a/packages/apps/Bluetooth/src/com/android/bluetooth/btservice/Config.java b/packages/apps/Bluetooth/src/com/android/bluetooth/btservice/Config.java
--- a/packages/apps/Bluetooth/src/com/android/bluetooth/btservice/Config.java	2018-08-06 15:42:22.176694691 +0200
+++ b/packages/apps/Bluetooth/src/com/android/bluetooth/btservice/Config.java	2017-11-23 05:22:29.000000000 +0100
@@ -41,6 +41,7 @@
 import com.android.bluetooth.map.BluetoothMapService;
 import com.android.bluetooth.sap.SapService;
 import com.android.bluetooth.pbapclient.PbapClientService;
+import com.android.bluetooth.rtkbt.RtkbtService;
 
 public class Config {
     private static final String TAG = "AdapterServiceConfig";
@@ -51,6 +52,7 @@
     //Do not inclue OPP and PBAP, because their services
     //are not managed by AdapterService
     private static final Class[] PROFILE_SERVICES = {
+        //RtkbtService.class,
         HeadsetService.class,
         A2dpService.class,
         A2dpSinkService.class,
@@ -68,6 +70,7 @@
      * Resource flag to indicate whether profile is supported or not.
      */
     private static final int[]  PROFILE_SERVICES_FLAG = {
+        //R.bool.profile_supported_rtkbt,
         R.bool.profile_supported_hs_hfp,
         R.bool.profile_supported_a2dp,
         R.bool.profile_supported_a2dp_sink,
@@ -84,6 +87,8 @@
 
     private static Class[] SUPPORTED_PROFILES = new Class[0];
 
+    private static String[] rtkModuleList = {"rtl8723bs", "rtl8723bu"};
+
     static void init(Context ctx) {
         if (ctx == null) {
             return;
@@ -93,7 +98,11 @@
             return;
         }
 
-        ArrayList<Class> profiles = new ArrayList<Class>(PROFILE_SERVICES.length);
+        ArrayList<Class> profiles = new ArrayList<Class>(PROFILE_SERVICES.length + 1);
+        if (supportRtkbtService()) {
+            Log.d(TAG, "Adding " + RtkbtService.class.getSimpleName());
+            profiles.add(RtkbtService.class);
+        }
         for (int i=0; i < PROFILE_SERVICES_FLAG.length; i++) {
             boolean supported = resources.getBoolean(PROFILE_SERVICES_FLAG[i]);
             if (supported && !isProfileDisabled(ctx, PROFILE_SERVICES[i])) {
@@ -151,4 +160,20 @@
 
         return (disabledProfilesBitMask & profileBit) != 0;
     }
+
+    static boolean supportRtkbtService() {
+        String str = SystemProperties.get("wlan.hardware.info", "null");
+
+        if ((str != null) && (!str.equals("null"))) {
+            String[] val = str.split(":");
+            if ((val != null) && (val.length > 1) && (val[1] != null)) {
+                for (String s : rtkModuleList) {
+                    if ((val[1]).equals(s)) {
+                        return true;
+                    }
+                }
+            }
+        }
+        return false;
+    }
 }
diff -ur a/packages/apps/Bluetooth/src/com/android/bluetooth/opp/BluetoothOppNotification.java b/packages/apps/Bluetooth/src/com/android/bluetooth/opp/BluetoothOppNotification.java
--- a/packages/apps/Bluetooth/src/com/android/bluetooth/opp/BluetoothOppNotification.java	2018-08-06 15:42:22.224695306 +0200
+++ b/packages/apps/Bluetooth/src/com/android/bluetooth/opp/BluetoothOppNotification.java	2017-11-23 05:22:29.000000000 +0100
@@ -503,6 +503,9 @@
           Intent baseIntent = new Intent().setDataAndNormalize(contentUri)
               .setClassName(Constants.THIS_PACKAGE_NAME, BluetoothOppReceiver.class.getName());
 
+          Intent i = new Intent(baseIntent).setAction(Constants.ACTION_INCOMING_FILE_CONFIRM);
+          Log.v(TAG, "sent file confirm intent...");
+          mContext.sendBroadcast(i);
           Notification n = new Notification.Builder(mContext)
               .setOnlyAlertOnce(true)
               .setOngoing(true)
diff -ur a/packages/apps/Bluetooth/src/com/android/bluetooth/pan/PanService.java b/packages/apps/Bluetooth/src/com/android/bluetooth/pan/PanService.java
--- a/packages/apps/Bluetooth/src/com/android/bluetooth/pan/PanService.java	2018-08-06 15:42:22.248695615 +0200
+++ b/packages/apps/Bluetooth/src/com/android/bluetooth/pan/PanService.java	2017-11-23 05:22:29.000000000 +0100
@@ -57,7 +57,7 @@
  */
 public class PanService extends ProfileService {
     private static final String TAG = "PanService";
-    private static final boolean DBG = false;
+    private static final boolean DBG = true;
 
     private static final String BLUETOOTH_IFACE_ADDR_START= "192.168.44.1";
     private static final int BLUETOOTH_MAX_PAN_CONNECTIONS = 5;
Only in b/packages/apps/Bluetooth/src/com/android/bluetooth: rtkbt
diff -ur a/packages/apps/Browser2/src/org/chromium/webview_shell/WebViewBrowserActivity.java b/packages/apps/Browser2/src/org/chromium/webview_shell/WebViewBrowserActivity.java
--- a/packages/apps/Browser2/src/org/chromium/webview_shell/WebViewBrowserActivity.java	2018-08-06 15:42:23.004705311 +0200
+++ b/packages/apps/Browser2/src/org/chromium/webview_shell/WebViewBrowserActivity.java	2017-11-23 05:22:32.000000000 +0100
@@ -6,6 +6,7 @@
 
 import android.Manifest;
 import android.app.Activity;
+import android.app.ActivityManager;
 import android.app.AlertDialog;
 import android.content.ActivityNotFoundException;
 import android.content.Context;
@@ -156,6 +157,10 @@
 
     @Override
     public void onCreate(Bundle savedInstanceState) {
+	if(ActivityManager.isUserAMonkey()){
+	    Log.d("Browser2","monkey run finished");
+	    this.finish();
+	}
         super.onCreate(savedInstanceState);
         if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
             WebView.setWebContentsDebuggingEnabled(true);
diff -ur a/packages/apps/Camera2/src/com/android/camera/settings/SettingsUtil.java b/packages/apps/Camera2/src/com/android/camera/settings/SettingsUtil.java
--- a/packages/apps/Camera2/src/com/android/camera/settings/SettingsUtil.java	2018-08-06 15:42:25.392735942 +0200
+++ b/packages/apps/Camera2/src/com/android/camera/settings/SettingsUtil.java	2017-11-23 05:22:35.000000000 +0100
@@ -133,13 +133,10 @@
 
     /** Video qualities sorted by size. */
     public static int[] sVideoQualities = new int[] {
-            CamcorderProfile.QUALITY_2160P,
-            CamcorderProfile.QUALITY_1080P,
-            CamcorderProfile.QUALITY_720P,
             CamcorderProfile.QUALITY_480P,
-            CamcorderProfile.QUALITY_CIF,
-            CamcorderProfile.QUALITY_QVGA,
-            CamcorderProfile.QUALITY_QCIF
+            CamcorderProfile.QUALITY_720P,
+            CamcorderProfile.QUALITY_1080P,
+            CamcorderProfile.QUALITY_2160P
     };
 
     public static SparseArray<SelectedPictureSizes> sCachedSelectedPictureSizes =
diff -ur a/packages/apps/Camera2/src/com/android/camera/VideoModule.java b/packages/apps/Camera2/src/com/android/camera/VideoModule.java
--- a/packages/apps/Camera2/src/com/android/camera/VideoModule.java	2018-08-06 15:42:25.356735481 +0200
+++ b/packages/apps/Camera2/src/com/android/camera/VideoModule.java	2017-11-23 05:22:35.000000000 +0100
@@ -340,6 +340,7 @@
         mActivity.setPreviewStatusListener(mUI);
 
         SettingsManager settingsManager = mActivity.getSettingsManager();
+        settingsManager.set(mAppController.getModuleScope(), Keys.KEY_CAMERA_ID, 0);
         mCameraId = settingsManager.getInteger(mAppController.getModuleScope(),
                                                Keys.KEY_CAMERA_ID);
 
@@ -827,7 +828,7 @@
         // Remove the preview sizes that are not preferred.
         while (it.hasNext()) {
             Size size = it.next();
-            if (size.width() * size.height() > product) {
+            if (product > 0 && size.width() * size.height() > product) {
                 it.remove();
             }
         }
@@ -1678,7 +1679,9 @@
         if (mCameraCapabilities.supports(CameraCapabilities.Feature.ZOOM)) {
             mCameraSettings.setZoomRatio(mZoomValue);
         }
-        updateFocusParameters();
+        //add by fuqiang, remove focus, for fatal error,start
+        //updateFocusParameters();
+        //add by fuqiang, remove focus, for fatal error,end
 
         mCameraSettings.setRecordingHintEnabled(true);
 
diff -ur a/packages/apps/Contacts/src/com/android/contacts/activities/PeopleActivity.java b/packages/apps/Contacts/src/com/android/contacts/activities/PeopleActivity.java
--- a/packages/apps/Contacts/src/com/android/contacts/activities/PeopleActivity.java	2018-08-06 15:42:30.320799146 +0200
+++ b/packages/apps/Contacts/src/com/android/contacts/activities/PeopleActivity.java	2017-11-23 05:22:36.000000000 +0100
@@ -19,6 +19,7 @@
 import android.app.Fragment;
 import android.app.FragmentManager;
 import android.app.FragmentTransaction;
+import android.app.ActivityManager;
 import android.content.ActivityNotFoundException;
 import android.content.ContentUris;
 import android.content.Context;
@@ -221,6 +222,10 @@
 
     @Override
     protected void onCreate(Bundle savedState) {
+        if(ActivityManager.isUserAMonkey()){
+            Log.d("Constants","monkey run finished");
+            this.finish();
+        }
         if (Log.isLoggable(Constants.PERFORMANCE_TAG, Log.DEBUG)) {
             Log.d(Constants.PERFORMANCE_TAG, "PeopleActivity.onCreate start");
         }
diff -ur a/packages/apps/DeskClock/res/xml/dream_settings.xml b/packages/apps/DeskClock/res/xml/dream_settings.xml
--- a/packages/apps/DeskClock/res/xml/dream_settings.xml	2018-08-06 15:42:35.512865735 +0200
+++ b/packages/apps/DeskClock/res/xml/dream_settings.xml	2017-11-23 05:22:36.000000000 +0100
@@ -20,11 +20,10 @@
         android:title="@string/clock_style"
         android:entries="@array/clock_style_entries"
         android:entryValues="@array/clock_style_values"
-        android:defaultValue="@string/default_clock_style"
         android:dialogTitle="@string/clock_style" />
     <CheckBoxPreference
         android:key="screensaver_night_mode"
         android:title="@string/night_mode_title"
         android:summary="@string/night_mode_summary"
-        android:defaultValue="true" />
+        />
 </PreferenceScreen>
diff -ur a/packages/apps/DeskClock/src/com/android/deskclock/data/DataModel.java b/packages/apps/DeskClock/src/com/android/deskclock/data/DataModel.java
--- a/packages/apps/DeskClock/src/com/android/deskclock/data/DataModel.java	2018-08-06 15:42:35.520865837 +0200
+++ b/packages/apps/DeskClock/src/com/android/deskclock/data/DataModel.java	2017-11-23 05:22:36.000000000 +0100
@@ -570,6 +570,21 @@
         return mSettingsModel.getScreensaverClockStyle();
     }
 
+    public boolean getScreensaverNightMode() {
+        enforceMainLooper();
+        return mSettingsModel.getScreensaverNightMode();
+    }
+
+    public void setScreensaverClockStyle(String str, String val){
+        enforceMainLooper();
+        mSettingsModel.setScreensaverClockStyle(str, val);
+    }
+
+    public void setScreensaverNightMode(String str, boolean val){
+        enforceMainLooper();
+        mSettingsModel.setScreensaverNightMode(str, val);
+    }
+
     /**
      * @return {@code true} if the users wants to automatically show a clock for their home timezone
      *      when they have travelled outside of that timezone
@@ -605,4 +620,4 @@
             return mExecuted;
         }
     }
-}
\ No newline at end of file
+}
diff -ur a/packages/apps/DeskClock/src/com/android/deskclock/data/SettingsDAO.java b/packages/apps/DeskClock/src/com/android/deskclock/data/SettingsDAO.java
--- a/packages/apps/DeskClock/src/com/android/deskclock/data/SettingsDAO.java	2018-08-06 15:42:35.520865837 +0200
+++ b/packages/apps/DeskClock/src/com/android/deskclock/data/SettingsDAO.java	2017-11-23 05:22:36.000000000 +0100
@@ -30,7 +30,6 @@
 
 import java.util.Locale;
 import java.util.TimeZone;
-
 /**
  * This class encapsulates the storage of application preferences in {@link SharedPreferences}.
  */
@@ -110,6 +109,13 @@
         return getClockStyle(context, ScreensaverSettingsActivity.KEY_CLOCK_STYLE);
     }
 
+    static boolean getScreensaverNightMode(Context context) {
+        final SharedPreferences prefs = getSharedPreferences(context);
+        final boolean nightmode = prefs.getBoolean(ScreensaverSettingsActivity.KEY_NIGHT_MODE, false);
+        return nightmode;
+    }
+
+
     /**
      * @return the uri of the selected ringtone or the {@code defaultUri} if no explicit selection
      *      has yet been made
@@ -147,6 +153,17 @@
         return ClockStyle.valueOf(clockStyle.toUpperCase(Locale.US));
     }
 
+    static void setScreensaverClockStyle(Context context, String prefKey, String value) {
+        final SharedPreferences prefs = getSharedPreferences(context);
+        prefs.edit().putString(prefKey, value).apply();
+    }
+
+    static void setScreensaverNightMode(Context context, String prefKey, boolean value) {
+        final SharedPreferences prefs = getSharedPreferences(context);
+        prefs.edit().putBoolean(prefKey, value).apply();
+    }
+
+
     private static SharedPreferences getSharedPreferences(Context context) {
         if (sPrefs == null) {
             sPrefs = Utils.getDefaultSharedPreferences(context.getApplicationContext());
diff -ur a/packages/apps/DeskClock/src/com/android/deskclock/data/SettingsModel.java b/packages/apps/DeskClock/src/com/android/deskclock/data/SettingsModel.java
--- a/packages/apps/DeskClock/src/com/android/deskclock/data/SettingsModel.java	2018-08-06 15:42:35.520865837 +0200
+++ b/packages/apps/DeskClock/src/com/android/deskclock/data/SettingsModel.java	2017-11-23 05:22:36.000000000 +0100
@@ -63,6 +63,19 @@
         return SettingsDAO.getScreensaverClockStyle(mContext);
     }
 
+    boolean getScreensaverNightMode() {
+        return SettingsDAO.getScreensaverNightMode(mContext);
+    }
+
+
+    void setScreensaverClockStyle(String str, String val) {
+        SettingsDAO.setScreensaverClockStyle(mContext, str, val);
+    }
+
+    void setScreensaverNightMode(String str, boolean val) {
+        SettingsDAO.setScreensaverNightMode(mContext, str, val);
+    }
+
     boolean getShowHomeClock() {
         if (!SettingsDAO.getAutoShowHomeClock(mContext)) {
             return false;
@@ -98,4 +111,4 @@
     void setDefaultAlarmRingtoneUri(Uri uri) {
         SettingsDAO.setDefaultAlarmRingtoneUri(mContext, uri);
     }
-}
\ No newline at end of file
+}
diff -ur a/packages/apps/DeskClock/src/com/android/deskclock/settings/ScreensaverSettingsActivity.java b/packages/apps/DeskClock/src/com/android/deskclock/settings/ScreensaverSettingsActivity.java
--- a/packages/apps/DeskClock/src/com/android/deskclock/settings/ScreensaverSettingsActivity.java	2018-08-06 15:42:35.520865837 +0200
+++ b/packages/apps/DeskClock/src/com/android/deskclock/settings/ScreensaverSettingsActivity.java	2017-11-23 05:22:36.000000000 +0100
@@ -18,21 +18,23 @@
 
 import android.os.Bundle;
 import android.preference.ListPreference;
+import android.preference.CheckBoxPreference;
 import android.preference.Preference;
 import android.preference.PreferenceFragment;
 import android.support.v7.app.AppCompatActivity;
 import android.view.MenuItem;
 
 import com.android.deskclock.R;
-
+import android.content.SharedPreferences;
+import com.android.deskclock.data.DataModel;
+import android.util.Log;
 /**
  * Settings for Clock Daydream
  */
 public final class ScreensaverSettingsActivity extends AppCompatActivity {
-
     public static final String KEY_CLOCK_STYLE = "screensaver_clock_style";
     public static final String KEY_NIGHT_MODE = "screensaver_night_mode";
-
+    public static final String TAG_LOG = "ScreenSaver";
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
@@ -53,12 +55,33 @@
 
 
     public static class PrefsFragment extends PreferenceFragment
-            implements Preference.OnPreferenceChangeListener {
+            implements Preference.OnPreferenceChangeListener, Preference.OnPreferenceClickListener{
 
         @Override
         public void onCreate(Bundle savedInstanceState) {
             super.onCreate(savedInstanceState);
             addPreferencesFromResource(R.xml.dream_settings);
+            final DataModel.ClockStyle clockStyle = DataModel.getDataModel().getScreensaverClockStyle();
+            final ListPreference clockStylePref = (ListPreference) findPreference(KEY_CLOCK_STYLE);
+            int index = 0;
+            switch (clockStyle) {
+                case ANALOG:
+                    index = 0;
+                    break;
+                case DIGITAL:
+                    index = 1;
+                    break;
+            }
+            clockStylePref.setValueIndex(index);
+
+            final CheckBoxPreference NightModePref = (CheckBoxPreference) findPreference(KEY_NIGHT_MODE);
+            boolean nightstatus = DataModel.getDataModel().getScreensaverNightMode();
+            if(nightstatus){
+                NightModePref.setChecked(true);
+            }
+            else{
+                NightModePref.setChecked(false);
+            }
         }
 
         @Override
@@ -73,14 +96,39 @@
                 final ListPreference clockStylePref = (ListPreference) pref;
                 final int index = clockStylePref.findIndexOfValue((String) newValue);
                 clockStylePref.setSummary(clockStylePref.getEntries()[index]);
+                final DataModel dm = DataModel.getDataModel();
+                if(index == 0){
+                    dm.setScreensaverClockStyle(KEY_CLOCK_STYLE, "analog");
+                }
+                else if(index == 1){
+                    dm.setScreensaverClockStyle(KEY_CLOCK_STYLE, "digital");
+                }
             }
             return true;
         }
 
+        @Override
+        public boolean onPreferenceClick(Preference pref){
+            final CheckBoxPreference NightModePref = (CheckBoxPreference) findPreference(KEY_NIGHT_MODE);
+            if(KEY_NIGHT_MODE.equals(pref.getKey())){
+                final DataModel dm = DataModel.getDataModel();
+                if(NightModePref.isChecked()){
+                    dm.setScreensaverNightMode(KEY_NIGHT_MODE, true);
+                }
+                else{
+                    dm.setScreensaverNightMode(KEY_NIGHT_MODE, false);
+                }
+            }
+            return true;
+        }
+
+
         private void refresh() {
             final ListPreference clockStylePref = (ListPreference) findPreference(KEY_CLOCK_STYLE);
             clockStylePref.setSummary(clockStylePref.getEntry());
             clockStylePref.setOnPreferenceChangeListener(this);
+            final CheckBoxPreference NightModePref = (CheckBoxPreference) findPreference(KEY_NIGHT_MODE);
+            NightModePref.setOnPreferenceClickListener(this);
         }
     }
 }
diff -ur a/packages/apps/Gallery2/AndroidManifest.xml b/packages/apps/Gallery2/AndroidManifest.xml
--- a/packages/apps/Gallery2/AndroidManifest.xml	2018-08-06 15:42:42.512955506 +0200
+++ b/packages/apps/Gallery2/AndroidManifest.xml	2017-11-23 05:22:37.000000000 +0100
@@ -50,6 +50,8 @@
         <activity android:name="com.android.gallery3d.app.MovieActivity"
                 android:label="@string/movie_view_label"
                 android:configChanges="orientation|keyboardHidden|screenSize">
+<!--
+
             <intent-filter>
                 <action android:name="android.intent.action.VIEW" />
                 <category android:name="android.intent.category.DEFAULT" />
@@ -74,7 +76,6 @@
                 <data android:mimeType="application/sdp" />
              </intent-filter>
              <intent-filter>
-                <!-- HTTP live support -->
                 <action android:name="android.intent.action.VIEW" />
                 <category android:name="android.intent.category.DEFAULT" />
                 <category android:name="android.intent.category.BROWSABLE" />
@@ -85,6 +86,8 @@
                 <data android:mimeType="application/vnd.apple.mpegurl" />
                 <data android:mimeType="application/x-mpegurl" />
              </intent-filter>
+-->
+
         </activity>
 
         <activity android:name="com.android.gallery3d.app.GalleryActivity" android:label="@string/app_name"
diff -ur a/packages/apps/Gallery2/res/menu/albumset.xml b/packages/apps/Gallery2/res/menu/albumset.xml
--- a/packages/apps/Gallery2/res/menu/albumset.xml	2018-08-06 15:42:43.184964125 +0200
+++ b/packages/apps/Gallery2/res/menu/albumset.xml	2017-11-23 05:22:37.000000000 +0100
@@ -21,15 +21,9 @@
     <item android:id="@+id/action_select"
             android:title="@string/select_album"
             android:showAsAction="never" />
-    <item android:id="@+id/action_manage_offline"
-            android:title="@string/make_available_offline"
-            android:showAsAction="never" />
     <item android:id="@+id/action_sync_picasa_albums"
             android:title="@string/sync_picasa_albums"
             android:showAsAction="never" />
-    <item android:id="@+id/action_settings"
-            android:title="@string/settings"
-            android:showAsAction="never" />
     <item android:id="@+id/action_general_help"
             android:title="@string/help"
             android:visible="false"
diff -ur a/packages/apps/Gallery2/src/com/android/gallery3d/app/AbstractGalleryActivity.java b/packages/apps/Gallery2/src/com/android/gallery3d/app/AbstractGalleryActivity.java
--- a/packages/apps/Gallery2/src/com/android/gallery3d/app/AbstractGalleryActivity.java	2018-08-06 15:42:43.232964740 +0200
+++ b/packages/apps/Gallery2/src/com/android/gallery3d/app/AbstractGalleryActivity.java	2017-11-23 05:22:37.000000000 +0100
@@ -36,6 +36,8 @@
 import android.view.Menu;
 import android.view.MenuItem;
 import android.view.Window;
+import android.view.KeyEvent;
+import android.util.Log;
 import android.view.WindowManager;
 
 import com.android.gallery3d.R;
@@ -143,6 +145,33 @@
         mGLRootView = (GLRootView) findViewById(R.id.gl_root_view);
     }
 
+    @Override
+    public boolean onKeyDown(int keyCode, KeyEvent event) {
+        if(mGLRootView!=null){
+	  if(keyCode==KeyEvent.KEYCODE_BACK){
+		GLRoot root = getGLRoot();
+		root.lockRenderThread();
+		try {
+			getStateManager().onBackPressed();
+		} finally {
+			root.unlockRenderThread();
+		}
+	  }
+          return mGLRootView.onKeyDown(keyCode,event);
+        }else{
+          return false;
+        }
+    }
+
+    @Override
+    public boolean onKeyUp(int keyCode, KeyEvent event) {
+        if(mGLRootView!=null){
+          return mGLRootView.onKeyUp(keyCode,event);
+        }else{
+          return false;
+        }
+    }
+
     protected void onStorageReady() {
         if (mAlertDialog != null) {
             mAlertDialog.dismiss();
diff -ur a/packages/apps/Gallery2/src/com/android/gallery3d/app/AlbumPage.java b/packages/apps/Gallery2/src/com/android/gallery3d/app/AlbumPage.java
--- a/packages/apps/Gallery2/src/com/android/gallery3d/app/AlbumPage.java	2018-08-06 15:42:43.232964740 +0200
+++ b/packages/apps/Gallery2/src/com/android/gallery3d/app/AlbumPage.java	2017-11-23 05:22:37.000000000 +0100
@@ -29,6 +29,7 @@
 import android.view.Menu;
 import android.view.MenuInflater;
 import android.view.MenuItem;
+import android.view.KeyEvent;
 import android.widget.Toast;
 
 import com.android.gallery3d.R;
@@ -170,6 +171,16 @@
         }
 
         @Override
+        protected boolean onKeyDown(int keyCode,KeyEvent event){
+            return mSlotView.onKeyDown(keyCode,event);
+        }
+
+        @Override
+        protected boolean onKeyUp(int keyCode,KeyEvent event){
+            return mSlotView.onKeyUp(keyCode,event);
+        }
+
+        @Override
         protected void render(GLCanvas canvas) {
             canvas.save(GLCanvas.SAVE_FLAG_MATRIX);
             canvas.multiplyMatrix(mMatrix, 0);
diff -ur a/packages/apps/Gallery2/src/com/android/gallery3d/app/AlbumSetPage.java b/packages/apps/Gallery2/src/com/android/gallery3d/app/AlbumSetPage.java
--- a/packages/apps/Gallery2/src/com/android/gallery3d/app/AlbumSetPage.java	2018-08-06 15:42:43.232964740 +0200
+++ b/packages/apps/Gallery2/src/com/android/gallery3d/app/AlbumSetPage.java	2017-11-23 05:22:37.000000000 +0100
@@ -29,6 +29,7 @@
 import android.view.MenuItem;
 import android.view.View;
 import android.view.View.OnClickListener;
+import android.view.KeyEvent;
 import android.widget.Button;
 import android.widget.RelativeLayout;
 import android.widget.Toast;
@@ -146,6 +147,16 @@
         }
 
         @Override
+        protected boolean onKeyDown(int keyCode,KeyEvent event){
+            return mSlotView.onKeyDown(keyCode,event);
+        }
+
+        @Override
+        protected boolean onKeyUp(int keyCode,KeyEvent event){
+            return mSlotView.onKeyUp(keyCode,event);
+        }
+
+        @Override
         protected void render(GLCanvas canvas) {
             canvas.save(GLCanvas.SAVE_FLAG_MATRIX);
             GalleryUtils.setViewPointMatrix(mMatrix,
@@ -602,22 +613,10 @@
                 GalleryUtils.startCameraActivity(activity);
                 return true;
             }
-            case R.id.action_manage_offline: {
-                Bundle data = new Bundle();
-                String mediaPath = mActivity.getDataManager().getTopSetPath(
-                    DataManager.INCLUDE_ALL);
-                data.putString(AlbumSetPage.KEY_MEDIA_PATH, mediaPath);
-                mActivity.getStateManager().startState(ManageCachePage.class, data);
-                return true;
-            }
             case R.id.action_sync_picasa_albums: {
                 PicasaSource.requestSync(activity);
                 return true;
             }
-            case R.id.action_settings: {
-                activity.startActivity(new Intent(activity, GallerySettings.class));
-                return true;
-            }
             default:
                 return false;
         }
diff -ur a/packages/apps/Gallery2/src/com/android/gallery3d/app/GalleryActivity.java b/packages/apps/Gallery2/src/com/android/gallery3d/app/GalleryActivity.java
--- a/packages/apps/Gallery2/src/com/android/gallery3d/app/GalleryActivity.java	2018-08-06 15:42:43.232964740 +0200
+++ b/packages/apps/Gallery2/src/com/android/gallery3d/app/GalleryActivity.java	2017-11-23 05:22:37.000000000 +0100
@@ -25,6 +25,7 @@
 import android.os.Bundle;
 import android.view.InputDevice;
 import android.view.MotionEvent;
+import android.view.KeyEvent;
 import android.view.View;
 import android.view.Window;
 import android.view.WindowManager;
@@ -272,4 +273,11 @@
         }
         return super.onGenericMotionEvent(event);
     }
+    @Override
+    public boolean onKeyDown(int keyCode, KeyEvent event) {
+    	if(keyCode == KeyEvent.KEYCODE_BACK){
+ 	    //this.finish();
+    	}
+    	return super.onKeyDown(keyCode,event);
+    }
 }
diff -ur a/packages/apps/Gallery2/src/com/android/gallery3d/app/PhotoPage.java b/packages/apps/Gallery2/src/com/android/gallery3d/app/PhotoPage.java
--- a/packages/apps/Gallery2/src/com/android/gallery3d/app/PhotoPage.java	2018-08-06 15:42:43.236964791 +0200
+++ b/packages/apps/Gallery2/src/com/android/gallery3d/app/PhotoPage.java	2017-11-23 05:22:37.000000000 +0100
@@ -36,6 +36,7 @@
 import android.view.Menu;
 import android.view.MenuItem;
 import android.view.View;
+import android.view.KeyEvent;
 import android.widget.RelativeLayout;
 import android.widget.ShareActionProvider;
 import android.widget.Toast;
@@ -241,6 +242,14 @@
 
     private final GLView mRootPane = new GLView() {
         @Override
+        protected boolean onKeyDown(int keyCode,KeyEvent event){
+            return mPhotoView.onKeyDown(keyCode,event);
+        }
+        @Override
+        protected boolean onKeyUp(int keyCode,KeyEvent event){
+            return mPhotoView.onKeyUp(keyCode,event);
+        }
+        @Override
         protected void onLayout(
                 boolean changed, int left, int top, int right, int bottom) {
             mPhotoView.layout(0, 0, right - left, bottom - top);
@@ -472,6 +481,7 @@
                     mAppBridge == null ? false : mAppBridge.isStaticCamera());
             mModel = pda;
             mPhotoView.setModel(mModel);
+            Log.d(TAG,"mModel index " + mModel.getCurrentIndex());
 
             pda.setDataListener(new PhotoDataAdapter.DataListener() {
 
diff -ur a/packages/apps/Gallery2/src/com/android/gallery3d/filtershow/FilterShowActivity.java b/packages/apps/Gallery2/src/com/android/gallery3d/filtershow/FilterShowActivity.java
--- a/packages/apps/Gallery2/src/com/android/gallery3d/filtershow/FilterShowActivity.java	2018-08-06 15:42:43.244964894 +0200
+++ b/packages/apps/Gallery2/src/com/android/gallery3d/filtershow/FilterShowActivity.java	2017-11-23 05:22:37.000000000 +0100
@@ -347,7 +347,7 @@
 
     private void loadXML() {
         setContentView(R.layout.filtershow_activity);
-
+        /*
         ActionBar actionBar = getActionBar();
         actionBar.setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM);
         actionBar.setCustomView(R.layout.filtershow_actionbar);
@@ -361,7 +361,7 @@
                 saveImage();
             }
         });
-
+        */
         mImageShow = (ImageShow) findViewById(R.id.imageShow);
         mImageViews.add(mImageShow);
 
diff -ur a/packages/apps/Gallery2/src/com/android/gallery3d/ui/GLRootView.java b/packages/apps/Gallery2/src/com/android/gallery3d/ui/GLRootView.java
--- a/packages/apps/Gallery2/src/com/android/gallery3d/ui/GLRootView.java	2018-08-06 15:42:43.272965253 +0200
+++ b/packages/apps/Gallery2/src/com/android/gallery3d/ui/GLRootView.java	2017-11-23 05:22:37.000000000 +0100
@@ -23,9 +23,11 @@
 import android.opengl.GLSurfaceView;
 import android.os.Build;
 import android.os.Process;
+import android.util.Log;
 import android.os.SystemClock;
 import android.util.AttributeSet;
 import android.view.MotionEvent;
+import android.view.KeyEvent;
 import android.view.SurfaceHolder;
 import android.view.View;
 
@@ -457,6 +459,22 @@
     }
 
     @Override
+    public boolean onKeyDown(int keyCode, KeyEvent event) {
+        if(mContentView!=null){
+           mContentView.onKeyDown(keyCode,event);
+        }
+        return false;
+    }
+
+    @Override
+    public boolean onKeyUp(int keyCode, KeyEvent event) {
+        if(mContentView!=null){
+           mContentView.onKeyUp(keyCode,event);
+        }
+        return false;
+    }
+
+    @Override
     public boolean dispatchTouchEvent(MotionEvent event) {
         if (!isEnabled()) return false;
 
diff -ur a/packages/apps/Gallery2/src/com/android/gallery3d/ui/GLView.java b/packages/apps/Gallery2/src/com/android/gallery3d/ui/GLView.java
--- a/packages/apps/Gallery2/src/com/android/gallery3d/ui/GLView.java	2018-08-06 15:42:43.272965253 +0200
+++ b/packages/apps/Gallery2/src/com/android/gallery3d/ui/GLView.java	2017-11-23 05:22:37.000000000 +0100
@@ -19,6 +19,7 @@
 import android.graphics.Rect;
 import android.os.SystemClock;
 import android.view.MotionEvent;
+import android.view.KeyEvent;
 
 import com.android.gallery3d.anim.CanvasAnimation;
 import com.android.gallery3d.anim.StateTransitionAnimation;
@@ -292,6 +293,20 @@
         return false;
     }
 
+    protected boolean onKeyDown(int keyCode, KeyEvent event) {
+       /* StackTraceElement[] trace = new Exception().getStackTrace();
+        for(int i=0;i<trace.length;i++)
+       	 Log.d(TAG,"get call stack = " + trace[i].toString());*/
+        return false;
+    }
+
+    protected boolean onKeyUp(int keyCode, KeyEvent event) {
+       /* StackTraceElement[] trace = new Exception().getStackTrace();
+        for(int i=0;i<trace.length;i++)
+         Log.d(TAG,"get call stack = " + trace[i].toString());*/
+        return false;
+    }
+
     protected boolean dispatchTouchEvent(MotionEvent event,
             int x, int y, GLView component, boolean checkBounds) {
         Rect rect = component.mBounds;
diff -ur a/packages/apps/Gallery2/src/com/android/gallery3d/ui/PhotoView.java b/packages/apps/Gallery2/src/com/android/gallery3d/ui/PhotoView.java
--- a/packages/apps/Gallery2/src/com/android/gallery3d/ui/PhotoView.java	2018-08-06 15:42:43.272965253 +0200
+++ b/packages/apps/Gallery2/src/com/android/gallery3d/ui/PhotoView.java	2017-11-23 05:22:37.000000000 +0100
@@ -24,6 +24,8 @@
 import android.os.Build;
 import android.os.Message;
 import android.view.MotionEvent;
+import android.view.KeyEvent;
+import android.util.Log;
 import android.view.View.MeasureSpec;
 import android.view.animation.AccelerateInterpolator;
 
@@ -475,6 +477,30 @@
     }
 
     @Override
+    public boolean onKeyDown(int keyCode, KeyEvent event) {
+        int w = getWidth();
+        int h = getHeight();
+        if(keyCode == KeyEvent.KEYCODE_DPAD_LEFT){
+          slideToPrevPicture();
+        }else if(keyCode == KeyEvent.KEYCODE_DPAD_RIGHT){
+          slideToNextPicture();
+        }else if(keyCode == KeyEvent.KEYCODE_DPAD_UP){
+          mGestureListener.onScale((float)w/2,(float)h/2,0.9f);
+        }else if(keyCode == KeyEvent.KEYCODE_DPAD_DOWN){
+          mGestureListener.onScale((float)w/2,(float)h/2,1.1f);
+        }else if(keyCode == KeyEvent.KEYCODE_DPAD_CENTER){
+          Log.d(TAG,"mListener.onUndoBarVisibilityChanged");
+          showUndoBar(true);
+        }
+        return super.onKeyDown(keyCode,event);
+    }
+
+    @Override
+    public boolean onKeyUp(int keyCode, KeyEvent event) {
+	return super.onKeyUp(keyCode,event);
+    }
+
+    @Override
     protected void onLayout(
             boolean changeSize, int left, int top, int right, int bottom) {
         int w = right - left;
diff -ur a/packages/apps/Gallery2/src/com/android/gallery3d/ui/SlotView.java b/packages/apps/Gallery2/src/com/android/gallery3d/ui/SlotView.java
--- a/packages/apps/Gallery2/src/com/android/gallery3d/ui/SlotView.java	2018-08-06 15:42:43.276965304 +0200
+++ b/packages/apps/Gallery2/src/com/android/gallery3d/ui/SlotView.java	2017-11-23 05:22:37.000000000 +0100
@@ -17,15 +17,21 @@
 package com.android.gallery3d.ui;
 
 import android.graphics.Rect;
+import android.graphics.Color;
+import android.graphics.Paint;
 import android.os.Handler;
+import android.os.SystemClock;
 import android.view.GestureDetector;
 import android.view.MotionEvent;
+import android.view.KeyEvent;
+import android.util.Log;
 import android.view.animation.DecelerateInterpolator;
 
 import com.android.gallery3d.anim.Animation;
 import com.android.gallery3d.app.AbstractGalleryActivity;
 import com.android.gallery3d.common.Utils;
 import com.android.gallery3d.glrenderer.GLCanvas;
+import com.android.gallery3d.glrenderer.GLPaint;
 
 public class SlotView extends GLView {
     @SuppressWarnings("unused")
@@ -198,6 +204,72 @@
         return mLayout.getSlotRect(slotIndex, new Rect());
     }
 
+    private int mCurrSlot = 0;
+    private int mScallorCount = 0;
+    private Runnable mLongPressRunnbale;
+    private boolean sendState = false;
+    private boolean tapState = false;
+
+    @Override
+    public boolean onKeyDown(int keyCode,KeyEvent event){
+        int count = mLayout.getSlotCount();
+        int unitcount = mLayout.getUnitCount();
+        int row = unitcount!=0 ? count/unitcount : 0;
+        int pading = mLayout.getSlotSpec().slotGap;
+        Rect rect = mLayout.getSlotRect(mCurrSlot,new Rect());
+        if(keyCode == KeyEvent.KEYCODE_DPAD_UP){
+	    if(mCurrSlot > 0)
+		mCurrSlot = mCurrSlot - 1;
+	}else if(keyCode == KeyEvent.KEYCODE_DPAD_DOWN){
+            if(rect.left + mLayout.getSlotWidth() < this.getWidth())
+		mCurrSlot = mCurrSlot + 1;
+	}else if(keyCode == KeyEvent.KEYCODE_DPAD_LEFT){
+            if(mScallorCount > 0)
+		mScallorCount = mScallorCount - 1;
+	    int overDistance = mScroller.startScroll( 0 - (mLayout.getSlotWidth() + pading) , 0, mLayout.getScrollLimit());
+        }else if(keyCode == KeyEvent.KEYCODE_DPAD_RIGHT){
+	    if((mScallorCount +1) * mLayout.getSlotWidth() < mLayout.getScrollLimit()){
+		mScallorCount = mScallorCount + 1;
+		int overDistance = mScroller.startScroll(mLayout.getSlotWidth() + pading , 0, mLayout.getScrollLimit());
+            }
+        }else if(keyCode == KeyEvent.KEYCODE_DPAD_CENTER){
+            if(!sendState){
+                tapState = false;
+		mLongPressRunnbale = new Runnable(){
+		    @Override
+		    public void run(){
+			mListener.onLongTap(mCurrSlot);
+			tapState = true;
+		    }
+		};
+                mHandler.postDelayed(mLongPressRunnbale,1000);
+		sendState = true;
+            }
+        }else{
+        }
+        invalidate();
+        return super.onKeyDown(keyCode,event);
+    }
+
+    @Override
+    public boolean onKeyUp(int keyCode,KeyEvent event){
+        final Rect rect = mLayout.getSlotRect(mCurrSlot,new Rect());
+        if(keyCode == KeyEvent.KEYCODE_DPAD_CENTER){
+	    mHandler.removeCallbacks(mLongPressRunnbale);
+	    sendState = false;
+	    if(!tapState){
+            final MotionEvent me1 = MotionEvent.obtain(SystemClock.uptimeMillis(), SystemClock.uptimeMillis(),
+                MotionEvent.ACTION_DOWN,rect.left +  (rect.right - rect.left)/2, rect.top + (rect.bottom - rect.top)/2, 0);
+                onTouch(me1);
+            final MotionEvent me2 = MotionEvent.obtain(SystemClock.uptimeMillis(), SystemClock.uptimeMillis(),
+                MotionEvent.ACTION_UP,rect.left +  (rect.right - rect.left)/2, rect.top + (rect.bottom - rect.top)/2, 0);
+                onTouch(me2);
+	    }
+            tapState = false;
+	}
+        return super.onKeyUp(keyCode,event);
+    }
+
     @Override
     protected boolean onTouch(MotionEvent event) {
         if (mUIListener != null) mUIListener.onUserInteraction();
@@ -270,6 +342,10 @@
         if (mAnimation != null) {
             more |= mAnimation.calculate(animTime);
         }
+        Rect rect = mLayout.getSlotRect(mCurrSlot,new Rect());
+        GLPaint paint = new GLPaint();
+        paint.setColor(Color.GREEN);
+        paint.setLineWidth(4);
 
         canvas.translate(-mScrollX, -mScrollY);
 
@@ -296,6 +372,10 @@
 
         canvas.translate(mScrollX, mScrollY);
 
+        float w = (float)(rect.right - rect.left);
+        float h = (float)(rect.bottom - rect.top);
+        if(mLayout.getSlotCount()>0)
+        canvas.drawRect((float)rect.left,(float)rect.top ,w,h,paint);
         if (more) invalidate();
 
         final UserInteractionListener listener = mUIListener;
@@ -417,7 +497,9 @@
         public void setSlotSpec(Spec spec) {
             mSpec = spec;
         }
-
+        public Spec getSlotSpec(){
+        	  return mSpec;
+        }
         public boolean setSlotCount(int slotCount) {
             if (slotCount == mSlotCount) return false;
             if (mSlotCount != 0) {
@@ -432,13 +514,22 @@
                     || hPadding != mHorizontalPadding.getTarget();
         }
 
+        public int getSlotCount(){
+           return mSlotCount;
+        }
+
+        public int getUnitCount(){
+        	 return mUnitCount;
+        }
+
+
         public Rect getSlotRect(int index, Rect rect) {
             int col, row;
             if (WIDE) {
-                col = index / mUnitCount;
+                col = mUnitCount != 0 ? index / mUnitCount : 0;
                 row = index - col * mUnitCount;
             } else {
-                row = index / mUnitCount;
+                row = mUnitCount != 0 ? index / mUnitCount : 0;
                 col = index - row * mUnitCount;
             }
 
@@ -489,6 +580,7 @@
             // If the content length is less then the screen width, put
             // extra padding in left and right.
             padding[1] = Math.max(0, (majorLength - mContentLength) / 2);
+
         }
 
         private void initLayoutParameters() {
@@ -517,7 +609,7 @@
                 initLayoutParameters(mHeight, mWidth, mSlotHeight, mSlotWidth, padding);
                 mVerticalPadding.startAnimateTo(padding[1]);
                 mHorizontalPadding.startAnimateTo(padding[0]);
-            }
+            };
             updateVisibleSlotRange();
         }
 
@@ -584,9 +676,8 @@
             if (absoluteX < 0 || absoluteY < 0) {
                 return INDEX_NONE;
             }
-
-            int columnIdx = absoluteX / (mSlotWidth + mSlotGap);
-            int rowIdx = absoluteY / (mSlotHeight + mSlotGap);
+            int columnIdx =(mSlotWidth + mSlotGap) != 0 ? absoluteX / (mSlotWidth + mSlotGap):0;
+            int rowIdx = (mSlotHeight + mSlotGap) != 0 ? absoluteY / (mSlotHeight + mSlotGap):0;
 
             if (!WIDE && columnIdx >= mUnitCount) {
                 return INDEX_NONE;
diff -ur a/packages/apps/Music/res/layout-land/buttonbar.xml b/packages/apps/Music/res/layout-land/buttonbar.xml
--- a/packages/apps/Music/res/layout-land/buttonbar.xml	2018-08-06 15:42:52.153079125 +0200
+++ b/packages/apps/Music/res/layout-land/buttonbar.xml	2017-11-23 05:22:39.000000000 +0100
@@ -75,6 +75,7 @@
 
     <TextView
         android:id="@+id/playlisttab"
+	android:visibility="gone" 
         android:focusable="true"
         android:background="@drawable/buttonbarbackground"
         android:drawableTop="@drawable/ic_tab_playlists"
@@ -92,7 +93,7 @@
 
     <TextView
         android:id="@+id/nowplayingtab"
-        android:focusable="false"
+        android:focusable="true"
         android:background="@drawable/buttonbarbackground"
         android:drawableTop="@drawable/ic_tab_playback"
         android:text="@string/nowplaying_title"
@@ -102,7 +103,7 @@
         android:paddingBottom="2dip"
         android:gravity="center"
         android:layout_weight="1"
-        android:layout_marginLeft="3dip"
+        android:layout_marginLeft="-3dip"
         android:layout_marginRight="-3dip"
         android:layout_width="match_parent"
         android:layout_height="64dip" />
diff -ur a/packages/apps/Music/src/com/android/music/AudioPreview.java b/packages/apps/Music/src/com/android/music/AudioPreview.java
--- a/packages/apps/Music/src/com/android/music/AudioPreview.java	2018-08-06 15:42:52.173079382 +0200
+++ b/packages/apps/Music/src/com/android/music/AudioPreview.java	2017-11-23 05:22:39.000000000 +0100
@@ -49,6 +49,10 @@
 import android.widget.Toast;
 
 import java.io.IOException;
+import java.io.File;
+import android.os.storage.StorageManager;
+import android.os.storage.StorageVolume;
+import android.os.Environment;
 
 /**
  * Dialog that comes up in response to various music-related VIEW intents.
@@ -74,7 +78,7 @@
     @Override
     public void onCreate(Bundle icicle) {
         super.onCreate(icicle);
-        
+
         Intent intent = getIntent();
         if (intent == null) {
             finish();
@@ -86,7 +90,7 @@
             return;
         }
         String scheme = mUri.getScheme();
-        
+
         setVolumeControlStream(AudioManager.STREAM_MUSIC);
         requestWindowFeature(Window.FEATURE_NO_TITLE);
         setContentView(R.layout.audiopreview);
@@ -139,7 +143,7 @@
                     if (idIdx >=0) {
                         mMediaId = cursor.getLong(idIdx);
                     }
-                    
+
                     if (titleIdx >= 0) {
                         String title = cursor.getString(titleIdx);
                         mTextLine1.setText(title);
@@ -274,7 +278,7 @@
         }
         updatePlayPause();
     }
-    
+
     private OnAudioFocusChangeListener mAudioFocusListener = new OnAudioFocusChangeListener() {
         public void onAudioFocusChange(int focusChange) {
             if (mPlayer == null) {
@@ -305,14 +309,14 @@
             updatePlayPause();
         }
     };
-    
+
     private void start() {
         mAudioManager.requestAudioFocus(mAudioFocusListener, AudioManager.STREAM_MUSIC,
                 AudioManager.AUDIOFOCUS_GAIN_TRANSIENT);
         mPlayer.start();
         mProgressRefresher.postDelayed(new ProgressRefresher(), 200);
     }
-    
+
     public void setNames() {
         if (TextUtils.isEmpty(mTextLine1.getText())) {
             mTextLine1.setText(mUri.getLastPathSegment());
@@ -337,7 +341,7 @@
             }
         }
     }
-    
+
     private void updatePlayPause() {
         ImageButton b = (ImageButton) findViewById(R.id.playpause);
         if (b != null && mPlayer != null) {
@@ -370,7 +374,14 @@
     };
 
     public boolean onError(MediaPlayer mp, int what, int extra) {
-        Toast.makeText(this, R.string.playback_failed, Toast.LENGTH_SHORT).show();
+        String path = mUri.getPath();
+        final StorageManager storageManager  = (StorageManager) getSystemService(STORAGE_SERVICE);
+        File mTestFile = new File(path);
+        StorageVolume mVolume = storageManager.getStorageVolume(mTestFile);
+        Log.d(TAG, "volume = " + mVolume + " state = " + mVolume.getState());
+        if(!mVolume.getState().equals(Environment.MEDIA_EJECTING)){
+            Toast.makeText(this, R.string.playback_failed, Toast.LENGTH_SHORT).show();
+        }
         finish();
         return true;
     }
@@ -392,7 +403,7 @@
         }
         updatePlayPause();
     }
-    
+
     @Override
     public boolean onCreateOptionsMenu(Menu menu) {
         super.onCreateOptionsMenu(menu);
@@ -414,7 +425,7 @@
         item.setVisible(false);
         return false;
     }
-    
+
     @Override
     public boolean onKeyDown(int keyCode, KeyEvent event) {
         switch (keyCode) {
diff -ur a/packages/apps/Music/src/com/android/music/MediaPlaybackActivity.java b/packages/apps/Music/src/com/android/music/MediaPlaybackActivity.java
--- a/packages/apps/Music/src/com/android/music/MediaPlaybackActivity.java	2018-08-06 15:42:52.177079433 +0200
+++ b/packages/apps/Music/src/com/android/music/MediaPlaybackActivity.java	2017-11-23 05:22:39.000000000 +0100
@@ -151,6 +151,7 @@
             seeker.setOnSeekBarChangeListener(mSeekListener);
         }
         mProgress.setMax(1000);
+	mProgress.requestFocus();
 
         mTouchSlop = ViewConfiguration.get(this).getScaledTouchSlop();
     }
diff -ur a/packages/apps/Music/src/com/android/music/MediaPlaybackService.java b/packages/apps/Music/src/com/android/music/MediaPlaybackService.java
--- a/packages/apps/Music/src/com/android/music/MediaPlaybackService.java	2018-08-06 15:42:52.177079433 +0200
+++ b/packages/apps/Music/src/com/android/music/MediaPlaybackService.java	2017-11-23 05:22:39.000000000 +0100
@@ -335,7 +335,7 @@
                 | RemoteControlClient.FLAG_KEY_MEDIA_STOP;
         mRemoteControlClient.setTransportControlFlags(flags);
         
-        mPreferences = getSharedPreferences("Music", MODE_WORLD_READABLE | MODE_WORLD_WRITEABLE);
+        mPreferences = getSharedPreferences("Music", 0);
         mCardId = MusicUtils.getCardId(this);
         
         registerExternalStorageListener();
diff -ur a/packages/apps/Music/src/com/android/music/MusicUtils.java b/packages/apps/Music/src/com/android/music/MusicUtils.java
--- a/packages/apps/Music/src/com/android/music/MusicUtils.java	2018-08-06 15:42:52.181079485 +0200
+++ b/packages/apps/Music/src/com/android/music/MusicUtils.java	2017-11-23 05:22:39.000000000 +0100
@@ -1167,16 +1167,9 @@
             v.setOnFocusChangeListener(new View.OnFocusChangeListener() {
 
                 public void onFocusChange(View v, boolean hasFocus) {
-                    if (hasFocus) {
-                        for (int i = 0; i < ll.getTabCount(); i++) {
-                            if (ll.getChildTabViewAt(i) == v) {
-                                ll.setCurrentTab(i);
-                                processTabClick((Activity)ll.getContext(), v, ll.getChildAt(sActiveTabIndex).getId());
-                                break;
-                            }
-                        }
-                    }
-                }});
+		    Log.d(TAG,"onFocusChange ");
+                }
+	    });
             
             v.setOnClickListener(new View.OnClickListener() {
 
diff -ur a/packages/apps/Music/src/com/android/music/TouchInterceptor.java b/packages/apps/Music/src/com/android/music/TouchInterceptor.java
--- a/packages/apps/Music/src/com/android/music/TouchInterceptor.java	2018-08-06 15:42:52.181079485 +0200
+++ b/packages/apps/Music/src/com/android/music/TouchInterceptor.java	2017-11-23 05:22:39.000000000 +0100
@@ -77,7 +77,7 @@
 
     public TouchInterceptor(Context context, AttributeSet attrs) {
         super(context, attrs);
-        SharedPreferences pref = context.getSharedPreferences("Music", 3);
+        SharedPreferences pref = context.getSharedPreferences("Music", 0);
         mRemoveMode = pref.getInt("deletemode", -1);
         mTouchSlop = ViewConfiguration.get(context).getScaledTouchSlop();
         Resources res = getResources();
diff -ur a/packages/apps/Music/src/com/android/music/TrackBrowserActivity.java b/packages/apps/Music/src/com/android/music/TrackBrowserActivity.java
--- a/packages/apps/Music/src/com/android/music/TrackBrowserActivity.java	2018-08-06 15:42:52.181079485 +0200
+++ b/packages/apps/Music/src/com/android/music/TrackBrowserActivity.java	2017-11-23 05:22:39.000000000 +0100
@@ -433,7 +433,7 @@
             } catch (Exception ex) {
             }
         }
-        mTrackList.setBackgroundColor(0xff000000);
+        //mTrackList.setBackgroundColor(0xff000000);
         mTrackList.setCacheColorHint(0);
     }
 
diff -ur a/packages/apps/PackageInstaller/res/values/strings.xml b/packages/apps/PackageInstaller/res/values/strings.xml
--- a/packages/apps/PackageInstaller/res/values/strings.xml	2018-08-06 15:42:56.597136110 +0200
+++ b/packages/apps/PackageInstaller/res/values/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -63,9 +63,9 @@
     <string name="install_failed_incompatible" product="tv">This app isn\'t
         compatible with your TV.</string>
     <!-- Reason displayed when installation fails because the package is incompatible with
-       the current phone (e.g., missing native code for the current ABI, newer SDK, ...) [CHAR LIMIT=100] -->
+       the current TV (e.g., missing native code for the current ABI, newer SDK, ...) [CHAR LIMIT=100] -->
     <string name="install_failed_incompatible" product="default">This app isn\'t
-        compatible with your phone.</string>
+        compatible with your TV.</string>
     <!-- Reason displayed when installation fails because the installation package itself is invalid
         in some way (e.g., corrupt) [CHAR LIMIT=100] -->
     <string name="install_failed_invalid_apk">The package appears to be corrupt.</string>
@@ -73,15 +73,15 @@
     <string name="install_failed_msg" product="tablet"><xliff:g id="app_name">%1$s</xliff:g> couldn\'t be installed on your tablet.</string>
     <!-- Message presented when an application could not be installed on the TV for some reason. [CHAR LIMIT=100] -->
     <string name="install_failed_msg" product="tv"><xliff:g id="app_name">%1$s</xliff:g> couldn\'t be installed on your TV.</string>
-    <!-- Message presented when an application could not be installed on the phone for some reason. [CHAR LIMIT=100] -->
-    <string name="install_failed_msg" product="default"><xliff:g id="app_name">%1$s</xliff:g> couldn\'t be installed on your phone.</string>
+    <!-- Message presented when an application could not be installed on the TV for some reason. [CHAR LIMIT=100] -->
+    <string name="install_failed_msg" product="default"><xliff:g id="app_name">%1$s</xliff:g> couldn\'t be installed on your TV.</string>
     <string name="launch">Open</string>
     <!-- Message presented in a dialog box when a package is requested to be installed, but the "Allow unknown applications" checkbox is not enabled. [CHAR LIMIT=100] -->
     <string name="unknown_apps_dlg_text" product="tablet">For security, your tablet is set to block installation of apps obtained from unknown sources.</string>
     <!-- Message presented in a dialog box when a package is requested to be installed, but the "Allow unknown applications" checkbox is not enabled. [CHAR LIMIT=100] -->
     <string name="unknown_apps_dlg_text" product="tv">For security, your TV is set to block installation of apps obtained from unknown sources.</string>
     <!-- Message presented in a dialog box when a package is requested to be installed, but the "Allow unknown applications" checkbox is not enabled. [CHAR LIMIT=100] -->
-    <string name="unknown_apps_dlg_text" product="default">For security, your phone is set to block installation of apps obtained from unknown sources.</string>
+    <string name="unknown_apps_dlg_text" product="default">For security, your TV is set to block installation of apps obtained from unknown sources.</string>
     <!-- Message presented in a dialog box when the device administrator restricts the installation of apps from unknown sources. [CHAR LIMIT=none] -->
     <string name="unknown_apps_admin_dlg_text">Your administrator doesn\'t allow installation of apps obtained from unknown sources.</string>
 
diff -ur a/packages/apps/PackageInstaller/res/values-en-rAU/strings.xml b/packages/apps/PackageInstaller/res/values-en-rAU/strings.xml
--- a/packages/apps/PackageInstaller/res/values-en-rAU/strings.xml	2018-08-06 15:42:56.569135750 +0200
+++ b/packages/apps/PackageInstaller/res/values-en-rAU/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -36,15 +36,15 @@
     <string name="install_failed_conflict" msgid="5349055145440204106">"The package conflicts with an existing package by the same name."</string>
     <string name="install_failed_incompatible" product="tablet" msgid="119054044615117271">"This app isn\'t compatible with your tablet."</string>
     <string name="install_failed_incompatible" product="tv" msgid="3553367270510072729">"This app isn\'t compatible with your TV."</string>
-    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"This app isn\'t compatible with your phone."</string>
+    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"This app isn\'t compatible with your TV."</string>
     <string name="install_failed_invalid_apk" msgid="1287935707565682604">"The package appears to be corrupt."</string>
     <string name="install_failed_msg" product="tablet" msgid="8368835262605608787">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your tablet."</string>
     <string name="install_failed_msg" product="tv" msgid="3990457938384021566">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your TV."</string>
-    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your phone."</string>
+    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your TV."</string>
     <string name="launch" msgid="4826921505917605463">"Open"</string>
     <string name="unknown_apps_dlg_text" product="tablet" msgid="7504186369474734767">"For security, your tablet is set to block installation of apps obtained from unknown sources."</string>
     <string name="unknown_apps_dlg_text" product="tv" msgid="7195713985140602351">"For security, your TV is set to block installations of apps obtained from unknown sources."</string>
-    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"For security, your phone is set to block installation of apps obtained from unknown sources."</string>
+    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"For security, your TV is set to block installation of apps obtained from unknown sources."</string>
     <string name="unknown_apps_admin_dlg_text" msgid="1189146324736698462">"Your administrator doesn\'t allow installation of apps obtained from unknown sources."</string>
     <string name="ok" msgid="3468756155452870475">"OK"</string>
     <string name="settings" msgid="6743583734099755409">"Settings"</string>
diff -ur a/packages/apps/PackageInstaller/res/values-en-rGB/strings.xml b/packages/apps/PackageInstaller/res/values-en-rGB/strings.xml
--- a/packages/apps/PackageInstaller/res/values-en-rGB/strings.xml	2018-08-06 15:42:56.569135750 +0200
+++ b/packages/apps/PackageInstaller/res/values-en-rGB/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -36,15 +36,15 @@
     <string name="install_failed_conflict" msgid="5349055145440204106">"The package conflicts with an existing package by the same name."</string>
     <string name="install_failed_incompatible" product="tablet" msgid="119054044615117271">"This app isn\'t compatible with your tablet."</string>
     <string name="install_failed_incompatible" product="tv" msgid="3553367270510072729">"This app isn\'t compatible with your TV."</string>
-    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"This app isn\'t compatible with your phone."</string>
+    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"This app isn\'t compatible with your TV."</string>
     <string name="install_failed_invalid_apk" msgid="1287935707565682604">"The package appears to be corrupt."</string>
     <string name="install_failed_msg" product="tablet" msgid="8368835262605608787">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your tablet."</string>
     <string name="install_failed_msg" product="tv" msgid="3990457938384021566">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your TV."</string>
-    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your phone."</string>
+    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your TV."</string>
     <string name="launch" msgid="4826921505917605463">"Open"</string>
     <string name="unknown_apps_dlg_text" product="tablet" msgid="7504186369474734767">"For security, your tablet is set to block installation of apps obtained from unknown sources."</string>
     <string name="unknown_apps_dlg_text" product="tv" msgid="7195713985140602351">"For security, your TV is set to block installations of apps obtained from unknown sources."</string>
-    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"For security, your phone is set to block installation of apps obtained from unknown sources."</string>
+    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"For security, your TV is set to block installation of apps obtained from unknown sources."</string>
     <string name="unknown_apps_admin_dlg_text" msgid="1189146324736698462">"Your administrator doesn\'t allow installation of apps obtained from unknown sources."</string>
     <string name="ok" msgid="3468756155452870475">"OK"</string>
     <string name="settings" msgid="6743583734099755409">"Settings"</string>
diff -ur a/packages/apps/PackageInstaller/res/values-en-rIN/strings.xml b/packages/apps/PackageInstaller/res/values-en-rIN/strings.xml
--- a/packages/apps/PackageInstaller/res/values-en-rIN/strings.xml	2018-08-06 15:42:56.569135750 +0200
+++ b/packages/apps/PackageInstaller/res/values-en-rIN/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -36,15 +36,15 @@
     <string name="install_failed_conflict" msgid="5349055145440204106">"The package conflicts with an existing package by the same name."</string>
     <string name="install_failed_incompatible" product="tablet" msgid="119054044615117271">"This app isn\'t compatible with your tablet."</string>
     <string name="install_failed_incompatible" product="tv" msgid="3553367270510072729">"This app isn\'t compatible with your TV."</string>
-    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"This app isn\'t compatible with your phone."</string>
+    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"This app isn\'t compatible with your TV."</string>
     <string name="install_failed_invalid_apk" msgid="1287935707565682604">"The package appears to be corrupt."</string>
     <string name="install_failed_msg" product="tablet" msgid="8368835262605608787">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your tablet."</string>
     <string name="install_failed_msg" product="tv" msgid="3990457938384021566">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your TV."</string>
-    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your phone."</string>
+    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g> couldn\'t be installed on your TV."</string>
     <string name="launch" msgid="4826921505917605463">"Open"</string>
     <string name="unknown_apps_dlg_text" product="tablet" msgid="7504186369474734767">"For security, your tablet is set to block installation of apps obtained from unknown sources."</string>
     <string name="unknown_apps_dlg_text" product="tv" msgid="7195713985140602351">"For security, your TV is set to block installations of apps obtained from unknown sources."</string>
-    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"For security, your phone is set to block installation of apps obtained from unknown sources."</string>
+    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"For security, your TV is set to block installation of apps obtained from unknown sources."</string>
     <string name="unknown_apps_admin_dlg_text" msgid="1189146324736698462">"Your administrator doesn\'t allow installation of apps obtained from unknown sources."</string>
     <string name="ok" msgid="3468756155452870475">"OK"</string>
     <string name="settings" msgid="6743583734099755409">"Settings"</string>
diff -ur a/packages/apps/PackageInstaller/res/values-fr/strings.xml b/packages/apps/PackageInstaller/res/values-fr/strings.xml
--- a/packages/apps/PackageInstaller/res/values-fr/strings.xml	2018-08-06 15:42:56.573135801 +0200
+++ b/packages/apps/PackageInstaller/res/values-fr/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -36,15 +36,15 @@
     <string name="install_failed_conflict" msgid="5349055145440204106">"Le package est en conflit avec un autre package ayant le mme nom."</string>
     <string name="install_failed_incompatible" product="tablet" msgid="119054044615117271">"Cette application n\'est pas compatible avec votre tablette."</string>
     <string name="install_failed_incompatible" product="tv" msgid="3553367270510072729">"Cette application n\'est pas compatible avec votre tlviseur."</string>
-    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"Cette application n\'est pas compatible avec votre tlphone."</string>
+    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"Cette application n\'est pas compatible avec votre tlTV."</string>
     <string name="install_failed_invalid_apk" msgid="1287935707565682604">"Le package semble corrompu."</string>
     <string name="install_failed_msg" product="tablet" msgid="8368835262605608787">"Impossible d\'installer <xliff:g id="APP_NAME">%1$s</xliff:g> sur cette tablette."</string>
     <string name="install_failed_msg" product="tv" msgid="3990457938384021566">"Impossible d\'installer <xliff:g id="APP_NAME">%1$s</xliff:g> sur votre tlviseur."</string>
-    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"Impossible d\'installer <xliff:g id="APP_NAME">%1$s</xliff:g> sur ce tlphone."</string>
+    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"Impossible d\'installer <xliff:g id="APP_NAME">%1$s</xliff:g> sur ce tlTV."</string>
     <string name="launch" msgid="4826921505917605463">"Ouvrir"</string>
     <string name="unknown_apps_dlg_text" product="tablet" msgid="7504186369474734767">"Pour plus de scurit, votre tablette bloque l\'installation d\'applications de sources inconnues."</string>
     <string name="unknown_apps_dlg_text" product="tv" msgid="7195713985140602351">" des fins de scurit, l\'installation des applis de source inconnue est bloque sur ce tlviseur."</string>
-    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"Pour plus de scurit, votre tlphone bloque l\'installation d\'applications de sources inconnues."</string>
+    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"Pour plus de scurit, votre tlTV bloque l\'installation d\'applications de sources inconnues."</string>
     <string name="unknown_apps_admin_dlg_text" msgid="1189146324736698462">"Votre administrateur n\'autorise pas l\'installation d\'applications obtenues  partir de sources inconnues."</string>
     <string name="ok" msgid="3468756155452870475">"OK"</string>
     <string name="settings" msgid="6743583734099755409">"Paramtres"</string>
diff -ur a/packages/apps/PackageInstaller/res/values-fr-rCA/strings.xml b/packages/apps/PackageInstaller/res/values-fr-rCA/strings.xml
--- a/packages/apps/PackageInstaller/res/values-fr-rCA/strings.xml	2018-08-06 15:42:56.573135801 +0200
+++ b/packages/apps/PackageInstaller/res/values-fr-rCA/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -36,15 +36,15 @@
     <string name="install_failed_conflict" msgid="5349055145440204106">"Le paquet est en conflit avec un paquet existant du mme nom."</string>
     <string name="install_failed_incompatible" product="tablet" msgid="119054044615117271">"Cette application n\'est pas compatible avec votre tablette."</string>
     <string name="install_failed_incompatible" product="tv" msgid="3553367270510072729">"Cette application n\'est pas compatible avec votre tlviseur."</string>
-    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"Cette application n\'est pas compatible avec votre tlphone."</string>
+    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"Cette application n\'est pas compatible avec votre tlTV."</string>
     <string name="install_failed_invalid_apk" msgid="1287935707565682604">"Le paquet semble corrompu."</string>
     <string name="install_failed_msg" product="tablet" msgid="8368835262605608787">"Impossible d\'installer <xliff:g id="APP_NAME">%1$s</xliff:g> sur cette tablette."</string>
     <string name="install_failed_msg" product="tv" msgid="3990457938384021566">"<xliff:g id="APP_NAME">%1$s</xliff:g> n\'a pas pu tre installe sur votre tlviseur."</string>
-    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"Impossible d\'installer <xliff:g id="APP_NAME">%1$s</xliff:g> sur ce tlphone."</string>
+    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"Impossible d\'installer <xliff:g id="APP_NAME">%1$s</xliff:g> sur ce tlTV."</string>
     <string name="launch" msgid="4826921505917605463">"Ouvrir"</string>
     <string name="unknown_apps_dlg_text" product="tablet" msgid="7504186369474734767">"Pour plus de scurit, votre tablette bloque l\'installation d\'applications de sources inconnues."</string>
     <string name="unknown_apps_dlg_text" product="tv" msgid="7195713985140602351">"Votre tlviseur est configur pour bloquer l\'installation d\'applications provenant de sources inconnues"</string>
-    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"Pour plus de scurit, votre tlphone bloque l\'installation d\'applications de sources inconnues."</string>
+    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"Pour plus de scurit, votre tlTV bloque l\'installation d\'applications de sources inconnues."</string>
     <string name="unknown_apps_admin_dlg_text" msgid="1189146324736698462">"Votre administrateur n\'autorise pas l\'installation d\'applications obtenues  partir de sources inconnues."</string>
     <string name="ok" msgid="3468756155452870475">"OK"</string>
     <string name="settings" msgid="6743583734099755409">"Paramtres"</string>
diff -ur a/packages/apps/PackageInstaller/res/values-pt/strings.xml b/packages/apps/PackageInstaller/res/values-pt/strings.xml
--- a/packages/apps/PackageInstaller/res/values-pt/strings.xml	2018-08-06 15:42:56.589136007 +0200
+++ b/packages/apps/PackageInstaller/res/values-pt/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -36,7 +36,7 @@
     <string name="install_failed_conflict" msgid="5349055145440204106">"J existe um pacote com esse mesmo nome."</string>
     <string name="install_failed_incompatible" product="tablet" msgid="119054044615117271">"Este aplicativo no  compatvel com seu tablet."</string>
     <string name="install_failed_incompatible" product="tv" msgid="3553367270510072729">"Este app no  compatvel com sua TV."</string>
-    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"Este aplicativo no  compatvel com seu smartphone."</string>
+    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"Este aplicativo no  compatvel com seu smartTV."</string>
     <string name="install_failed_invalid_apk" msgid="1287935707565682604">"Parece que o pacote est corrompido."</string>
     <string name="install_failed_msg" product="tablet" msgid="8368835262605608787">"No foi possvel instalar <xliff:g id="APP_NAME">%1$s</xliff:g> em seu tablet."</string>
     <string name="install_failed_msg" product="tv" msgid="3990457938384021566">"No foi possvel instalar <xliff:g id="APP_NAME">%1$s</xliff:g> na sua TV."</string>
diff -ur a/packages/apps/PackageInstaller/res/values-pt-rBR/strings.xml b/packages/apps/PackageInstaller/res/values-pt-rBR/strings.xml
--- a/packages/apps/PackageInstaller/res/values-pt-rBR/strings.xml	2018-08-06 15:42:56.589136007 +0200
+++ b/packages/apps/PackageInstaller/res/values-pt-rBR/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -36,7 +36,7 @@
     <string name="install_failed_conflict" msgid="5349055145440204106">"J existe um pacote com esse mesmo nome."</string>
     <string name="install_failed_incompatible" product="tablet" msgid="119054044615117271">"Este aplicativo no  compatvel com seu tablet."</string>
     <string name="install_failed_incompatible" product="tv" msgid="3553367270510072729">"Este app no  compatvel com sua TV."</string>
-    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"Este aplicativo no  compatvel com seu smartphone."</string>
+    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">"Este aplicativo no  compatvel com seu smartTV."</string>
     <string name="install_failed_invalid_apk" msgid="1287935707565682604">"Parece que o pacote est corrompido."</string>
     <string name="install_failed_msg" product="tablet" msgid="8368835262605608787">"No foi possvel instalar <xliff:g id="APP_NAME">%1$s</xliff:g> em seu tablet."</string>
     <string name="install_failed_msg" product="tv" msgid="3990457938384021566">"No foi possvel instalar <xliff:g id="APP_NAME">%1$s</xliff:g> na sua TV."</string>
diff -ur a/packages/apps/PackageInstaller/res/values-tl/strings.xml b/packages/apps/PackageInstaller/res/values-tl/strings.xml
--- a/packages/apps/PackageInstaller/res/values-tl/strings.xml	2018-08-06 15:42:56.593136058 +0200
+++ b/packages/apps/PackageInstaller/res/values-tl/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -44,7 +44,7 @@
     <string name="launch" msgid="4826921505917605463">"Buksan"</string>
     <string name="unknown_apps_dlg_text" product="tablet" msgid="7504186369474734767">"Pra sa seguridad, nka-set ang tablet mong i-block ang pag-install ng apps mula sa di-klalang source."</string>
     <string name="unknown_apps_dlg_text" product="tv" msgid="7195713985140602351">"Para sa seguridad, nakatakda ang iyong TV sa i-block ang pag-i-install ng mga app na nakuha mula sa mga hindi alam na pinagmulan."</string>
-    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"Pra sa seguridd, naka-set ang phone mong i-block ang pag-install ng apps mula sa di-kilalang source."</string>
+    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">"Pra sa seguridd, naka-set ang TV mong i-block ang pag-install ng apps mula sa di-kilalang source."</string>
     <string name="unknown_apps_admin_dlg_text" msgid="1189146324736698462">"Hindi pinapayagan ng iyong administrator ang pag-install ng mga app na nakuha mula sa mga hindi alam na pinagmulan."</string>
     <string name="ok" msgid="3468756155452870475">"OK"</string>
     <string name="settings" msgid="6743583734099755409">"Mga Setting"</string>
diff -ur a/packages/apps/PackageInstaller/res/values-zh-rCN/strings.xml b/packages/apps/PackageInstaller/res/values-zh-rCN/strings.xml
--- a/packages/apps/PackageInstaller/res/values-zh-rCN/strings.xml	2018-08-06 15:42:56.597136110 +0200
+++ b/packages/apps/PackageInstaller/res/values-zh-rCN/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -36,15 +36,15 @@
     <string name="install_failed_conflict" msgid="5349055145440204106">""</string>
     <string name="install_failed_incompatible" product="tablet" msgid="119054044615117271">""</string>
     <string name="install_failed_incompatible" product="tv" msgid="3553367270510072729">""</string>
-    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">""</string>
+    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">""</string>
     <string name="install_failed_invalid_apk" msgid="1287935707565682604">""</string>
     <string name="install_failed_msg" product="tablet" msgid="8368835262605608787">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
     <string name="install_failed_msg" product="tv" msgid="3990457938384021566">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
-    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
+    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
     <string name="launch" msgid="4826921505917605463">""</string>
     <string name="unknown_apps_dlg_text" product="tablet" msgid="7504186369474734767">""</string>
     <string name="unknown_apps_dlg_text" product="tv" msgid="7195713985140602351">""</string>
-    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">""</string>
+    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">""</string>
     <string name="unknown_apps_admin_dlg_text" msgid="1189146324736698462">""</string>
     <string name="ok" msgid="3468756155452870475">""</string>
     <string name="settings" msgid="6743583734099755409">""</string>
diff -ur a/packages/apps/PackageInstaller/res/values-zh-rHK/strings.xml b/packages/apps/PackageInstaller/res/values-zh-rHK/strings.xml
--- a/packages/apps/PackageInstaller/res/values-zh-rHK/strings.xml	2018-08-06 15:42:56.597136110 +0200
+++ b/packages/apps/PackageInstaller/res/values-zh-rHK/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -36,15 +36,15 @@
     <string name="install_failed_conflict" msgid="5349055145440204106">""</string>
     <string name="install_failed_incompatible" product="tablet" msgid="119054044615117271">""</string>
     <string name="install_failed_incompatible" product="tv" msgid="3553367270510072729">""</string>
-    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">""</string>
+    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">""</string>
     <string name="install_failed_invalid_apk" msgid="1287935707565682604">""</string>
     <string name="install_failed_msg" product="tablet" msgid="8368835262605608787">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
     <string name="install_failed_msg" product="tv" msgid="3990457938384021566">" <xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
-    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
+    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
     <string name="launch" msgid="4826921505917605463">""</string>
     <string name="unknown_apps_dlg_text" product="tablet" msgid="7504186369474734767">""</string>
     <string name="unknown_apps_dlg_text" product="tv" msgid="7195713985140602351">""</string>
-    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">""</string>
+    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">""</string>
     <string name="unknown_apps_admin_dlg_text" msgid="1189146324736698462">""</string>
     <string name="ok" msgid="3468756155452870475">""</string>
     <string name="settings" msgid="6743583734099755409">""</string>
diff -ur a/packages/apps/PackageInstaller/res/values-zh-rTW/strings.xml b/packages/apps/PackageInstaller/res/values-zh-rTW/strings.xml
--- a/packages/apps/PackageInstaller/res/values-zh-rTW/strings.xml	2018-08-06 15:42:56.597136110 +0200
+++ b/packages/apps/PackageInstaller/res/values-zh-rTW/strings.xml	2017-11-23 05:22:39.000000000 +0100
@@ -36,15 +36,15 @@
     <string name="install_failed_conflict" msgid="5349055145440204106">""</string>
     <string name="install_failed_incompatible" product="tablet" msgid="119054044615117271">""</string>
     <string name="install_failed_incompatible" product="tv" msgid="3553367270510072729">""</string>
-    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">""</string>
+    <string name="install_failed_incompatible" product="default" msgid="6677057915876853610">""</string>
     <string name="install_failed_invalid_apk" msgid="1287935707565682604">""</string>
     <string name="install_failed_msg" product="tablet" msgid="8368835262605608787">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
     <string name="install_failed_msg" product="tv" msgid="3990457938384021566">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
-    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
+    <string name="install_failed_msg" product="default" msgid="8554909560982962052">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
     <string name="launch" msgid="4826921505917605463">""</string>
     <string name="unknown_apps_dlg_text" product="tablet" msgid="7504186369474734767">""</string>
     <string name="unknown_apps_dlg_text" product="tv" msgid="7195713985140602351">""</string>
-    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">""</string>
+    <string name="unknown_apps_dlg_text" product="default" msgid="133213135679009316">""</string>
     <string name="unknown_apps_admin_dlg_text" msgid="1189146324736698462">""</string>
     <string name="ok" msgid="3468756155452870475">""</string>
     <string name="settings" msgid="6743583734099755409">""</string>
Only in b/packages/apps/Phone: .emptycommitmark
diff -ur a/packages/apps/Provision/AndroidManifest.xml b/packages/apps/Provision/AndroidManifest.xml
--- a/packages/apps/Provision/AndroidManifest.xml	2018-08-06 15:42:59.417172269 +0200
+++ b/packages/apps/Provision/AndroidManifest.xml	2017-11-23 05:22:39.000000000 +0100
@@ -25,6 +25,7 @@
 
     <application>
         <activity android:name="DefaultActivity"
+		android:theme="@android:style/Theme.Translucent.NoTitleBar.Fullscreen"
                 android:excludeFromRecents="true">
             <intent-filter android:priority="1">
                 <action android:name="android.intent.action.MAIN" />
diff -ur a/packages/apps/QuickSearchBox/src/com/android/quicksearchbox/SearchActivity.java b/packages/apps/QuickSearchBox/src/com/android/quicksearchbox/SearchActivity.java
--- a/packages/apps/QuickSearchBox/src/com/android/quicksearchbox/SearchActivity.java	2018-08-06 15:42:59.673175551 +0200
+++ b/packages/apps/QuickSearchBox/src/com/android/quicksearchbox/SearchActivity.java	2017-11-23 05:22:40.000000000 +0100
@@ -17,6 +17,7 @@
 package com.android.quicksearchbox;
 
 import android.app.Activity;
+import android.app.ActivityManager;
 import android.app.SearchManager;
 import android.content.Intent;
 import android.net.Uri;
@@ -93,6 +94,10 @@
     /** Called when the activity is first created. */
     @Override
     public void onCreate(Bundle savedInstanceState) {
+	if(ActivityManager.isUserAMonkey()){
+            Log.d("QuickSearch","monkey run finished");
+            this.finish();
+        }
         mTraceStartUp = getIntent().hasExtra(INTENT_EXTRA_TRACE_START_UP);
         if (mTraceStartUp) {
             String traceFile = new File(getDir("traces", 0), "qsb-start.trace").getAbsolutePath();
diff -ur a/packages/apps/Settings/AndroidManifest.xml b/packages/apps/Settings/AndroidManifest.xml
--- a/packages/apps/Settings/AndroidManifest.xml	2018-08-06 15:43:01.969204991 +0200
+++ b/packages/apps/Settings/AndroidManifest.xml	2017-11-23 05:22:40.000000000 +0100
@@ -432,6 +432,44 @@
                 android:value="com.android.settings.bluetooth.BluetoothSettings" />
         </activity>
 
+        <activity android:name="Settings$EthernetSettingsActivity"
+                android:label="@string/eth_settings_title"
+                android:icon="@drawable/ic_settings_ethernet"
+                android:taskAffinity="">
+            <intent-filter>
+                <action android:name="android.intent.action.MAIN" />
+                <category android:name="android.intent.category.VOICE_LAUNCH" />
+                <category android:name="com.android.settings.SHORTCUT" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter android:priority="3">
+                <action android:name="com.android.settings.action.SETTINGS" />
+            </intent-filter>
+            <meta-data android:name="com.android.settings.category"
+                android:value="com.android.settings.category.wireless" />
+            <meta-data android:name="com.android.settings.FRAGMENT_CLASS"
+                android:value="com.android.settings.ethernet.EthernetSettings" />
+        </activity>
+        <!-- pppoe setting activity. -->
+        <activity android:name="Settings$PppoeSettingsActivity"
+                android:label="@string/pppoe_setting_title"
+                android:icon="@drawable/ic_settings_ethernet"
+                android:taskAffinity="">
+            <intent-filter>
+                <action android:name="android.intent.action.MAIN" />
+                <category android:name="android.intent.category.VOICE_LAUNCH" />
+                <category android:name="com.android.settings.SHORTCUT" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter android:priority="3">
+                <action android:name="com.android.settings.action.SETTINGS" />
+            </intent-filter>
+            <meta-data android:name="com.android.settings.category"
+                android:value="com.android.settings.category.wireless" />
+            <meta-data android:name="com.android.settings.FRAGMENT_CLASS"
+                android:value="com.android.settings.pppoe.PppoeSettings" />
+        </activity>
+
         <!-- Keep compatibility with old shortcuts. -->
         <activity-alias android:name=".bluetooth.BluetoothSettings"
                 android:label="@string/bluetooth_settings_title"
@@ -953,6 +991,33 @@
                 android:value="true" />
         </activity>
 
+        <activity android:name="Settings$HDRSettingsActivity"
+                android:label="@string/advanced_settings"
+                android:icon="@drawable/ic_bt_laptop"
+                android:taskAffinity="">
+            <intent-filter android:priority="1">
+                <action android:name="com.android.settings.DISPLAY_SETTINGS" />
+                <action android:name="android.settings.DISPLAY_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.intent.action.MAIN" />
+                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.VOICE_LAUNCH" />
+                <category android:name="com.android.settings.SHORTCUT" />
+            </intent-filter>
+            <intent-filter android:priority="9">
+                <action android:name="com.android.settings.action.SETTINGS" />
+            </intent-filter>
+            <meta-data android:name="com.android.settings.category"
+                android:value="com.android.settings.category.device" />
+            <meta-data android:name="com.android.settings.FRAGMENT_CLASS"
+                android:value="com.android.settings.HDRSettings" />
+            <meta-data android:name="com.android.settings.PRIMARY_PROFILE_CONTROLLED"
+                android:value="true" />
+        </activity>
+
+
         <!-- Keep compatibility with old shortcuts. -->
         <activity-alias android:name="DisplaySettings"
                 android:label="@string/display_settings"
diff -ur a/packages/apps/Settings/res/color/storage_wizard_button_red.xml b/packages/apps/Settings/res/color/storage_wizard_button_red.xml
--- a/packages/apps/Settings/res/color/storage_wizard_button_red.xml	2018-08-06 15:43:01.997205349 +0200
+++ b/packages/apps/Settings/res/color/storage_wizard_button_red.xml	2017-11-23 05:22:40.000000000 +0100
@@ -17,6 +17,7 @@
 <selector xmlns:android="http://schemas.android.com/apk/res/android">
     <item android:state_enabled="false"
           android:alpha="?android:attr/disabledAlpha"
-          android:color="#fff4511e" />
-    <item android:color="#fff4511e" />
+          android:color="#ffC0C0C0" />
+    <item android:state_focused="false" android:color="#ffC0C0C0" />
+    <item android:state_focused="true" android:color="#fff4511e" />
 </selector>
Only in b/packages/apps/Settings/res/drawable-hdpi: ic_settings_ethernet.png
Only in b/packages/apps/Settings/res/drawable-mdpi: ic_settings_ethernet.png
Only in b/packages/apps/Settings/res/drawable-xhdpi: ic_settings_ethernet.png
Only in b/packages/apps/Settings/res/layout: audio_channels_select.xml
Only in b/packages/apps/Settings/res/layout: eth_dhcp_dialog.xml
Only in b/packages/apps/Settings/res/layout: eth_static_dialog.xml
Only in b/packages/apps/Settings/res/layout: pppoe_dialog.xml
Only in b/packages/apps/Settings/res/layout: preference_dialog_saturation.xml
diff -ur a/packages/apps/Settings/res/layout/storage_wizard_navigation.xml b/packages/apps/Settings/res/layout/storage_wizard_navigation.xml
--- a/packages/apps/Settings/res/layout/storage_wizard_navigation.xml	2018-08-06 15:43:02.181207709 +0200
+++ b/packages/apps/Settings/res/layout/storage_wizard_navigation.xml	2017-11-23 05:22:40.000000000 +0100
@@ -47,6 +47,6 @@
         android:layout_marginEnd="16dp"
         android:text="@string/wizard_next"
         android:textColor="@android:color/white"
-        android:backgroundTint="@color/storage_wizard_button" />
+        android:backgroundTint="@color/storage_wizard_button_red" />
 
 </LinearLayout>
Only in b/packages/apps/Settings/res/values: arrays_custom.xml
diff -ur a/packages/apps/Settings/res/values/arrays.xml b/packages/apps/Settings/res/values/arrays.xml
--- a/packages/apps/Settings/res/values/arrays.xml	2018-08-06 15:43:02.849216274 +0200
+++ b/packages/apps/Settings/res/values/arrays.xml	2017-11-23 05:22:41.000000000 +0100
@@ -83,7 +83,7 @@
     <!-- Do not translate. -->
     <string-array name="dream_timeout_values" translatable="false">
         <!-- Do not translate. -->
-        <item>0</item>
+        <item>2147483647</item>
         <!-- Do not translate. -->
         <item>15000</item>
         <!-- Do not translate. -->
@@ -1031,4 +1031,9 @@
         <item>Red</item>
     </string-array>
 
+    <string-array name="pppoe_interface">
+        <item>eth0</item>
+        <item>wlan0</item>
+    </string-array>
+
 </resources>
Only in b/packages/apps/Settings/res/values: strings_custom.xml
diff -ur a/packages/apps/Settings/res/values/strings.xml b/packages/apps/Settings/res/values/strings.xml
--- a/packages/apps/Settings/res/values/strings.xml	2018-08-06 15:43:02.853216325 +0200
+++ b/packages/apps/Settings/res/values/strings.xml	2017-11-23 05:22:41.000000000 +0100
@@ -2246,7 +2246,7 @@
     <!-- Advanced (used for diagnostics) device info activity title [CHAR LIMIT=40] -->
     <string name="device_info_settings" product="tablet">Tablet status</string>
     <!-- Advanced (used for diagnostics) device info activity title [CHAR LIMIT=40] -->
-    <string name="device_info_settings" product="default">Phone status</string>
+    <string name="device_info_settings" product="default">TV status</string>
 
     <!-- About phone screen, list item title.  Takes the user to the screen for seeing and installing system updates. [CHAR LIMIT=40] -->
     <string name="system_update_settings_list_item_title">System updates</string>
@@ -2279,7 +2279,7 @@
     <!-- About tablet screen, summary of the item that takes you to tablet status screen -->
     <string name="device_status_summary" product="tablet">Status of the battery, network, and other information</string>
     <!-- About phone screen, summary of the item to go into the phone status screen -->
-    <string name="device_status_summary" product="default">Phone number, signal, etc.</string>
+    <string name="device_status_summary" product="default">mac address, serial number, etc.</string>
     <!-- Main settings screen item's title to go into the storage settings screen [CHAR LIMIT=25] -->
     <string name="storage_settings" >Storage</string>
     <!-- Main settings screen item's title to go into the storage & USB settings screen [CHAR LIMIT=25] -->
@@ -2776,7 +2776,7 @@
     <!-- SD card & phone storage settings screen, message on screen after user selects Factory data reset [CHAR LIMIT=NONE] -->
     <string name="master_clear_desc" product="tablet">"This will erase all data from your tablet\u2019s <b>internal storage</b>, including:\n\n<li>Your Google account</li>\n<li>System and app data and settings</li>\n<li>Downloaded apps</li>"</string>
     <!-- SD card & phone storage settings screen, message on screen after user selects Factory data reset [CHAR LIMIT=NONE] -->
-    <string name="master_clear_desc" product="default">"This will erase all data from your phone\u2019s <b>internal storage</b>, including:\n\n<li>Your Google account</li>\n<li>System and app data and settings</li>\n<li>Downloaded apps"</li></string>
+    <string name="master_clear_desc" product="default">"This will erase all data from your TV Box\u2019s <b>internal storage</b>, including:\n\n<li>Your Google account</li>\n<li>System and app data and settings</li>\n<li>Downloaded apps"</li></string>
     <!-- SD card & phone storage settings screen, instructions and list of current accounts.  The list of accounts follows this text[CHAR LIMIT=NONE] -->
     <string name="master_clear_accounts" product="default">"\n\nYou are currently signed into the following accounts:\n"</string>
     <!-- SD card & phone storage settings screen, notification if other users are present on the device [CHAR LIMIT=NONE] -->
@@ -2798,7 +2798,7 @@
     <!-- SD card & phone storage settings screen, button on screen after user selects Factory data reset -->
     <string name="master_clear_button_text" product="tablet">Reset tablet</string>
     <!-- SD card & phone storage settings screen, button on screen after user selects Factory data reset -->
-    <string name="master_clear_button_text" product="default">Reset phone</string>
+    <string name="master_clear_button_text" product="default">Reset TV box</string>
     <!-- SD card & phone storage settings screen, message on screen after user selects Reset phone button -->
     <string name="master_clear_final_desc">Erase all your personal information and downloaded apps? You can\u2019t undo this action!</string>
     <!-- SD card & phone storage settings screen, button on screen after user selects Reset phone button -->
@@ -2856,21 +2856,21 @@
     <!-- Bluetooth available subtext - shown when Bluetooth tethering is turned on but it is not currently tethered to any devices [CHAR LIMIT=50]-->
     <string name="bluetooth_tethering_available_subtext" product="tablet">Sharing this tablet\u2019s Internet connection</string>
     <!-- Bluetooth available subtext - shown when Bluetooth tethering is turned on but it is not currently tethered to any devices [CHAR LIMIT=50]-->
-    <string name="bluetooth_tethering_available_subtext" product="default">Sharing this phone\u2019s Internet connection</string>
+    <string name="bluetooth_tethering_available_subtext" product="default">Sharing this box\u2019s Internet connection</string>
     <!-- Bluetooth connected subtext - shown when a device is tethered over Bluetooth [CHAR LIMIT=60]-->
     <string name="bluetooth_tethering_device_connected_subtext" product="tablet">Sharing this tablet\u2019s Internet connection to 1 device</string>
     <!-- Bluetooth connected subtext - shown when a device is tethered over Bluetooth [CHAR LIMIT=60]-->
-    <string name="bluetooth_tethering_device_connected_subtext" product="default">Sharing this phone\u2019s Internet connection to 1 device</string>
+    <string name="bluetooth_tethering_device_connected_subtext" product="default">Sharing this box\u2019s Internet connection to 1 device</string>
     <!-- Bluetooth connected subtext - shown when multiple devices are tethered over Bluetooth [CHAR LIMIT=60]-->
     <string name="bluetooth_tethering_devices_connected_subtext" product="tablet">Sharing this tablet\u2019s Internet connection to <xliff:g id="connectedDeviceCount">%1$d</xliff:g> devices</string>
     <!-- Bluetooth connected subtext - shown when multiple devices are tethered over Bluetooth [CHAR LIMIT=60]-->
-    <string name="bluetooth_tethering_devices_connected_subtext" product="default">Sharing this phone\u2019s Internet connection to <xliff:g id="connectedDeviceCount">%1$d</xliff:g> devices</string>
+    <string name="bluetooth_tethering_devices_connected_subtext" product="default">Sharing this box\u2019s Internet connection to <xliff:g id="connectedDeviceCount">%1$d</xliff:g> devices</string>
     <!-- Bluetooth tethering off subtext - shown when Bluetooth Tethering is turned off [CHAR LIMIT=50]-->
     <string name="bluetooth_tethering_off_subtext_config">Sharing this <xliff:g id="device_name">%1$d</xliff:g>\u2019s Internet connection</string>
     <!-- Bluetooth tethering off subtext - shown when Bluetooth Tethering is turned off [CHAR LIMIT=50]-->
     <string name="bluetooth_tethering_off_subtext" product="tablet">Not sharing this tablet\u2019s Internet connection</string>
     <!-- Bluetooth tethering off subtext - shown when Bluetooth Tethering is turned off [CHAR LIMIT=50]-->
-    <string name="bluetooth_tethering_off_subtext" product="default">Not sharing this phone\u2019s Internet connection</string>
+    <string name="bluetooth_tethering_off_subtext" product="default">Not sharing this box\u2019s Internet connection</string>
     <!-- Bluetooth errored subtext - shown when Bluetooth is broken for some reason [CHAR LIMIT=50]-->
     <string name="bluetooth_tethering_errored_subtext">Not tethered</string>
     <!-- Bluetooth Tethering settings. Error message shown when trying to connect an 8th device [CHAR LIMIT=50]-->
@@ -2994,7 +2994,7 @@
     <!-- Main settings screen, setting title for the user to go into the About phone screen -->
     <string name="about_settings" product="tablet">About tablet</string>
     <!-- Main settings screen, setting title for the user to go into the About phone screen -->
-    <string name="about_settings" product="default">About phone</string>
+    <string name="about_settings" product="default">About TV Box</string>
     <!-- Main settings screen, setting title for the user to go into the About phone screen -->
     <string name="about_settings" product="emulator">About emulated device</string>
     <!-- Main settings screen, setting summary for the user to go into the About phone screen-->
@@ -4621,9 +4621,9 @@
 
     <!-- Backup and reset Settings screen --><skip />
     <!-- Backup and reset settings menu title -->
-    <string name="privacy_settings">Backup &amp; reset</string>
+    <string name="privacy_settings">Reset TV Box</string>
     <!-- Privacy settings activity title -->
-    <string name="privacy_settings_title">Backup &amp; reset</string>
+    <string name="privacy_settings_title">Reset TV Box</string>
     <!-- Backup section title -->
     <string name="backup_section_title">Backup &amp; restore</string>
     <!-- Personal data section title -->
@@ -7236,6 +7236,7 @@
 
     <!-- Label for section about ethernet in data usage screen [CHAR LIMIT=60] -->
     <string name="ethernet">Ethernet</string>
+    <string name="pppoe_hint">please setup pppoe user and password first!</string>
 
     <!-- Format string for amount of cellular data used [CHAR LIMIT=30] -->
     <string name="cell_data_template"><xliff:g name="units" example="GB">%1$s</xliff:g> cellular data</string>
@@ -7499,4 +7500,6 @@
 
     <!-- Message for telling the user the kind of BT device being displayed in list. -->
     <string name="bluetooth_talkback_bluetooth">Bluetooth</string>
+    <string name="display_support_type">The Current HDMI format is not support</string>
+    <string name="display_support_type_title">Warning</string>
 </resources>
Only in b/packages/apps/Settings/res/values-ja: strings_custom.xml
diff -ur a/packages/apps/Settings/res/values-zh-rCN/arrays.xml b/packages/apps/Settings/res/values-zh-rCN/arrays.xml
--- a/packages/apps/Settings/res/values-zh-rCN/arrays.xml	2018-08-06 15:43:02.837216120 +0200
+++ b/packages/apps/Settings/res/values-zh-rCN/arrays.xml	2017-11-23 05:22:41.000000000 +0100
@@ -250,7 +250,7 @@
     <item msgid="7674458294386319722">""</item>
     <item msgid="8281201165558093009">"WLAN"</item>
     <item msgid="8694611243479480497">""</item>
-    <item msgid="7776439107987345446">""</item>
+    <item msgid="7776439107987345446">""</item>
     <item msgid="514615766544675057">""</item>
     <item msgid="8181415497109310680">""</item>
     <item msgid="6816551144382117307">""</item>
@@ -289,7 +289,7 @@
     <item msgid="7155384795265164395">""</item>
     <item msgid="1835836196806147034">""</item>
     <item msgid="5989890403088155055">""</item>
-    <item msgid="8582699692765917557">""</item>
+    <item msgid="8582699692765917557">""</item>
     <item msgid="1474039653814954902">""</item>
     <item msgid="7222837656938871633">" SIP"</item>
     <item msgid="6108267038969274380">""</item>
@@ -355,7 +355,7 @@
     <item msgid="1662979573471871926">""</item>
     <item msgid="5964768335278263478">""</item>
     <item msgid="2657138701132782702">""</item>
-    <item msgid="8571369610363539266">""</item>
+    <item msgid="8571369610363539266">""</item>
     <item msgid="4542463358215230845">""</item>
     <item msgid="864565065016166003">" SIP"</item>
     <item msgid="1958009349883195116">""</item>
@@ -472,4 +472,18 @@
     <item msgid="4608643045752965568">""</item>
     <item msgid="6131821495505931173">""</item>
   </string-array>
+  <string-array name="pip_screen_set_postion_name">
+    <item></item>
+    <item></item>
+    <item></item>
+    <item></item>
+    <item></item>
+  </string-array>
+  <string-array name="pip_screen_set_postion_value">
+     <item>0</item>
+     <item>1</item>
+     <item>2</item>
+     <item>3</item>
+     <item>4</item>
+   </string-array>
 </resources>
Only in b/packages/apps/Settings/res/values-zh-rCN: strings_custom.xml
diff -ur a/packages/apps/Settings/res/values-zh-rCN/strings.xml b/packages/apps/Settings/res/values-zh-rCN/strings.xml
--- a/packages/apps/Settings/res/values-zh-rCN/strings.xml	2018-08-06 15:43:02.841216171 +0200
+++ b/packages/apps/Settings/res/values-zh-rCN/strings.xml	2017-11-23 05:22:41.000000000 +0100
@@ -121,16 +121,16 @@
     <string name="bluetooth_permission_request" msgid="1523129741266262748">""</string>
     <string name="bluetooth_ask_enablement" msgid="1712443355224737143">""</string>
     <string name="bluetooth_ask_discovery" product="tablet" msgid="786921566047356213">" <xliff:g id="TIMEOUT">%1$d</xliff:g> "</string>
-    <string name="bluetooth_ask_discovery" product="default" msgid="5510358858113713272">" <xliff:g id="TIMEOUT">%1$d</xliff:g> "</string>
+    <string name="bluetooth_ask_discovery" product="default" msgid="5510358858113713272">" <xliff:g id="TIMEOUT">%1$d</xliff:g> "</string>
     <string name="bluetooth_ask_lasting_discovery" product="tablet" msgid="8863617309580598607">""</string>
-    <string name="bluetooth_ask_lasting_discovery" product="default" msgid="6487606808683607975">""</string>
+    <string name="bluetooth_ask_lasting_discovery" product="default" msgid="6487606808683607975">""</string>
     <string name="bluetooth_ask_start_broadcast" product="default" msgid="3535628155254187911">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
     <string name="bluetooth_ask_enablement_and_start_broadcast" product="default" msgid="8810858601242763295">"<xliff:g id="APP_NAME">%1$s</xliff:g>"</string>
-    <string name="bluetooth_broadcasting_explaination" product="default" msgid="4249322115655011799">"\n\n"</string>
+    <string name="bluetooth_broadcasting_explaination" product="default" msgid="4249322115655011799">"\n\n"</string>
     <string name="bluetooth_ask_enablement_and_discovery" product="tablet" msgid="3346529092809011149">" <xliff:g id="TIMEOUT">%1$d</xliff:g> "</string>
-    <string name="bluetooth_ask_enablement_and_discovery" product="default" msgid="4724094889807196118">" <xliff:g id="TIMEOUT">%1$d</xliff:g> "</string>
+    <string name="bluetooth_ask_enablement_and_discovery" product="default" msgid="4724094889807196118">" <xliff:g id="TIMEOUT">%1$d</xliff:g> "</string>
     <string name="bluetooth_ask_enablement_and_lasting_discovery" product="tablet" msgid="989613204829097159">""</string>
-    <string name="bluetooth_ask_enablement_and_lasting_discovery" product="default" msgid="6671615712909139801">""</string>
+    <string name="bluetooth_ask_enablement_and_lasting_discovery" product="default" msgid="6671615712909139801">""</string>
     <string name="bluetooth_turning_on" msgid="4850574877288036646">"..."</string>
     <string name="bluetooth_turning_off" msgid="2337747302892025192">""</string>
     <string name="bluetooth_auto_connect" msgid="40711424456733571">""</string>
@@ -248,7 +248,7 @@
     <string name="device_info_label" msgid="6551553813651711205">""</string>
     <string name="display_label" msgid="8074070940506840792">""</string>
     <string name="phone_info_label" product="tablet" msgid="7820855350955963628">""</string>
-    <string name="phone_info_label" product="default" msgid="2127552523124277664">""</string>
+    <string name="phone_info_label" product="default" msgid="2127552523124277664">""</string>
     <string name="sd_card_settings_label" product="nosdcard" msgid="8101475181301178428">"USB"</string>
     <string name="sd_card_settings_label" product="default" msgid="5743100901106177102">"SD"</string>
     <string name="proxy_settings_label" msgid="3271174136184391743">""</string>
@@ -276,7 +276,7 @@
     <string name="roaming_turn_it_on_button" msgid="4387601818162120589">""</string>
     <string name="roaming_warning" msgid="4275443317524544705">""</string>
     <string name="roaming_warning_multiuser" product="tablet" msgid="6458990250829214777">"\n\n"</string>
-    <string name="roaming_warning_multiuser" product="default" msgid="6368421100292355440">"\n\n"</string>
+    <string name="roaming_warning_multiuser" product="default" msgid="6368421100292355440">"\n\n"</string>
     <string name="roaming_reenable_title" msgid="6068100976707316772">""</string>
     <string name="networks" msgid="6333316876545927039">""</string>
     <string name="sum_carrier_select" msgid="3616956422251879163">""</string>
@@ -334,21 +334,21 @@
     </plurals>
     <string name="security_settings_fingerprint_preference_summary_none" msgid="1507739327565151923"></string>
     <string name="security_settings_fingerprint_enroll_introduction_title" msgid="3201556857492526098">""</string>
-    <string name="security_settings_fingerprint_enroll_introduction_message" msgid="6931554430739074640">"\n\n PIN "<annotation id="url">""</annotation></string>
+    <string name="security_settings_fingerprint_enroll_introduction_message" msgid="6931554430739074640">"\n\n PIN "<annotation id="url">""</annotation></string>
     <string name="security_settings_fingerprint_enroll_introduction_cancel" msgid="3199351118385606526">""</string>
     <string name="security_settings_fingerprint_enroll_introduction_continue" msgid="7472492858148162530">""</string>
     <string name="security_settings_fingerprint_enroll_introduction_cancel_setup" msgid="5021369420474432665">""</string>
     <string name="security_settings_fingerprint_enroll_introduction_continue_setup" msgid="8386444182056861429">""</string>
     <string name="lock_screen_intro_skip_dialog_text_frp" product="tablet" msgid="7234486440384881699">""</string>
     <string name="lock_screen_intro_skip_dialog_text_frp" product="device" msgid="3519190003101280912">""</string>
-    <string name="lock_screen_intro_skip_dialog_text_frp" product="default" msgid="417315011140961">""</string>
+    <string name="lock_screen_intro_skip_dialog_text_frp" product="default" msgid="417315011140961">""</string>
     <string name="lock_screen_intro_skip_dialog_text" product="tablet" msgid="8783499872534165700">""</string>
     <string name="lock_screen_intro_skip_dialog_text" product="device" msgid="3120512940873907578">""</string>
-    <string name="lock_screen_intro_skip_dialog_text" product="default" msgid="3589945558504439395">""</string>
+    <string name="lock_screen_intro_skip_dialog_text" product="default" msgid="3589945558504439395">""</string>
     <string name="skip_anyway_button_label" msgid="2323522873558834513">""</string>
     <string name="go_back_button_label" msgid="4745265266186209467">""</string>
     <string name="security_settings_fingerprint_enroll_find_sensor_title" msgid="5877265753699187149">""</string>
-    <string name="security_settings_fingerprint_enroll_find_sensor_message" msgid="1959655161889313661">""</string>
+    <string name="security_settings_fingerprint_enroll_find_sensor_message" msgid="1959655161889313661">""</string>
     <string name="security_settings_fingerprint_enroll_find_sensor_content_description" msgid="2058830032070449160">""</string>
     <string name="security_settings_fingerprint_enroll_dialog_name_label" msgid="7086763077909041106">""</string>
     <string name="security_settings_fingerprint_enroll_dialog_ok" msgid="4150384963879569750">""</string>
@@ -362,7 +362,7 @@
     <string name="setup_fingerprint_enroll_finish_message" msgid="7234264291957984004">""</string>
     <string name="setup_fingerprint_enroll_finish_message_secondary" msgid="7280546429133276374">""</string>
     <string name="setup_fingerprint_enroll_enrolling_skip_title" msgid="6808422329107426923">""</string>
-    <string name="setup_fingerprint_enroll_enrolling_skip_message" msgid="274849306857859783">""</string>
+    <string name="setup_fingerprint_enroll_enrolling_skip_message" msgid="274849306857859783">""</string>
     <string name="security_settings_fingerprint_enroll_setup_screen_lock" msgid="1195743489835505376">""</string>
     <string name="security_settings_fingerprint_enroll_done" msgid="4014607378328187567">""</string>
     <string name="security_settings_fingerprint_enroll_touch_dialog_title" msgid="1863561601428695160">""</string>
@@ -372,47 +372,47 @@
     <string name="security_settings_fingerprint_enroll_error_generic_dialog_message" msgid="3624760637222239293">""</string>
     <string name="fingerprint_enroll_button_add" msgid="6317978977419045463">""</string>
     <string name="fingerprint_enroll_button_next" msgid="6247009337616342759">""</string>
-    <string name="security_settings_fingerprint_enroll_disclaimer" msgid="2624905914239271751">""<annotation id="url">""</annotation></string>
+    <string name="security_settings_fingerprint_enroll_disclaimer" msgid="2624905914239271751">""<annotation id="url">""</annotation></string>
     <string name="security_settings_fingerprint_enroll_disclaimer_lockscreen_disabled" msgid="7007548031540826618">""<annotation id="admin_details">""</annotation>\n\n""<annotation id="url">""</annotation></string>
     <string name="security_settings_fingerprint_enroll_lift_touch_again" msgid="1888772560642539718">""</string>
     <string name="setup_fingerprint_enroll_finish_message" msgid="4132164775128798343">""</string>
     <string name="setup_fingerprint_enroll_finish_secondary_message" msgid="3734962461534384882">"&gt;&gt;"</string>
     <string name="fingerprint_add_max" msgid="1020927549936895822">" <xliff:g id="COUNT">%d</xliff:g> "</string>
     <string name="fingerprint_last_delete_title" msgid="6410310101247028988">""</string>
-    <string name="fingerprint_last_delete_message" msgid="8318926239554839722">""</string>
+    <string name="fingerprint_last_delete_message" msgid="8318926239554839722">""</string>
     <string name="fingerprint_last_delete_message_profile_challenge" msgid="8840100810725902159">""</string>
     <string name="fingerprint_last_delete_confirm" msgid="2634726361059274289">""</string>
     <string name="confirm_fingerprint_icon_content_description" msgid="5255544532157079096">""</string>
     <string name="crypt_keeper_settings_title" msgid="4219233835490520414">""</string>
     <string name="crypt_keeper_encrypt_title" product="tablet" msgid="1060273569887301457">""</string>
-    <string name="crypt_keeper_encrypt_title" product="default" msgid="1878996487755806122">""</string>
+    <string name="crypt_keeper_encrypt_title" product="default" msgid="1878996487755806122">""</string>
     <string name="crypt_keeper_encrypted_summary" msgid="1868233637888132906">""</string>
     <string name="crypt_keeper_desc" product="tablet" msgid="503014594435731275">"PIN\n\n1"</string>
-    <string name="crypt_keeper_desc" product="default" msgid="2579929266645543631">"PIN\n\n1"</string>
+    <string name="crypt_keeper_desc" product="default" msgid="2579929266645543631">"PIN\n\n1"</string>
     <string name="crypt_keeper_button_text" product="tablet" msgid="1189623490604750854">""</string>
-    <string name="crypt_keeper_button_text" product="default" msgid="2008346408473255519">""</string>
+    <string name="crypt_keeper_button_text" product="default" msgid="2008346408473255519">""</string>
     <string name="crypt_keeper_low_charge_text" msgid="2029407131227814893">""</string>
     <string name="crypt_keeper_unplugged_text" msgid="4785376766063053901">""</string>
     <string name="crypt_keeper_dialog_need_password_title" msgid="4058971800557767">"PIN"</string>
     <string name="crypt_keeper_dialog_need_password_message" msgid="4071395977297369642">"PIN"</string>
     <string name="crypt_keeper_confirm_title" msgid="5100339496381875522">""</string>
     <string name="crypt_keeper_final_desc" product="tablet" msgid="517662068757620756">"1"</string>
-    <string name="crypt_keeper_final_desc" product="default" msgid="287503113671320916">"1"</string>
+    <string name="crypt_keeper_final_desc" product="default" msgid="287503113671320916">"1"</string>
     <string name="crypt_keeper_setup_title" msgid="1783951453124244969">""</string>
     <string name="crypt_keeper_setup_description" product="tablet" msgid="6689952371032099350">" <xliff:g id="PERCENT">^1</xliff:g>%"</string>
-    <string name="crypt_keeper_setup_description" product="default" msgid="951918761585534875">" <xliff:g id="PERCENT">^1</xliff:g>%"</string>
+    <string name="crypt_keeper_setup_description" product="default" msgid="951918761585534875">" <xliff:g id="PERCENT">^1</xliff:g>%"</string>
     <string name="crypt_keeper_setup_time_remaining" product="tablet" msgid="1655047311546745695">"<xliff:g id="DURATION">^1</xliff:g>"</string>
-    <string name="crypt_keeper_setup_time_remaining" product="default" msgid="1862964662304683072">"<xliff:g id="DURATION">^1</xliff:g>"</string>
+    <string name="crypt_keeper_setup_time_remaining" product="default" msgid="1862964662304683072">"<xliff:g id="DURATION">^1</xliff:g>"</string>
     <string name="crypt_keeper_force_power_cycle" product="tablet" msgid="556504311511212648">""</string>
-    <string name="crypt_keeper_force_power_cycle" product="default" msgid="1794353635603020327">""</string>
+    <string name="crypt_keeper_force_power_cycle" product="default" msgid="1794353635603020327">""</string>
     <string name="crypt_keeper_warn_wipe" msgid="2738374897337991667">"<xliff:g id="COUNT">^1</xliff:g>"</string>
     <string name="crypt_keeper_enter_password" msgid="2223340178473871064">""</string>
     <string name="crypt_keeper_failed_title" msgid="7133499413023075961">""</string>
     <string name="crypt_keeper_failed_summary" product="tablet" msgid="8219375738445017266">"\n\nGoogle"</string>
-    <string name="crypt_keeper_failed_summary" product="default" msgid="3270131542549577953">"\n\nGoogle"</string>
+    <string name="crypt_keeper_failed_summary" product="default" msgid="3270131542549577953">"\n\nGoogle"</string>
     <string name="crypt_keeper_data_corrupt_title" msgid="8759119849089795751">""</string>
     <string name="crypt_keeper_data_corrupt_summary" product="tablet" msgid="840107296925798402">"\n\n Google "</string>
-    <string name="crypt_keeper_data_corrupt_summary" product="default" msgid="8843311420059663824">"\n\n Google "</string>
+    <string name="crypt_keeper_data_corrupt_summary" product="default" msgid="8843311420059663824">"\n\n Google "</string>
     <string name="crypt_keeper_switch_input_method" msgid="4168332125223483198">""</string>
     <string name="suggested_lock_settings_title" msgid="5022405858647120434">""</string>
     <string name="suggested_lock_settings_summary" msgid="8778462376012231110">""</string>
@@ -421,11 +421,11 @@
     <string name="lock_settings_picker_title_profile" msgid="8822511284992306796">""</string>
     <string name="setup_lock_settings_picker_title" product="tablet" msgid="90329443364067215">""</string>
     <string name="setup_lock_settings_picker_title" product="device" msgid="2399952075134938929">""</string>
-    <string name="setup_lock_settings_picker_title" product="default" msgid="1572244299605153324">""</string>
+    <string name="setup_lock_settings_picker_title" product="default" msgid="1572244299605153324">""</string>
     <string name="setup_lock_settings_picker_fingerprint_message" msgid="4384500605121098860">"PIN "</string>
     <string name="setup_lock_settings_picker_message" product="tablet" msgid="8919671129189936210">""</string>
     <string name="setup_lock_settings_picker_message" product="device" msgid="3787276514406353777">""</string>
-    <string name="setup_lock_settings_picker_message" product="default" msgid="3692856437543730446">""</string>
+    <string name="setup_lock_settings_picker_message" product="default" msgid="3692856437543730446">""</string>
     <string name="lock_settings_picker_fingerprint_message" msgid="4755230324778371292">""</string>
     <string name="unlock_set_unlock_launch_picker_title" msgid="2084576942666016993">""</string>
     <string name="unlock_set_unlock_launch_picker_title_profile" msgid="124176557311393483">""</string>
@@ -460,19 +460,19 @@
     <string name="unlock_disable_frp_warning_content_pattern" msgid="8869767290771023461">""</string>
     <string name="unlock_disable_frp_warning_content_pattern_fingerprint" msgid="8212242533942400457">"<xliff:g id="EMPTY_LINE">
 
-</xliff:g>"</string>
+</xliff:g>"</string>
     <string name="unlock_disable_frp_warning_content_pin" msgid="586996206210265131">" PIN "</string>
     <string name="unlock_disable_frp_warning_content_pin_fingerprint" msgid="875669051899437197">" PIN <xliff:g id="EMPTY_LINE">
 
-</xliff:g>"</string>
+</xliff:g>"</string>
     <string name="unlock_disable_frp_warning_content_password" msgid="5420612686852555537">""</string>
     <string name="unlock_disable_frp_warning_content_password_fingerprint" msgid="2228159168587170445">"<xliff:g id="EMPTY_LINE">
 
-</xliff:g>"</string>
+</xliff:g>"</string>
     <string name="unlock_disable_frp_warning_content_unknown" msgid="1550718040483548220">""</string>
     <string name="unlock_disable_frp_warning_content_unknown_fingerprint" msgid="6363091330281670692">"<xliff:g id="EMPTY_LINE">
 
-</xliff:g>"</string>
+</xliff:g>"</string>
     <string name="unlock_disable_frp_warning_content_pattern_profile" msgid="8682200103576359918">""</string>
     <string name="unlock_disable_frp_warning_content_pattern_fingerprint_profile" msgid="3675154828957224316">"<xliff:g id="EMPTY_LINE">
 
@@ -599,7 +599,7 @@
     <string name="bluetooth_disconnect_hid_profile" msgid="3282295189719352075">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>"</string>
     <string name="bluetooth_disconnect_pan_user_profile" msgid="8037627994382458698">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>"</string>
     <string name="bluetooth_disconnect_pan_nap_profile" product="tablet" msgid="1262792320446274407">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>"</string>
-    <string name="bluetooth_disconnect_pan_nap_profile" product="default" msgid="5700332050175684571">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>"</string>
+    <string name="bluetooth_disconnect_pan_nap_profile" product="default" msgid="5700332050175684571">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>"</string>
     <string name="bluetooth_device_advanced_title" msgid="6066342531927499308">""</string>
     <string name="bluetooth_device_advanced_online_mode_title" msgid="3689050071425683114">""</string>
     <string name="bluetooth_device_advanced_online_mode_summary" msgid="1204424107263248336">""</string>
@@ -631,7 +631,7 @@
     <string name="link_speed" msgid="8896664974117585555">"%1$d Mbps"</string>
     <string name="nfc_quick_toggle_title" msgid="6769159366307299004">"NFC"</string>
     <string name="nfc_quick_toggle_summary" product="tablet" msgid="8302974395787498915">""</string>
-    <string name="nfc_quick_toggle_summary" product="default" msgid="5237208142892767592">""</string>
+    <string name="nfc_quick_toggle_summary" product="default" msgid="5237208142892767592">""</string>
     <string name="android_beam_settings_title" msgid="7832812974600338649">"Android Beam"</string>
     <string name="android_beam_on_summary" msgid="3618057099355636830">"NFC"</string>
     <string name="android_beam_off_summary" msgid="4663095428454779138">""</string>
@@ -758,13 +758,13 @@
     <string name="wifi_dont_skip" msgid="3615535136327231588">""</string>
     <string name="wifi_skipped_message" product="tablet" msgid="6761689889733331124">"WLANWLAN"</string>
     <string name="wifi_skipped_message" product="device" msgid="1385490367826852775">"WLANWLAN"</string>
-    <string name="wifi_skipped_message" product="default" msgid="6084295135297772350">"WLANWLAN"</string>
+    <string name="wifi_skipped_message" product="default" msgid="6084295135297772350">"WLANWLAN"</string>
     <string name="wifi_and_mobile_skipped_message" product="tablet" msgid="6324917391996718760">" WLAN \n\n"<li>""</li>\n\n<li>""</li>\n\n<li>""</li></string>
     <string name="wifi_and_mobile_skipped_message" product="device" msgid="1110629752293998468">" WLAN \n\n"<li>""</li>\n\n<li>""</li>\n\n<li>""</li></string>
-    <string name="wifi_and_mobile_skipped_message" product="default" msgid="8271524692702309267">" WLAN \n\n"<li>""</li>\n\n<li>""</li>\n\n<li>""</li></string>
+    <string name="wifi_and_mobile_skipped_message" product="default" msgid="8271524692702309267">" WLAN \n\n"<li>""</li>\n\n<li>""</li>\n\n<li>""</li></string>
     <string name="wifi_connect_failed_message" product="tablet" msgid="4474691090681670156">"WLAN"</string>
     <string name="wifi_connect_failed_message" product="device" msgid="8870885845666880869">"WLAN"</string>
-    <string name="wifi_connect_failed_message" product="default" msgid="2185803140161396572">"WLAN"</string>
+    <string name="wifi_connect_failed_message" product="default" msgid="2185803140161396572">"WLAN"</string>
     <string name="wifi_saved_access_points_titlebar" msgid="2996149477240134064">""</string>
     <string name="wifi_advanced_titlebar" msgid="4485841401774142908">"WLAN"</string>
     <string name="wifi_configure_titlebar" msgid="7977475161589303074">" WLAN"</string>
@@ -834,7 +834,7 @@
     <item msgid="2339246858001475047">"2"</item>
     <item msgid="6200207341126893791">"1"</item>
   </string-array>
-    <string name="wifi_calling_off_explanation" msgid="2597566001655908391">"WLAN  WLAN "</string>
+    <string name="wifi_calling_off_explanation" msgid="2597566001655908391">"WLAN  WLAN "</string>
     <string name="home_settings" msgid="212375129455718176">""</string>
     <string name="display_settings_title" msgid="1708697328627382561">""</string>
     <string name="sound_settings" msgid="5534671337768745343">""</string>
@@ -872,16 +872,16 @@
     <string name="dock_audio_summary_desk" msgid="6487784412371139335">""</string>
     <string name="dock_audio_summary_car" msgid="6740897586006248450">""</string>
     <string name="dock_audio_summary_none" product="tablet" msgid="8215337394914283607">""</string>
-    <string name="dock_audio_summary_none" product="default" msgid="289909253741048784">""</string>
+    <string name="dock_audio_summary_none" product="default" msgid="289909253741048784">""</string>
     <string name="dock_audio_summary_unknown" msgid="4465059868974255693">""</string>
     <string name="dock_not_found_title" msgid="3290961741828952424">""</string>
     <string name="dock_not_found_text" product="tablet" msgid="8405432495282299143">""</string>
-    <string name="dock_not_found_text" product="default" msgid="1460497923342627801">""</string>
+    <string name="dock_not_found_text" product="default" msgid="1460497923342627801">""</string>
     <string name="dock_sounds_enable_title" msgid="885839627097024110">""</string>
     <string name="dock_sounds_enable_summary_on" product="tablet" msgid="838102386448981339">""</string>
-    <string name="dock_sounds_enable_summary_on" product="default" msgid="8491180514199743771">""</string>
+    <string name="dock_sounds_enable_summary_on" product="default" msgid="8491180514199743771">""</string>
     <string name="dock_sounds_enable_summary_off" product="tablet" msgid="4308252722466813560">""</string>
-    <string name="dock_sounds_enable_summary_off" product="default" msgid="2034927992716667672">""</string>
+    <string name="dock_sounds_enable_summary_off" product="default" msgid="2034927992716667672">""</string>
     <string name="account_settings" msgid="6403589284618783461">""</string>
     <string name="accessibility_category_work" msgid="4339262969083355720">" - <xliff:g id="MANAGED_BY">%s</xliff:g>"</string>
     <string name="accessibility_category_personal" msgid="1263518850905945594">""</string>
@@ -892,9 +892,9 @@
     <string name="display_settings" msgid="7965901687241669598">""</string>
     <string name="accelerometer_title" msgid="7854608399547349157">""</string>
     <string name="accelerometer_summary_on" product="tablet" msgid="429982132339828942">""</string>
-    <string name="accelerometer_summary_on" product="default" msgid="1133737282813048021">""</string>
+    <string name="accelerometer_summary_on" product="default" msgid="1133737282813048021">""</string>
     <string name="accelerometer_summary_off" product="tablet" msgid="4781734213242521682">""</string>
-    <string name="accelerometer_summary_off" product="default" msgid="5485489363715740761">""</string>
+    <string name="accelerometer_summary_off" product="default" msgid="5485489363715740761">""</string>
     <string name="brightness" msgid="8480105032417444275">""</string>
     <string name="brightness_title" msgid="5746272622112982836">""</string>
     <string name="brightness_summary" msgid="838917350127550703">""</string>
@@ -913,7 +913,7 @@
     <string name="screensaver_settings_summary_sleep" msgid="9086186698140423493">""</string>
     <string name="screensaver_settings_summary_dock" msgid="2072657401664633283">""</string>
     <string name="screensaver_settings_summary_off" msgid="2481581696365146473">""</string>
-    <string name="screensaver_settings_disabled_prompt" msgid="1239088321034437608">"/"</string>
+    <string name="screensaver_settings_disabled_prompt" msgid="1239088321034437608">"/"</string>
     <string name="screensaver_settings_when_to_dream" msgid="8644479926302707286">""</string>
     <string name="screensaver_settings_dream_start" msgid="4998187847985120168">""</string>
     <string name="screensaver_settings_button" msgid="7292214707625717013">""</string>
@@ -928,9 +928,9 @@
     <string name="sim_lock_settings_title" msgid="9018585580955414596">"SIM"</string>
     <string name="sim_pin_toggle" msgid="1742123478029451888">"SIM"</string>
     <string name="sim_lock_on" product="tablet" msgid="5058355081270397764">"PIN"</string>
-    <string name="sim_lock_on" product="default" msgid="2503536505568814324">"PIN"</string>
+    <string name="sim_lock_on" product="default" msgid="2503536505568814324">"PIN"</string>
     <string name="sim_lock_off" product="tablet" msgid="2813800553917012356">"PIN"</string>
-    <string name="sim_lock_off" product="default" msgid="258981978215428916">"PIN"</string>
+    <string name="sim_lock_off" product="default" msgid="258981978215428916">"PIN"</string>
     <string name="sim_pin_change" msgid="6311414184279932368">"SIMPIN"</string>
     <string name="sim_enter_pin" msgid="6608715137008508432">"SIMPIN"</string>
     <string name="sim_enable_sim_lock" msgid="4517742794997166918">"SIM"</string>
@@ -959,7 +959,7 @@
     </plurals>
     <string name="pin_failed" msgid="1848423634948587645">"SIMPIN"</string>
     <string name="device_info_settings" product="tablet" msgid="1119755927536987178">""</string>
-    <string name="device_info_settings" product="default" msgid="475872867864762157">""</string>
+    <string name="device_info_settings" product="default" msgid="475872867864762157">""</string>
     <string name="system_update_settings_list_item_title" msgid="3342887311059985961">""</string>
     <string name="system_update_settings_list_item_summary" msgid="3853057315907710747"></string>
     <string name="firmware_version" msgid="4801135784886859972">"Android "</string>
@@ -974,7 +974,7 @@
     <string name="device_status_activity_title" msgid="1411201799384697904">""</string>
     <string name="device_status" msgid="607405385799807324">""</string>
     <string name="device_status_summary" product="tablet" msgid="3292717754497039686">""</string>
-    <string name="device_status_summary" product="default" msgid="2599162787451519618">""</string>
+    <string name="device_status_summary" product="default" msgid="2599162787451519618">"MAC "</string>
     <string name="storage_settings" msgid="4211799979832404953">""</string>
     <string name="storage_usb_settings" msgid="7293054033137078060">""</string>
     <string name="storage_settings_title" msgid="8746016738388094064">""</string>
@@ -1178,7 +1178,7 @@
     <string name="device_reset_title" msgid="2384019005638768076">""</string>
     <string name="master_clear_title" msgid="5907939616087039756">""</string>
     <string name="master_clear_desc" product="tablet" msgid="9146059417023157222">""<b>""</b>"\n\n"<li>"Google"</li>\n<li>""</li>\n<li>""</li></string>
-    <string name="master_clear_desc" product="default" msgid="4800386183314202571">""<b>""</b>"\n\n"<li>"Google"</li>\n<li>""</li>\n<li>""</li></string>
+    <string name="master_clear_desc" product="default" msgid="4800386183314202571">""<b>""</b>"\n\n"<li>"Google"</li>\n<li>""</li>\n<li>""</li></string>
     <string name="master_clear_accounts" product="default" msgid="6412857499147999073">\n\n"\n"</string>
     <string name="master_clear_other_users_present" product="default" msgid="5161423070702470742">\n\n"\n"</string>
     <string name="master_clear_desc_also_erases_external" msgid="1903185203791274237"><li>""</li>\n<li>""</li>\n<li>""</li></string>
@@ -1189,7 +1189,7 @@
     <string name="erase_external_storage_description" product="nosdcard" msgid="4728558173931599429">"USB"</string>
     <string name="erase_external_storage_description" product="default" msgid="1737638779582964966">"SD"</string>
     <string name="master_clear_button_text" product="tablet" msgid="3130786116528304116">""</string>
-    <string name="master_clear_button_text" product="default" msgid="7550632653343157971">""</string>
+    <string name="master_clear_button_text" product="default" msgid="7550632653343157971">""</string>
     <string name="master_clear_final_desc" msgid="7318683914280403086">""</string>
     <string name="master_clear_final_button_text" msgid="5390908019019242910">""</string>
     <string name="master_clear_failed" msgid="2503230016394586353">""</string>
@@ -1215,20 +1215,20 @@
     <string name="usb_tethering_errored_subtext" msgid="1377574819427841992">"USB"</string>
     <string name="bluetooth_tether_checkbox_text" msgid="2379175828878753652">""</string>
     <string name="bluetooth_tethering_available_subtext" product="tablet" msgid="4328374808439440517">""</string>
-    <string name="bluetooth_tethering_available_subtext" product="default" msgid="7451579908917710359">""</string>
+    <string name="bluetooth_tethering_available_subtext" product="default" msgid="7451579908917710359">""</string>
     <string name="bluetooth_tethering_device_connected_subtext" product="tablet" msgid="7296104766087335891">"1"</string>
-    <string name="bluetooth_tethering_device_connected_subtext" product="default" msgid="2785474869740805972">"1"</string>
+    <string name="bluetooth_tethering_device_connected_subtext" product="default" msgid="2785474869740805972">"1"</string>
     <string name="bluetooth_tethering_devices_connected_subtext" product="tablet" msgid="7345108029216525495">"<xliff:g id="CONNECTEDDEVICECOUNT">%1$d</xliff:g>"</string>
-    <string name="bluetooth_tethering_devices_connected_subtext" product="default" msgid="2992288063706153665">"<xliff:g id="CONNECTEDDEVICECOUNT">%1$d</xliff:g>"</string>
+    <string name="bluetooth_tethering_devices_connected_subtext" product="default" msgid="2992288063706153665">"<xliff:g id="CONNECTEDDEVICECOUNT">%1$d</xliff:g>"</string>
     <string name="bluetooth_tethering_off_subtext_config" msgid="6630416508030836214">"<xliff:g id="DEVICE_NAME">%1$d</xliff:g>"</string>
     <string name="bluetooth_tethering_off_subtext" product="tablet" msgid="3737828501935728137">""</string>
-    <string name="bluetooth_tethering_off_subtext" product="default" msgid="9099562374002272901">""</string>
+    <string name="bluetooth_tethering_off_subtext" product="default" msgid="9099562374002272901">""</string>
     <string name="bluetooth_tethering_errored_subtext" msgid="4926566308991142264">""</string>
     <string name="bluetooth_tethering_overflow_error" msgid="2135590598511178690">" <xliff:g id="MAXCONNECTION">%1$d</xliff:g> "</string>
     <string name="bluetooth_untether_blank" msgid="2871192409329334813">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>"</string>
     <string name="tethering_help_button_text" msgid="656117495547173630">""</string>
     <string name="network_settings_title" msgid="4871233236744292831">""</string>
-    <string name="manage_mobile_plan_title" msgid="7630170375010107744">""</string>
+    <string name="manage_mobile_plan_title" msgid="7630170375010107744">""</string>
     <string name="sms_application_title" msgid="4903928270533250448">""</string>
     <string name="sms_change_default_dialog_title" msgid="1958688831875804286">""</string>
     <string name="sms_change_default_dialog_text" msgid="1522783933230274787">"<xliff:g id="NEW_APP">%1$s</xliff:g><xliff:g id="CURRENT_APP">%2$s</xliff:g>"</string>
@@ -1267,7 +1267,7 @@
     <string name="location_neighborhood_level_wifi" msgid="4234820941954812210">"WLAN"</string>
     <string name="location_gps" msgid="8392461023569708478">"GPS"</string>
     <string name="location_street_level" product="tablet" msgid="1669562198260860802">"GPS"</string>
-    <string name="location_street_level" product="default" msgid="4617445745492014203">"GPS"</string>
+    <string name="location_street_level" product="default" msgid="4617445745492014203">"GPS"</string>
     <string name="assisted_gps" msgid="4649317129586736885">"GPS"</string>
     <string name="assisted_gps_enabled" msgid="8751899609589792803">"GPS"</string>
     <string name="assisted_gps_disabled" msgid="6982698333968010748">"GPSGPS"</string>
@@ -1277,7 +1277,7 @@
     <string name="location_access_summary" msgid="69031404093194341">""</string>
     <string name="location_sources_heading" msgid="1278732419851088319">""</string>
     <string name="about_settings" product="tablet" msgid="593457295516533765">""</string>
-    <string name="about_settings" product="default" msgid="1743378368185371685">""</string>
+    <string name="about_settings" product="default" msgid="1743378368185371685">""</string>
     <string name="about_settings" product="emulator" msgid="221313099578564438">""</string>
     <string name="about_settings_summary" msgid="3371517697156165959">""</string>
     <string name="legal_information" msgid="5769301644270604095">""</string>
@@ -1352,7 +1352,7 @@
     <string name="lockpattern_settings_change_lock_pattern" msgid="1123908306116495545">""</string>
     <string name="lockpattern_settings_help_how_to_record" msgid="2614673439060830433">""</string>
     <string name="lockpattern_too_many_failed_confirmation_attempts" msgid="6909161623701848863">" <xliff:g id="NUMBER">%d</xliff:g> "</string>
-    <string name="activity_not_found" msgid="5551664692991605325">""</string>
+    <string name="activity_not_found" msgid="5551664692991605325">""</string>
     <string name="lock_settings_profile_title" msgid="2121876391814535295">""</string>
     <string name="lock_settings_profile_screen_lock_title" msgid="3334747927367115256">""</string>
     <string name="lock_settings_profile_unification_title" msgid="6888460471428172592">""</string>
@@ -1373,7 +1373,7 @@
     <string name="install_unknown_applications_title" msgid="663831043139080992">"Google Play"</string>
     <string name="install_unknown_applications" msgid="176855644862942064">""</string>
     <string name="install_all_warning" product="tablet" msgid="3263360446508268880">""</string>
-    <string name="install_all_warning" product="default" msgid="8113734576826384682">""</string>
+    <string name="install_all_warning" product="default" msgid="8113734576826384682">""</string>
     <string name="advanced_settings" msgid="1777249286757067969">""</string>
     <string name="advanced_settings_summary" msgid="4016682978071086747">""</string>
     <string name="application_info_label" msgid="5736524913065714880">""</string>
@@ -1451,7 +1451,7 @@
     <string name="security_settings_desc" product="tablet" msgid="1292421279262430109">""</string>
     <string name="security_settings_desc" product="default" msgid="61749028818785244">""</string>
     <string name="security_settings_desc_multi" product="tablet" msgid="7300932212437084403">"<xliff:g id="BASE_APP_NAME">%1$s</xliff:g><xliff:g id="ADDITIONAL_APPS_LIST">%2$s</xliff:g>"</string>
-    <string name="security_settings_desc_multi" product="default" msgid="6610268420793984752">"<xliff:g id="BASE_APP_NAME">%1$s</xliff:g><xliff:g id="ADDITIONAL_APPS_LIST">%2$s</xliff:g>"</string>
+    <string name="security_settings_desc_multi" product="default" msgid="6610268420793984752">"<xliff:g id="BASE_APP_NAME">%1$s</xliff:g><xliff:g id="ADDITIONAL_APPS_LIST">%2$s</xliff:g>"</string>
     <string name="join_two_items" msgid="1336880355987539064">"<xliff:g id="FIRST_ITEM">%1$s</xliff:g><xliff:g id="SECOND_ITEM">%2$s</xliff:g>"</string>
     <string name="join_two_unrelated_items" msgid="1873827777191260824">"<xliff:g id="FIRST_ITEM">%1$s</xliff:g><xliff:g id="SECOND_ITEM">%2$s</xliff:g>"</string>
     <string name="join_many_items_last" msgid="5925635036718502724">"<xliff:g id="ALL_BUT_LAST_ITEM">%1$s</xliff:g><xliff:g id="LAST_ITEM_0">%2$s</xliff:g>"</string>
@@ -1465,7 +1465,7 @@
     <string name="version_text" msgid="9189073826278676425">" <xliff:g id="VERSION_NUM">%1$s</xliff:g>"</string>
     <string name="move_app" msgid="5042838441401731346">""</string>
     <string name="move_app_to_internal" product="tablet" msgid="2299714147283854957">""</string>
-    <string name="move_app_to_internal" product="default" msgid="3895430471913858185">""</string>
+    <string name="move_app_to_internal" product="default" msgid="3895430471913858185">""</string>
     <string name="move_app_to_sdcard" product="nosdcard" msgid="4350451696315265420">"USB"</string>
     <string name="move_app_to_sdcard" product="default" msgid="1143379049903056407">"SD"</string>
     <string name="moving" msgid="6431016143218876491">""</string>
@@ -1538,7 +1538,7 @@
     <string name="process_provider_in_use_description" msgid="5586603325677678940">"<xliff:g id="COMP_NAME">%1$s</xliff:g>"</string>
     <string name="runningservicedetails_stop_dlg_title" msgid="4253292537154337233">""</string>
     <string name="runningservicedetails_stop_dlg_text" product="tablet" msgid="3371302398335665793">""</string>
-    <string name="runningservicedetails_stop_dlg_text" product="default" msgid="3920243762189484756">""</string>
+    <string name="runningservicedetails_stop_dlg_text" product="default" msgid="3920243762189484756">""</string>
     <string name="language_settings" msgid="8758655933029560944">""</string>
     <string name="language_keyboard_settings_title" msgid="3709159207482544398">""</string>
     <string name="keyboard_settings_category" msgid="8275523930352487827">""</string>
@@ -1599,7 +1599,7 @@
     <string name="user_dict_settings_more_languages" msgid="7316375944684977910">"..."</string>
     <string name="testing" msgid="6584352735303604146">""</string>
     <string name="testing_phone_info" product="tablet" msgid="193561832258534798">""</string>
-    <string name="testing_phone_info" product="default" msgid="8656693364332840056">""</string>
+    <string name="testing_phone_info" product="default" msgid="8656693364332840056">""</string>
     <string name="input_methods_settings_title" msgid="6800066636850553887">""</string>
     <string name="input_method" msgid="5434026103176856164">""</string>
     <string name="current_input_method" msgid="2636466029213488159">""</string>
@@ -1801,7 +1801,7 @@
     <string name="power_cell" msgid="6596471490976003056">""</string>
     <string name="power_phone" msgid="5392641106474567277">""</string>
     <string name="power_idle" product="tablet" msgid="4612478572401640759">""</string>
-    <string name="power_idle" product="default" msgid="9055659695602194990">""</string>
+    <string name="power_idle" product="default" msgid="9055659695602194990">""</string>
     <string name="power_unaccounted" msgid="709925017022660740">""</string>
     <string name="power_overcounted" msgid="2762354976171358445">""</string>
     <string name="usage_type_cpu" msgid="715162150698338714">"CPU"</string>
@@ -1833,7 +1833,7 @@
     <string name="battery_action_bluetooth" msgid="8374789049507723142">""</string>
     <string name="battery_desc_voice" msgid="8980322055722959211">""</string>
     <string name="battery_desc_standby" product="tablet" msgid="6284747418668280364">""</string>
-    <string name="battery_desc_standby" product="default" msgid="3009080001948091424">""</string>
+    <string name="battery_desc_standby" product="default" msgid="3009080001948091424">""</string>
     <string name="battery_desc_radio" msgid="5479196477223185367">""</string>
     <string name="battery_sugg_radio" msgid="8211336978326295047">""</string>
     <string name="battery_desc_flashlight" msgid="2908579430841025494">""</string>
@@ -1967,8 +1967,8 @@
     <string name="usage_access_title" msgid="332333405495457839">""</string>
     <string name="emergency_tone_title" msgid="1055954530111587114">""</string>
     <string name="emergency_tone_summary" msgid="722259232924572153">""</string>
-    <string name="privacy_settings" msgid="5446972770562918934">""</string>
-    <string name="privacy_settings_title" msgid="4856282165773594890">""</string>
+    <string name="privacy_settings" msgid="5446972770562918934">""</string>
+    <string name="privacy_settings_title" msgid="4856282165773594890">""</string>
     <string name="backup_section_title" msgid="7952232291452882740">""</string>
     <string name="personal_data_section_title" msgid="7815209034443782061">""</string>
     <string name="backup_data_title" msgid="1239105919852668016">""</string>
@@ -2077,7 +2077,7 @@
     <string name="finish_button_label" msgid="481587707657751116">""</string>
     <string name="really_remove_account_title" msgid="8800653398717172460">""</string>
     <string name="really_remove_account_message" product="tablet" msgid="1936147502815641161">""</string>
-    <string name="really_remove_account_message" product="default" msgid="3483528757922948356">""</string>
+    <string name="really_remove_account_message" product="default" msgid="3483528757922948356">""</string>
     <string name="remove_account_failed" msgid="6980737964448187854">""</string>
     <string name="provider_label" msgid="7724593781904508866">""</string>
     <!-- no translation found for sync_item_title (4782834606909853006) -->
@@ -2138,6 +2138,7 @@
     <string name="data_usage_tab_wifi" msgid="481146038146585749">"WLAN"</string>
     <string name="data_usage_tab_ethernet" msgid="7298064366282319911">""</string>
     <string name="data_usage_tab_mobile" msgid="2084466270343460491">""</string>
+    <string name="pppoe_hint">""</string>
     <string name="data_usage_tab_4g" msgid="1301978716067512235">"4G"</string>
     <string name="data_usage_tab_3g" msgid="6092169523081538718">"2G-3G"</string>
     <string name="data_usage_list_mobile" msgid="7219011330831181312">""</string>
@@ -2156,7 +2157,7 @@
     <string name="data_usage_restrict_denied_dialog" msgid="1493134803720421674">""</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="2438617846762244389">""</string>
     <string name="data_usage_auto_sync_on_dialog" product="tablet" msgid="8581983093524041669">"\n\nGoogle"</string>
-    <string name="data_usage_auto_sync_on_dialog" product="default" msgid="8651376294887142858">"\n\nGoogle"</string>
+    <string name="data_usage_auto_sync_on_dialog" product="default" msgid="8651376294887142858">"\n\nGoogle"</string>
     <string name="data_usage_auto_sync_off_dialog_title" msgid="9013139130490125793">""</string>
     <string name="data_usage_auto_sync_off_dialog" msgid="4025938250775413864">""</string>
     <string name="data_usage_cycle_editor_title" msgid="1373797281540188533">""</string>
@@ -2166,11 +2167,11 @@
     <string name="data_usage_limit_editor_title" msgid="9153595142385030015">""</string>
     <string name="data_usage_limit_dialog_title" msgid="3023111643632996097">""</string>
     <string name="data_usage_limit_dialog_mobile" product="tablet" msgid="5788774061143636263">"\n\n"</string>
-    <string name="data_usage_limit_dialog_mobile" product="default" msgid="3511301596446820549">"\n\n"</string>
+    <string name="data_usage_limit_dialog_mobile" product="default" msgid="3511301596446820549">"\n\n"</string>
     <string name="data_usage_restrict_background_title" msgid="2201315502223035062">""</string>
     <string name="data_usage_restrict_background" msgid="6264965779074729381">"WLAN"</string>
     <string name="data_usage_restrict_background_multiuser" product="tablet" msgid="7954930300449415764">"WLAN\n\n"</string>
-    <string name="data_usage_restrict_background_multiuser" product="default" msgid="259958321968870600">"WLAN\n\n"</string>
+    <string name="data_usage_restrict_background_multiuser" product="default" msgid="259958321968870600">"WLAN\n\n"</string>
     <string name="data_usage_sweep_warning" msgid="6387081852568846982"><font size="18">"<xliff:g id="NUMBER">^1</xliff:g>"</font>" "<font size="9">"<xliff:g id="UNIT">^2</xliff:g>"</font>\n<font size="12">""</font></string>
     <string name="data_usage_sweep_limit" msgid="860566507375933039"><font size="18">"<xliff:g id="NUMBER">^1</xliff:g>"</font>" "<font size="9">"<xliff:g id="UNIT">^2</xliff:g>"</font>\n<font size="12">""</font></string>
     <string name="data_usage_uninstalled_apps" msgid="614263770923231598">""</string>
@@ -2178,7 +2179,7 @@
     <string name="data_usage_received_sent" msgid="5039699009276621757">"<xliff:g id="RECEIVED">%1$s</xliff:g><xliff:g id="SENT">%2$s</xliff:g>"</string>
     <string name="data_usage_total_during_range" msgid="4091294280619255237">"<xliff:g id="RANGE">%2$s</xliff:g> <xliff:g id="TOTAL">%1$s</xliff:g>"</string>
     <string name="data_usage_total_during_range_mobile" product="tablet" msgid="1925687342154538972">"<xliff:g id="RANGE">%2$s</xliff:g> <xliff:g id="TOTAL">%1$s</xliff:g>"</string>
-    <string name="data_usage_total_during_range_mobile" product="default" msgid="5063981061103812900">"<xliff:g id="RANGE">%2$s</xliff:g> <xliff:g id="TOTAL">%1$s</xliff:g>"</string>
+    <string name="data_usage_total_during_range_mobile" product="default" msgid="5063981061103812900">"<xliff:g id="RANGE">%2$s</xliff:g> <xliff:g id="TOTAL">%1$s</xliff:g>"</string>
     <string name="data_usage_metered_title" msgid="7383175371006596441">""</string>
     <string name="data_usage_metered_body" msgid="3262343834446126044">""</string>
     <string name="data_usage_metered_mobile" msgid="2326986339431119372">""</string>
@@ -2306,7 +2307,7 @@
     <string name="user_setup_button_setup_now" msgid="3391388430158437629">""</string>
     <string name="user_setup_button_setup_later" msgid="3068729597269172401">""</string>
     <string name="user_cannot_manage_message" product="tablet" msgid="7153048188252553320">""</string>
-    <string name="user_cannot_manage_message" product="default" msgid="959315813089950649">""</string>
+    <string name="user_cannot_manage_message" product="default" msgid="959315813089950649">""</string>
     <string name="user_cannot_add_accounts_message" msgid="5116692653439737050">""</string>
     <string name="user_remove_user_menu" msgid="6897150520686691355">"<xliff:g id="USER_NAME">%1$s</xliff:g>"</string>
     <string name="user_lockscreen_settings" msgid="4965661345247084878">""</string>
@@ -2319,7 +2320,7 @@
     <string name="user_profile_confirm_remove_title" msgid="5573161550669867342">""</string>
     <string name="work_profile_confirm_remove_title" msgid="2017323555783522213">""</string>
     <string name="user_confirm_remove_self_message" product="tablet" msgid="2391372805233812410">""</string>
-    <string name="user_confirm_remove_self_message" product="default" msgid="7943645442479360048">""</string>
+    <string name="user_confirm_remove_self_message" product="default" msgid="7943645442479360048">""</string>
     <string name="user_confirm_remove_message" msgid="1020629390993095037">""</string>
     <string name="work_profile_confirm_remove_message" msgid="323856589749078140">""</string>
     <string name="user_profile_confirm_remove_message" msgid="7373754145959298522">""</string>
@@ -2345,11 +2346,11 @@
     <string name="home_app_uninstall_button" msgid="6808453012607962899">""</string>
     <string name="only_one_home_message" msgid="3538846733750242759">""</string>
     <string name="global_change_warning" product="tablet" msgid="8045013389464294039">""</string>
-    <string name="global_change_warning" product="default" msgid="2461264421590324675">""</string>
+    <string name="global_change_warning" product="default" msgid="2461264421590324675">""</string>
     <string name="global_locale_change_title" msgid="5956281361384221451">""</string>
     <string name="nfc_payment_settings_title" msgid="1807298287380821613">""</string>
     <string name="nfc_payment_how_it_works" msgid="3028822263837896720">""</string>
-    <string name="nfc_payment_no_apps" msgid="5477904979148086424">""</string>
+    <string name="nfc_payment_no_apps" msgid="5477904979148086424">""</string>
     <string name="nfc_payment_default" msgid="8648420259219150395">""</string>
     <string name="nfc_payment_default_not_set" msgid="7485060884228447765">""</string>
     <string name="nfc_payment_app_and_desc" msgid="7942415346564794258">"<xliff:g id="APP">%1$s</xliff:g> - <xliff:g id="DESCRIPTION">%2$s</xliff:g>"</string>
@@ -2358,7 +2359,7 @@
     <string name="nfc_payment_favor_open" msgid="1923314062109977944">""</string>
     <string name="nfc_payment_pay_with" msgid="7524904024378144072">""</string>
     <string name="nfc_how_it_works_title" msgid="1984068457698797207">""</string>
-    <string name="nfc_how_it_works_content" msgid="4749007806393224934">""</string>
+    <string name="nfc_how_it_works_content" msgid="4749007806393224934">""</string>
     <string name="nfc_how_it_works_got_it" msgid="259653300203217402">""</string>
     <string name="nfc_more_title" msgid="815910943655133280">""</string>
     <string name="nfc_payment_set_default_label" msgid="7315817259485674542">""</string>
@@ -2404,7 +2405,7 @@
     <string name="restriction_nfc_enable_title" msgid="5888100955212267941">"NFC"</string>
     <string name="restriction_nfc_enable_summary_config" msgid="3232480757215851738">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>NFC"</string>
     <string name="restriction_nfc_enable_summary" product="tablet" msgid="3891097373396149915">""</string>
-    <string name="restriction_nfc_enable_summary" product="default" msgid="825331120501418592">""</string>
+    <string name="restriction_nfc_enable_summary" product="default" msgid="825331120501418592">""</string>
     <string name="restriction_location_enable_title" msgid="5020268888245775164">""</string>
     <string name="restriction_location_enable_summary" msgid="3489765572281788755">""</string>
     <string name="wizard_back" msgid="5567007959434765743">""</string>
@@ -2460,7 +2461,7 @@
     <string name="search_results_label" msgid="4163304782363526148">""</string>
     <string name="keywords_wifi" msgid="1395786161993828719">"Wi-Fi, WLAN, "</string>
     <string name="keywords_more_default_sms_app" msgid="2265154063220360784">", , , , "</string>
-    <string name="keywords_more_mobile_networks" msgid="1538131503712402851">", , , , 4G, 3G, 2G, LTE"</string>
+    <string name="keywords_more_mobile_networks" msgid="1538131503712402851">", , , , 4G, 3G, 2G, LTE"</string>
     <string name="keywords_wifi_calling" msgid="1784064367330122679">"Wi-Fi, WLAN, , "</string>
     <string name="keywords_home" msgid="3626170808219458848">" "</string>
     <string name="keywords_display" msgid="8910345814565493016">", "</string>
@@ -2512,7 +2513,7 @@
     <string name="alarm_volume_option_title" msgid="8219324421222242421">""</string>
     <string name="ring_volume_option_title" msgid="6767101703671248309">""</string>
     <string name="notification_volume_option_title" msgid="6064656124416882130">""</string>
-    <string name="ringtone_title" msgid="5379026328015343686">""</string>
+    <string name="ringtone_title" msgid="5379026328015343686">""</string>
     <string name="notification_ringtone_title" msgid="3361201340352664272">""</string>
     <string name="alarm_ringtone_title" msgid="2015124067611102995">""</string>
     <string name="vibrate_when_ringing_title" msgid="3806079144545849032">""</string>
@@ -3094,9 +3095,11 @@
     <string name="managed_profile_contact_search_summary" msgid="5431253552272970512">""</string>
     <string name="bluetooth_talkback_computer" msgid="4875089335641234463">""</string>
     <string name="bluetooth_talkback_headset" msgid="5140152177885220949">""</string>
-    <string name="bluetooth_talkback_phone" msgid="4260255181240622896">""</string>
+    <string name="bluetooth_talkback_phone" msgid="4260255181240622896">""</string>
     <string name="bluetooth_talkback_imaging" msgid="551146170554589119">""</string>
     <string name="bluetooth_talkback_headphone" msgid="26580326066627664">""</string>
     <string name="bluetooth_talkback_input_peripheral" msgid="5165842622743212268">""</string>
     <string name="bluetooth_talkback_bluetooth" msgid="5615463912185280812">""</string>
+    <string name="pip_settings" msgid="8615463912185280814">""</string>
+
 </resources>
diff -ur a/packages/apps/Settings/res/xml/development_prefs.xml b/packages/apps/Settings/res/xml/development_prefs.xml
--- a/packages/apps/Settings/res/xml/development_prefs.xml	2018-08-06 15:43:02.869216530 +0200
+++ b/packages/apps/Settings/res/xml/development_prefs.xml	2017-11-23 05:22:41.000000000 +0100
@@ -106,6 +106,10 @@
             android:key="enable_adb"
             android:title="@string/enable_adb"
             android:summary="@string/enable_adb_summary"/>
+	<SwitchPreference
+            android:key="enable_usb0_device"
+            android:title="@string/enable_usb0_device"
+            android:summary="@string/enable_usb0_device_summary"/>
 
         <Preference android:key="clear_adb_keys"
                 android:title="@string/clear_adb_keys" />
diff -ur a/packages/apps/Settings/res/xml/display_settings.xml b/packages/apps/Settings/res/xml/display_settings.xml
--- a/packages/apps/Settings/res/xml/display_settings.xml	2018-08-06 15:43:02.869216530 +0200
+++ b/packages/apps/Settings/res/xml/display_settings.xml	2017-11-23 05:22:41.000000000 +0100
@@ -19,12 +19,13 @@
         android:title="@string/display_settings"
         settings:keywords="@string/keywords_display">
 
+	<!-- Hide brightness mode for TV
         <PreferenceScreen
                 android:key="brightness"
                 android:title="@string/brightness"
                 settings:keywords="@string/keywords_display_brightness_level">
             <intent android:action="android.intent.action.SHOW_BRIGHTNESS_DIALOG" />
-        </PreferenceScreen>
+        </PreferenceScreen> -->
 
         <SwitchPreference
                 android:key="auto_brightness"
@@ -52,8 +53,8 @@
                 android:key="screen_timeout"
                 android:title="@string/screen_timeout"
                 android:summary="@string/screen_timeout_summary"
-                android:entries="@array/screen_timeout_entries"
-                android:entryValues="@array/screen_timeout_values" />
+                android:entries="@array/dream_timeout_entries"
+                android:entryValues="@array/dream_timeout_values" />
 
         <SwitchPreference
                 android:key="camera_gesture"
@@ -111,4 +112,31 @@
                 android:summary="%s"
                 android:title="@string/display_vr_pref_title" />
 
+        <ListPreference
+            android:key="hdmi_output_mode"
+            android:title="@string/hdmi_output_mode"
+            android:summary="@string/hdmi_output_mode_summary"
+            android:persistent="false"
+            android:entries="@*android:array/support_tv_format_entries_hdmi"
+						android:entryValues="@*android:array/support_tv_format_values_hdmi" />
+
+        <ListPreference
+            android:key="display_output_mode"
+            android:title="@string/display_output_mode_title"
+            android:summary="@string/display_output_mode_summary"
+            android:persistent="false"
+            android:entries="@*android:array/support_tv_format_entries_av"
+            android:entryValues="@*android:array/support_tv_format_values_av"/>
+
+        <com.android.settings.DisplayPercentPreference
+            android:key = "tv_screen_percent"
+            android:title = "@string/tv_screen_percent_title"
+            android:summary = "@string/tv_screen_percent_summary"/>
+
+        <PreferenceScreen
+                android:key="pip_screen_set"
+                android:title="@string/pip_screen_set_title"
+                android:summary="@string/pip_screen_set_summary"
+                android:fragment="com.android.settings.pipSettings.PipSettings"/>
+
 </PreferenceScreen>
Only in b/packages/apps/Settings/res/xml: ethernet_no_settings.xml
Only in b/packages/apps/Settings/res/xml: ethernet_settings.xml
Only in b/packages/apps/Settings/res/xml: hdr_settings.xml
Only in b/packages/apps/Settings/res/xml: pip_settings.xml
Only in b/packages/apps/Settings/res/xml: pppoe_settings.xml
diff -ur a/packages/apps/Settings/res/xml/sound_settings.xml b/packages/apps/Settings/res/xml/sound_settings.xml
--- a/packages/apps/Settings/res/xml/sound_settings.xml	2018-08-06 15:43:02.869216530 +0200
+++ b/packages/apps/Settings/res/xml/sound_settings.xml	2017-11-23 05:22:41.000000000 +0100
@@ -44,6 +44,16 @@
                 android:icon="@*android:drawable/ic_audio_ring_notif"
                 android:title="@string/notification_volume_option_title" />
 
+        <Preference
+                android:key="audio_output_mode"
+                android:title="@string/audio_output_mode_title"/>
+
+        <CheckBoxPreference
+                android:key="enable_pass_through"
+                android:title="@string/enable_pass_through"
+                android:summary="@string/enable_pass_through_summary"
+                android:persistent="false" />
+
         <!-- Also vibrate for calls -->
         <SwitchPreference
                 android:key="vibrate_when_ringing"
@@ -90,12 +100,12 @@
                         android:targetClass="com.android.cellbroadcastreceiver.CellBroadcastSettings" />
         </com.android.settingslib.RestrictedPreference>
 
-        <!-- Other sounds -->
+        <!-- Other sounds
         <Preference
                 android:key="other_sounds"
                 android:title="@string/other_sound_settings"
                 android:persistent="false"
-                android:fragment="com.android.settings.notification.OtherSoundSettings" />
+                android:fragment="com.android.settings.notification.OtherSoundSettings" /> -->
 
         <!-- Cast -->
         <PreferenceScreen
diff -ur a/packages/apps/Settings/res/xml/suggestion_ordering.xml b/packages/apps/Settings/res/xml/suggestion_ordering.xml
--- a/packages/apps/Settings/res/xml/suggestion_ordering.xml	2018-08-06 15:43:02.869216530 +0200
+++ b/packages/apps/Settings/res/xml/suggestion_ordering.xml	2017-11-23 05:22:41.000000000 +0100
@@ -15,7 +15,6 @@
 -->
 
 <optional-steps>
-    <step category="com.android.settings.suggested.category.LOCK_SCREEN" />
     <step category="com.android.settings.suggested.category.EMAIL" />
     <step category="com.android.settings.suggested.category.PARTNER_ACCOUNT"
         multiple="true" />
diff -ur a/packages/apps/Settings/src/com/android/settings/bluetooth/BluetoothDevicePreference.java b/packages/apps/Settings/src/com/android/settings/bluetooth/BluetoothDevicePreference.java
--- a/packages/apps/Settings/src/com/android/settings/bluetooth/BluetoothDevicePreference.java	2018-08-06 15:43:02.965217761 +0200
+++ b/packages/apps/Settings/src/com/android/settings/bluetooth/BluetoothDevicePreference.java	2017-11-23 05:22:41.000000000 +0100
@@ -32,6 +32,7 @@
 import android.util.TypedValue;
 import android.view.View;
 import android.view.View.OnClickListener;
+import android.view.KeyEvent;
 import android.widget.ImageView;
 
 import com.android.settings.R;
@@ -50,7 +51,7 @@
  * Bluetooth device in the Bluetooth Settings screen.
  */
 public final class BluetoothDevicePreference extends Preference implements
-        CachedBluetoothDevice.Callback, OnClickListener {
+        CachedBluetoothDevice.Callback, OnClickListener, View.OnKeyListener {
     private static final String TAG = "BluetoothDevicePreference";
 
     private static int sDimAlpha = Integer.MIN_VALUE;
@@ -163,6 +164,9 @@
             if (deviceDetails != null) {
                 deviceDetails.setOnClickListener(this);
                 deviceDetails.setTag(mCachedDevice);
+
+                view.itemView.setOnKeyListener(this);
+                view.itemView.setTag(mCachedDevice);
             }
         }
         final ImageView imageView = (ImageView) view.findViewById(android.R.id.icon);
@@ -180,6 +184,20 @@
     }
 
     @Override
+    public boolean onKey(View view, int keyCode, KeyEvent key) {
+        Log.v(TAG, "key code: " + key.getKeyCode());
+
+        if (key.getKeyCode() == KeyEvent.KEYCODE_DPAD_RIGHT) {
+            if (key.getAction() == KeyEvent.ACTION_DOWN) {
+                if (mOnSettingsClickListener != null) {
+                    mOnSettingsClickListener.onClick(view);
+                }
+            }
+        }
+        return false;
+    }
+
+    @Override
     public boolean equals(Object o) {
         if ((o == null) || !(o instanceof BluetoothDevicePreference)) {
             return false;
diff -ur a/packages/apps/Settings/src/com/android/settings/bluetooth/BluetoothSettings.java b/packages/apps/Settings/src/com/android/settings/bluetooth/BluetoothSettings.java
--- a/packages/apps/Settings/src/com/android/settings/bluetooth/BluetoothSettings.java	2018-08-06 15:43:02.973217862 +0200
+++ b/packages/apps/Settings/src/com/android/settings/bluetooth/BluetoothSettings.java	2017-11-23 05:22:41.000000000 +0100
@@ -439,6 +439,8 @@
         // discoverability to be set again
         if (BluetoothAdapter.STATE_ON == bluetoothState)
             mInitiateDiscoverable = true;
+        setDeviceListGroup(getPreferenceScreen());
+        removeAllDevices();
         updateContent(bluetoothState);
     }
 
diff -ur a/packages/apps/Settings/src/com/android/settings/bluetooth/DeviceListPreferenceFragment.java b/packages/apps/Settings/src/com/android/settings/bluetooth/DeviceListPreferenceFragment.java
--- a/packages/apps/Settings/src/com/android/settings/bluetooth/DeviceListPreferenceFragment.java	2018-08-06 15:43:02.973217862 +0200
+++ b/packages/apps/Settings/src/com/android/settings/bluetooth/DeviceListPreferenceFragment.java	2017-11-23 05:22:41.000000000 +0100
@@ -179,6 +179,11 @@
         String key = cachedDevice.getDevice().getAddress();
         BluetoothDevicePreference preference = (BluetoothDevicePreference) getCachedPreference(key);
 
+		if(preference != null) {
+			mDeviceListGroup.removePreference(preference);
+			preference = null;
+		}
+
         if (preference == null) {
             preference = new BluetoothDevicePreference(getPrefContext(), cachedDevice);
             preference.setKey(key);
diff -ur a/packages/apps/Settings/src/com/android/settings/dashboard/DashboardSummary.java b/packages/apps/Settings/src/com/android/settings/dashboard/DashboardSummary.java
--- a/packages/apps/Settings/src/com/android/settings/dashboard/DashboardSummary.java	2018-08-06 15:43:02.981217966 +0200
+++ b/packages/apps/Settings/src/com/android/settings/dashboard/DashboardSummary.java	2017-11-23 05:22:41.000000000 +0100
@@ -53,6 +53,7 @@
 
     public static final String[] INITIAL_ITEMS = new String[] {
             Settings.WifiSettingsActivity.class.getName(),
+            Settings.EthernetSettingsActivity.class.getName(),
             Settings.BluetoothSettingsActivity.class.getName(),
             Settings.DataUsageSummaryActivity.class.getName(),
             Settings.PowerUsageSummaryActivity.class.getName(),
diff -ur a/packages/apps/Settings/src/com/android/settings/DevelopmentSettings.java b/packages/apps/Settings/src/com/android/settings/DevelopmentSettings.java
--- a/packages/apps/Settings/src/com/android/settings/DevelopmentSettings.java	2018-08-06 15:43:02.925217248 +0200
+++ b/packages/apps/Settings/src/com/android/settings/DevelopmentSettings.java	2017-11-23 05:22:41.000000000 +0100
@@ -112,6 +112,7 @@
     public static final String PREF_SHOW = "show";
 
     private static final String ENABLE_ADB = "enable_adb";
+	private static final String ENABLE_USB0 = "enable_usb0_device";
     private static final String CLEAR_ADB_KEYS = "clear_adb_keys";
     private static final String ENABLE_TERMINAL = "enable_terminal";
     private static final String KEEP_SCREEN_ON = "keep_screen_on";
@@ -231,6 +232,7 @@
     private boolean mDontPokeProperties;
 
     private SwitchPreference mEnableAdb;
+	private SwitchPreference mEnableUsb0;
     private Preference mClearAdbKeys;
     private SwitchPreference mEnableTerminal;
     private Preference mBugreport;
@@ -352,6 +354,7 @@
         final PreferenceGroup debugDebuggingCategory = (PreferenceGroup)
                 findPreference(DEBUG_DEBUGGING_CATEGORY_KEY);
         mEnableAdb = findAndInitSwitchPref(ENABLE_ADB);
+		mEnableUsb0 = findAndInitSwitchPref(ENABLE_USB0);
         mClearAdbKeys = findPreference(CLEAR_ADB_KEYS);
         if (!SystemProperties.getBoolean("ro.adb.secure", false)) {
             if (debugDebuggingCategory != null) {
@@ -645,6 +648,8 @@
         mHaveDebugSettings = false;
         updateSwitchPreference(mEnableAdb, Settings.Global.getInt(cr,
                 Settings.Global.ADB_ENABLED, 0) != 0);
+        updateSwitchPreference(mEnableUsb0, SystemProperties.getInt(
+                "persist.sys.usb0device",0) != 0);
         if (mEnableTerminal != null) {
             updateSwitchPreference(mEnableTerminal,
                     context.getPackageManager().getApplicationEnabledSetting(TERMINAL_APP_PACKAGE)
@@ -1790,7 +1795,10 @@
                 mVerifyAppsOverUsb.setChecked(false);
                 updateBugreportOptions();
             }
-        } else if (preference == mClearAdbKeys) {
+        } else if (preference == mEnableUsb0) {
+            Log.d(TAG,"enable status = " + mEnableUsb0.isChecked());
+			SystemProperties.set("persist.sys.usb0device",mEnableUsb0.isChecked()?"1":"0");
+		}else if (preference == mClearAdbKeys) {
             if (mAdbKeysDialog != null) dismissDialogs();
             mAdbKeysDialog = new AlertDialog.Builder(getActivity())
                         .setMessage(R.string.adb_keys_warning_message)
diff -ur a/packages/apps/Settings/src/com/android/settings/deviceinfo/Status.java b/packages/apps/Settings/src/com/android/settings/deviceinfo/Status.java
--- a/packages/apps/Settings/src/com/android/settings/deviceinfo/Status.java	2018-08-06 15:43:03.005218274 +0200
+++ b/packages/apps/Settings/src/com/android/settings/deviceinfo/Status.java	2017-11-23 05:22:41.000000000 +0100
@@ -188,6 +188,11 @@
             mWimaxMacAddress = null;
         }
 
+        if(true){
+	    removePreferenceFromScreen(KEY_BATTERY_LEVEL);
+            removePreferenceFromScreen(KEY_BATTERY_STATUS);
+	}
+
         mConnectivityIntentFilter = new IntentFilter();
         for (String intent: CONNECTIVITY_INTENTS) {
              mConnectivityIntentFilter.addAction(intent);
diff -ur a/packages/apps/Settings/src/com/android/settings/deviceinfo/StorageSettings.java b/packages/apps/Settings/src/com/android/settings/deviceinfo/StorageSettings.java
--- a/packages/apps/Settings/src/com/android/settings/deviceinfo/StorageSettings.java	2018-08-06 15:43:03.005218274 +0200
+++ b/packages/apps/Settings/src/com/android/settings/deviceinfo/StorageSettings.java	2017-11-23 05:22:41.000000000 +0100
@@ -219,7 +219,7 @@
             getPreferenceScreen().addPreference(mExternalCategory);
         }
 
-        if (mInternalCategory.getPreferenceCount() == 2
+        /*if (mInternalCategory.getPreferenceCount() == 2
                 && mExternalCategory.getPreferenceCount() == 0) {
             // Only showing primary internal storage, so just shortcut
             final Bundle args = new Bundle();
@@ -230,7 +230,7 @@
             intent.putExtra(SettingsDrawerActivity.EXTRA_SHOW_MENU, true);
             getActivity().startActivity(intent);
             finish();
-        }
+        }*/
     }
 
     @Override
@@ -273,16 +273,16 @@
                 return true;
 
             } else if (vol.getType() == VolumeInfo.TYPE_PUBLIC) {
-                if (vol.isMountedReadable()) {
+                /*if (vol.isMountedReadable()) {
                     startActivity(vol.buildBrowseIntent());
                     return true;
-                } else {
+                } else {*/
                     final Bundle args = new Bundle();
                     args.putString(VolumeInfo.EXTRA_VOLUME_ID, vol.getId());
                     startFragment(this, PublicVolumeSettings.class.getCanonicalName(),
                             -1, 0, args);
                     return true;
-                }
+               // }
             }
 
         } else if (key.startsWith("disk:")) {
Only in b/packages/apps/Settings/src/com/android/settings: DisplayOutputModeListPreference.java
Only in b/packages/apps/Settings/src/com/android/settings: DisplayPercentPreference.java
diff -ur a/packages/apps/Settings/src/com/android/settings/DisplaySettings.java b/packages/apps/Settings/src/com/android/settings/DisplaySettings.java
--- a/packages/apps/Settings/src/com/android/settings/DisplaySettings.java	2018-08-06 15:43:02.925217248 +0200
+++ b/packages/apps/Settings/src/com/android/settings/DisplaySettings.java	2017-11-23 05:22:41.000000000 +0100
@@ -19,7 +19,12 @@
 import android.app.Activity;
 import android.app.ActivityManager;
 import android.app.UiModeManager;
+import android.app.Dialog;
+import android.app.AlertDialog;
 import android.app.WallpaperManager;
+import android.os.AsyncTask;
+import android.content.DialogInterface.OnClickListener;
+import android.content.DialogInterface;
 import android.app.admin.DevicePolicyManager;
 import android.content.ContentResolver;
 import android.content.Context;
@@ -34,6 +39,8 @@
 import android.os.SystemProperties;
 import android.os.UserHandle;
 import android.os.UserManager;
+import android.hardware.display.DisplayManager;
+import android.os.DisplayOutputManager;
 import android.provider.SearchIndexableResource;
 import android.provider.Settings;
 import android.support.v14.preference.SwitchPreference;
@@ -43,7 +50,12 @@
 import android.support.v7.preference.Preference.OnPreferenceChangeListener;
 import android.text.TextUtils;
 import android.util.Log;
-
+import android.widget.Toast;
+import android.view.IWindowManager;
+import android.view.Display;
+import android.os.ServiceManager;
+import android.util.AndroidException;
+import android.os.RemoteException;
 import com.android.internal.logging.MetricsLogger;
 import com.android.internal.logging.MetricsProto.MetricsEvent;
 import com.android.internal.view.RotationPolicy;
@@ -75,7 +87,7 @@
 
     /** If there is no setting in the provider, use this. */
     private static final int FALLBACK_SCREEN_TIMEOUT_VALUE = 30000;
-
+		private static final int FALLBACK_DISPLAY_MODE_TIMEOUT = 10;
     private static final String KEY_SCREEN_TIMEOUT = "screen_timeout";
     private static final String KEY_FONT_SIZE = "font_size";
     private static final String KEY_SCREEN_SAVER = "screensaver";
@@ -90,8 +102,22 @@
             = "camera_double_tap_power_gesture";
     private static final String KEY_WALLPAPER = "wallpaper";
     private static final String KEY_VR_DISPLAY_PREF = "vr_display_pref";
+    private DisplayOutputManager mDisplayManager;
+    private static final String KEY_TV_OUTPUT_MODE = "display_output_mode";
+    private static final String KEY_HDMI_OUTPUT_MODE = "hdmi_output_mode";
+    private static final String KEY_HDMI_OUTPUT_MODE_720P = "hdmi_output_mode_720p";
+    private static final String KEY_COLOR_SETTING_CATE = "display_color_setting_cate";
+    private static final String KEY_DISPLAY_OUTPUT_MODE_CATE = "display_output_mode_cate";
+
+    //yangtingrui add begin
+    private static final String KEY_PIP_SCREEN_SET = "pip_screen_set";
+    //yangtingrui add end
 
+    private static final int DLG_GLOBAL_CHANGE_WARNING = 1;
+    private static final int DLG_RESOLUTION_CHANGE_WARNING = 11;
     private Preference mFontSizePref;
+    private ListPreference mOutputMode;
+    private ListPreference mHdmiOutputModePreference;
 
     private TimeoutListPreference mScreenTimeoutPreference;
     private ListPreference mNightModePreference;
@@ -103,6 +129,17 @@
     private SwitchPreference mCameraGesturePreference;
     private SwitchPreference mCameraDoubleTapPowerGesturePreference;
 
+    // yangtingrui add begin
+    private Preference mPipSetPreference=null;
+    // yangtingrui add end
+
+    private boolean isSupport = false;
+    private boolean isSameMode = false;
+
+    private String oldValue;
+    private String newValue;
+    private int format = 0;
+    private boolean dialogTipsFlag;
     @Override
     protected int getMetricsCategory() {
         return MetricsEvent.DISPLAY;
@@ -126,6 +163,8 @@
         mScreenTimeoutPreference = (TimeoutListPreference) findPreference(KEY_SCREEN_TIMEOUT);
 
         mFontSizePref = findPreference(KEY_FONT_SIZE);
+        mHdmiOutputModePreference = (ListPreference)findPreference(KEY_HDMI_OUTPUT_MODE);
+        mOutputMode = (ListPreference)findPreference(KEY_SCREEN_TIMEOUT);
 
         if (isAutomaticBrightnessAvailable(getResources())) {
             mAutoBrightnessPreference = (SwitchPreference) findPreference(KEY_AUTO_BRIGHTNESS);
@@ -169,6 +208,7 @@
         } else {
             removePreference(KEY_CAMERA_DOUBLE_TAP_POWER_GESTURE);
         }
+	removePreference(KEY_CAMERA_DOUBLE_TAP_POWER_GESTURE);
 
         if (RotationPolicy.isRotationLockToggleVisible(activity)) {
             DropDownPreference rotatePreference =
@@ -209,7 +249,14 @@
         } else {
             removePreference(KEY_AUTO_ROTATE);
         }
-
+        mDisplayManager = (DisplayOutputManager)getActivity().getSystemService(
+                Context.DISPLAYOUTPUT_SERVICE);
+        mOutputMode = (ListPreference) findPreference(KEY_TV_OUTPUT_MODE);
+	if(mOutputMode!=null){
+		format = mDisplayManager.getDisplayOutput(android.view.Display.TYPE_BUILT_IN);
+		Log.d(TAG,"format = " + format);
+		mOutputMode.setValue(Integer.toHexString(format));
+	}
         if (isVrDisplayModeAvailable(activity)) {
             DropDownPreference vrDisplayPref =
                     (DropDownPreference) findPreference(KEY_VR_DISPLAY_PREF);
@@ -252,6 +299,15 @@
             mNightModePreference.setValue(String.valueOf(currentNightMode));
             mNightModePreference.setOnPreferenceChangeListener(this);
         }
+
+
+        mPipSetPreference =  findPreference(KEY_PIP_SCREEN_SET);
+        if (null != mPipSetPreference)
+        {
+            mPipSetPreference.setOnPreferenceChangeListener(this);
+
+        }
+
     }
 
     private static boolean allowAllRotations(Context context) {
@@ -315,7 +371,7 @@
                 int best = 0;
                 for (int i = 0; i < values.length; i++) {
                     long timeout = Long.parseLong(values[i].toString());
-                    if (currentTimeout >= timeout) {
+                    if (currentTimeout == timeout) {
                         best = i;
                     }
                 }
@@ -334,6 +390,14 @@
                 SCREEN_OFF_TIMEOUT, FALLBACK_SCREEN_TIMEOUT_VALUE);
         mScreenTimeoutPreference.setValue(String.valueOf(currentTimeout));
         mScreenTimeoutPreference.setOnPreferenceChangeListener(this);
+
+        mHdmiOutputModePreference.setOnPreferenceChangeListener(this);
+        mOutputMode.setOnPreferenceChangeListener(this);
+        int dipslayOutput = mDisplayManager.getDisplayOutput(android.view.Display.TYPE_BUILT_IN);
+	Log.d(TAG,"displayOutput = " + Integer.toHexString(dipslayOutput));
+        mHdmiOutputModePreference.setValue(Integer.toHexString(dipslayOutput));
+        mOutputMode.setValue(Integer.toHexString(dipslayOutput));
+
         final DevicePolicyManager dpm = (DevicePolicyManager) getActivity().getSystemService(
                 Context.DEVICE_POLICY_SERVICE);
         if (dpm != null) {
@@ -439,6 +503,25 @@
             boolean value = (Boolean) objValue;
             Settings.Secure.putInt(getContentResolver(), DOUBLE_TAP_TO_WAKE, value ? 1 : 0);
         }
+        Log.d("Settings","key  = " + key);
+        if (KEY_TV_OUTPUT_MODE.equals(key) || KEY_HDMI_OUTPUT_MODE.equals(key)) {
+	    format  = mDisplayManager.getDisplayOutput(android.view.Display.TYPE_BUILT_IN);
+	    oldValue = Integer.toHexString(format);
+            newValue = (String)objValue;
+            isSameMode = oldValue.equals(newValue);
+	    Log.d("Settings","new value = " + newValue);
+            if(isSameMode)
+                return true;
+            // do not switch to hdmi output when it's plug out!
+            if (!canSwitchToNewOutputType(Integer.parseInt(oldValue, 16), Integer.parseInt(newValue, 16)))
+                return false;
+            dialogTipsFlag = true;
+            switchDispFormat(newValue);
+            if(dialogTipsFlag){
+                showDialog(DLG_RESOLUTION_CHANGE_WARNING);
+            }
+
+	}
         if (preference == mCameraGesturePreference) {
             boolean value = (Boolean) objValue;
             Settings.Secure.putInt(getContentResolver(), CAMERA_GESTURE_DISABLED,
@@ -462,11 +545,173 @@
         return true;
     }
 
+    private boolean canSwitchToNewOutputType(int oldFormat, int newFormat) {
+        int newType = (newFormat & 0xff00) >> 8;
+        int mCurType = mDisplayManager.getDisplayOutputType(android.view.Display.TYPE_BUILT_IN);
+
+        Log.e(TAG, "current output type: " + mCurType + " new ouput type: " + newType);
+        if (mCurType != newType)
+            return false;
+
+        return true;
+    }
+    private void switchDispFormat(String value) {
+	    Log.d(TAG,"switchDispFormat value = " + value);
+	    try {
+	        format = Integer.parseInt(value, 16);
+            int dispformat = mDisplayManager.getDisplayModeFromFormat(format);
+            int mCurType = mDisplayManager.getDisplayOutputType(android.view.Display.TYPE_BUILT_IN);
+            IWindowManager wm = IWindowManager.Stub.asInterface(ServiceManager.checkService(
+                        Context.WINDOW_SERVICE));
+            int setDispOutputOk = 0;
+            int w = 0;
+            int h = 0;
+            int density = 0;
+
+            isSupport = true;
+            if(isSupport){
+                Log.w(TAG, "dm set output format:"+format);
+                setDispOutputOk = mDisplayManager.setDisplayOutput(android.view.Display.TYPE_BUILT_IN, format);
+                Log.w(TAG, "setDisplayOutput return "+setDispOutputOk);
+                if(setDispOutputOk == -1 && dialogTipsFlag){
+                    dialogTipsFlag = !dialogTipsFlag;
+                    Dialog alertDialog = new AlertDialog.Builder(this.getActivity())
+                        .setTitle(this.getResources().getString(R.string.display_support_type_title))
+                        .setMessage(this.getResources().getString(R.string.display_support_type))
+                        .setPositiveButton(
+                                this.getResources().getString(R.string.assistant_security_warning_agree),
+                                new DialogInterface.OnClickListener() {
+                                    @Override
+                                    public void onClick(DialogInterface dialog,
+                                        int which) {
+                                        switchDispFormat(oldValue);
+                                        return ;
+                                    }
+                                }).create();
+                    alertDialog.show();
+                }
+
+                mOutputMode.setValue(value);
+		if(mHdmiOutputModePreference!=null)
+		mHdmiOutputModePreference.setValue(value);
+                if(0xFF == setDispOutputOk) {
+                    switch(dispformat) {
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_3840_2160P_30HZ:
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_3840_2160P_25HZ:
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_3840_2160P_24HZ:
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_1080P_50HZ:
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_1080P_60HZ:
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_1080I_60HZ:
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_1080I_50HZ:
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_1080P_24HZ:
+                        w = 1920;
+                        h = 1080;
+                        density = 240;
+                        break;
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_720P_50HZ:
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_720P_60HZ:
+                        w = 1280;
+                        h = 720;
+                        density = 160;
+                        break;
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_576P:
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_576I:
+                        w = 720;
+                        h = 576;
+                        density = 128;
+                        break;
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_480P:
+                    case DisplayOutputManager.DISPLAY_TVFORMAT_480I:
+                        w = 720;
+                        h = 480;
+                        density = 106;
+                        break;
+                    default:
+                        setDispOutputOk = 1;
+                    }
+                }
+                if(0xFF == setDispOutputOk) {
+                    if (wm == null) {
+                        Log.e(TAG,"wm is null!");
+                    }
+                    try{
+                        wm.setForcedDisplaySize(android.view.Display.DEFAULT_DISPLAY, w, h);
+                        wm.setForcedDisplayDensity(android.view.Display.DEFAULT_DISPLAY, density);
+                    }catch(RemoteException e){
+                        Log.d(TAG,"call setForcedDisplaySize error");
+                    }
+                }
+            }else {
+                Toast.makeText(getActivity(), com.android.settings.R.string.display_mode_unsupport,Toast.LENGTH_LONG).show();
+            }
+        } catch (NumberFormatException e) {
+            Log.w(TAG, "Invalid display output format!");
+        }
+    }    
     @Override
     protected int getHelpResource() {
         return R.string.help_uri_display;
     }
+    
+    @Override
+    public Dialog onCreateDialog(int dialogId) {
+        if (DLG_RESOLUTION_CHANGE_WARNING == dialogId) {
+            OnClickListener listener = new OnClickListener() {
+                @Override
+                    public void onClick(DialogInterface dialog, int btn) {
+                        if (btn == AlertDialog.BUTTON_POSITIVE) {
+                            switchDispFormat(newValue);
+                        } else if (btn == AlertDialog.BUTTON_NEGATIVE) {
+                            switchDispFormat(oldValue);
+                        }
+                        dialog.dismiss();
+                    }
+            };
 
+            String str = getString(com.android.settings.R.string.display_mode_time_out_desc);
+            final AlertDialog dialog = new AlertDialog.Builder(this.getActivity())
+				.setTitle(com.android.settings.R.string.display_mode_time_out_title)
+				.setMessage(String.format(str, Integer.toString(FALLBACK_DISPLAY_MODE_TIMEOUT)))
+				.setPositiveButton(com.android.internal.R.string.ok, listener)
+				.setNegativeButton(com.android.internal.R.string.cancel, listener)
+				.create();
+            dialog.show();
+
+            new AsyncTask(){
+                @Override
+                    protected Object doInBackground(Object... arg0) {
+                        int time = FALLBACK_DISPLAY_MODE_TIMEOUT;
+                        while(time >= 0 && dialog.isShowing()){
+                            publishProgress(time);
+                            try{
+                                Thread.sleep(1000);
+                            }catch(Exception e){}
+                            time--;
+                        }
+                        return null;
+                    }
+                @Override
+                    protected void onPostExecute(Object result) {
+                        super.onPostExecute(result);
+                        if (dialog.isShowing()) {
+                            Log.d(TAG,"oldValue = " + oldValue);
+                            switchDispFormat(oldValue);
+                            dialog.dismiss();
+                        }
+                    }
+                @Override
+                    protected void onProgressUpdate(Object... values) {
+                        super.onProgressUpdate(values);
+                        int time = (Integer)values[0];
+                        String str = getString(com.android.settings.R.string.display_mode_time_out_desc);
+                        dialog.setMessage(String.format(str, Integer.toString(time)));
+                    }
+            }.execute();
+            return dialog;
+        }
+        return null;
+    }
+    
     private void disablePreferenceIfManaged(String key, String restriction) {
         final RestrictedPreference pref = (RestrictedPreference) findPreference(key);
         if (pref != null) {
Only in b/packages/apps/Settings/src/com/android/settings: ethernet
Only in b/packages/apps/Settings/src/com/android/settings: HDRSettings.java
diff -ur a/packages/apps/Settings/src/com/android/settings/localepicker/LocaleDragAndDropAdapter.java b/packages/apps/Settings/src/com/android/settings/localepicker/LocaleDragAndDropAdapter.java
--- a/packages/apps/Settings/src/com/android/settings/localepicker/LocaleDragAndDropAdapter.java	2018-08-06 15:43:03.017218427 +0200
+++ b/packages/apps/Settings/src/com/android/settings/localepicker/LocaleDragAndDropAdapter.java	2017-11-23 05:22:41.000000000 +0100
@@ -257,8 +257,9 @@
     }
 
     void addLocale(LocaleStore.LocaleInfo li) {
+        mFeedItemList.clear();
         mFeedItemList.add(li);
-        notifyItemInserted(mFeedItemList.size() - 1);
+        //notifyItemInserted(mFeedItemList.size() - 1);
         doTheUpdate();
     }
 
Only in b/packages/apps/Settings/src/com/android/settings/notification: AudioChannelsSelect.java
diff -ur a/packages/apps/Settings/src/com/android/settings/notification/SoundSettings.java b/packages/apps/Settings/src/com/android/settings/notification/SoundSettings.java
--- a/packages/apps/Settings/src/com/android/settings/notification/SoundSettings.java	2018-08-06 15:43:03.025218531 +0200
+++ b/packages/apps/Settings/src/com/android/settings/notification/SoundSettings.java	2017-11-23 05:22:41.000000000 +0100
@@ -51,6 +51,7 @@
 import android.text.TextUtils;
 import android.util.Log;
 
+
 import com.android.internal.logging.MetricsProto.MetricsEvent;
 import com.android.settings.R;
 import com.android.settings.RingtonePreference;
@@ -84,6 +85,8 @@
     private static final String KEY_WIFI_DISPLAY = "wifi_display";
     private static final String KEY_ZEN_MODE = "zen_mode";
     private static final String KEY_CELL_BROADCAST_SETTINGS = "cell_broadcast_settings";
+    private static final String KEY_AUDIO_OUTPUT_MODE = "audio_output_mode";
+    private static final String KEY_ENABLE_PASS_THROUGH = "enable_pass_through";
 
     private static final String SELECTED_PREFERENCE_KEY = "selected_preference";
     private static final int REQUEST_CODE = 200;
@@ -120,6 +123,9 @@
     private PackageManager mPm;
     private UserManager mUserManager;
     private RingtonePreference mRequestPreference;
+    private Preference mAudioOutputPreference;
+    private AudioChannelsSelect mAudioSelector;
+    private TwoStatePreference mEnablePassThrough;
 
     @Override
     protected int getMetricsCategory() {
@@ -187,6 +193,17 @@
                 mRequestPreference = (RingtonePreference) findPreference(selectedPreference);
             }
         }
+	removePreference(KEY_ALARM_VOLUME);
+	removePreference(KEY_RING_VOLUME);
+	removePreference(KEY_ALARM_RINGTONE);
+	removePreference(KEY_VIBRATE_WHEN_RINGING);
+	removePreference(KEY_PHONE_RINGTONE);
+	removePreference(KEY_ZEN_MODE);
+        mAudioOutputPreference = findPreference(KEY_AUDIO_OUTPUT_MODE);
+        mAudioSelector = new AudioChannelsSelect(getActivity());
+        mEnablePassThrough = (TwoStatePreference) findPreference(KEY_ENABLE_PASS_THROUGH);
+        mEnablePassThrough.setChecked(Settings.System.getInt(getContentResolver(),
+                Settings.System.ENABLE_PASS_THROUGH, 0) != 0);
     }
 
     @Override
@@ -235,6 +252,16 @@
 
     @Override
     public boolean onPreferenceTreeClick(Preference preference) {
+        if (preference == mEnablePassThrough) {
+            Log.d(TAG, "passthrough.");
+            Settings.System.putInt(getContentResolver(), Settings.System.ENABLE_PASS_THROUGH,
+                mEnablePassThrough.isChecked() ? 1 : 0);
+            return true;
+        }
+        if (preference == mAudioOutputPreference) {
+            mAudioSelector.showChannelsSelectDialog();
+            return true;
+        }
         if (preference instanceof RingtonePreference) {
             mRequestPreference = (RingtonePreference) preference;
             mRequestPreference.onPrepareRingtonePickerIntent(mRequestPreference.getIntent());
Only in b/packages/apps/Settings/src/com/android/settings: pipSettings
Only in b/packages/apps/Settings/src/com/android/settings: pppoe
diff -ur a/packages/apps/Settings/src/com/android/settings/PrivacySettings.java b/packages/apps/Settings/src/com/android/settings/PrivacySettings.java
--- a/packages/apps/Settings/src/com/android/settings/PrivacySettings.java	2018-08-06 15:43:02.941217453 +0200
+++ b/packages/apps/Settings/src/com/android/settings/PrivacySettings.java	2017-11-23 05:22:41.000000000 +0100
@@ -246,8 +246,8 @@
                                     R.string.backup_configure_account_default_summary));
                         }
                     } else {
-                        mSummaryLoader.setSummary(this, mContext.getString(
-                                R.string.backup_disabled));
+                        /*mSummaryLoader.setSummary(this, mContext.getString(
+                                R.string.backup_disabled));*/
                     }
                 } catch (RemoteException e) {
                 }
diff -ur a/packages/apps/Settings/src/com/android/settings/SettingsActivity.java b/packages/apps/Settings/src/com/android/settings/SettingsActivity.java
--- a/packages/apps/Settings/src/com/android/settings/SettingsActivity.java	2018-08-06 15:43:02.953217607 +0200
+++ b/packages/apps/Settings/src/com/android/settings/SettingsActivity.java	2017-11-23 05:22:41.000000000 +0100
@@ -35,6 +35,7 @@
 import android.os.Bundle;
 import android.os.UserHandle;
 import android.os.UserManager;
+import android.os.SystemProperties;
 import android.support.v14.preference.PreferenceFragment;
 import android.support.v7.preference.Preference;
 import android.support.v7.preference.PreferenceManager;
@@ -124,6 +125,8 @@
 import com.android.settings.wifi.WifiInfo;
 import com.android.settings.wifi.WifiSettings;
 import com.android.settings.wifi.p2p.WifiP2pSettings;
+import com.android.settings.ethernet.EthernetSettings;
+import com.android.settings.pppoe.PppoeSettings;
 import com.android.settingslib.drawer.DashboardCategory;
 import com.android.settingslib.drawer.SettingsDrawerActivity;
 import com.android.settingslib.drawer.Tile;
@@ -228,6 +231,8 @@
     private String[] SETTINGS_FOR_RESTRICTED = {
             //wireless_section
             WifiSettingsActivity.class.getName(),
+            Settings.EthernetSettingsActivity.class.getName(),
+            Settings.PppoeSettingsActivity.class.getName(),
             Settings.BluetoothSettingsActivity.class.getName(),
             Settings.DataUsageSummaryActivity.class.getName(),
             Settings.SimSettingsActivity.class.getName(),
@@ -236,6 +241,7 @@
             Settings.HomeSettingsActivity.class.getName(),
             Settings.SoundSettingsActivity.class.getName(),
             Settings.DisplaySettingsActivity.class.getName(),
+	    Settings.HDRSettingsActivity.class.getName(),
             Settings.StorageSettingsActivity.class.getName(),
             Settings.ManageApplicationsActivity.class.getName(),
             Settings.PowerUsageSummaryActivity.class.getName(),
@@ -345,8 +351,14 @@
             TestingSettings.class.getName(),
             WifiAPITest.class.getName(),
             WifiInfo.class.getName(),
+            EthernetSettings.class.getName(),
+            PppoeSettings.class.getName(),
+	    HDRSettings.class.getName()
     };
 
+    private static final String ACTION_USBBTDEV_CHANGE = "action.android.usbbt.change";
+
+    private String[] btModuleList = {"ap6210", "ap6330", "ap6335", "rtl8723bs", "ap6212", "rtl8723bu", "ap6356s", "ap6255"};
 
     private static final String[] LIKE_SHORTCUT_INTENT_ACTION_ARRAY = {
             "android.settings.APPLICATION_DETAILS_SETTINGS"
@@ -382,6 +394,16 @@
         }
     };
 
+    private BroadcastReceiver mUSBBTReceiver = new BroadcastReceiver() {
+        @Override
+        public void onReceive(Context context, Intent intent) {
+            String action = intent.getAction();
+            if (action.equals(ACTION_USBBTDEV_CHANGE)) {
+                updateTilesList();
+            }
+        }
+    };
+
     private final DynamicIndexableContentMonitor mDynamicIndexableContentMonitor =
             new DynamicIndexableContentMonitor();
 
@@ -634,6 +656,7 @@
         mSwitchBar = (SwitchBar) findViewById(R.id.switch_bar);
         if (mSwitchBar != null) {
             mSwitchBar.setMetricsTag(getMetricsTag());
+	    mSwitchBar.requestFocus();
         }
 
         // see if we should show Back/Next buttons
@@ -813,6 +836,7 @@
         registerReceiver(mBatteryInfoReceiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
         registerReceiver(mUserAddRemoveReceiver, new IntentFilter(Intent.ACTION_USER_ADDED));
         registerReceiver(mUserAddRemoveReceiver, new IntentFilter(Intent.ACTION_USER_REMOVED));
+        registerReceiver(mUSBBTReceiver, new IntentFilter(ACTION_USBBTDEV_CHANGE));
 
         mDynamicIndexableContentMonitor.register(this, LOADER_ID_INDEXABLE_CONTENT_MONITOR);
 
@@ -827,6 +851,7 @@
         super.onStop();
         unregisterReceiver(mBatteryInfoReceiver);
         unregisterReceiver(mUserAddRemoveReceiver);
+        unregisterReceiver(mUSBBTReceiver);
         mDynamicIndexableContentMonitor.unregister();
     }
 
@@ -1038,6 +1063,31 @@
         });
     }
 
+    private boolean hasBluetooth() {
+        PackageManager pm = getPackageManager();
+        if (!(pm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)))
+            return false;
+
+        String str = SystemProperties.get("wlan.hardware.info", "null");
+
+        if ((str != null) && (!str.equals("null"))) {
+            String[] val = str.split(":");
+            if ((val != null) && (val.length > 1) && (val[1] != null)) {
+                for (String s : btModuleList) {
+                    if ((val[1]).equals(s)) {
+                        return true;
+                    }
+                }
+            }
+        }
+
+        str = SystemProperties.get("sys.usbbt.inserted", "0");
+        if (str.equals("1"))
+            return true;
+
+        return false;
+    }
+
     private void doUpdateTilesList() {
         PackageManager pm = getPackageManager();
         final UserManager um = UserManager.get(this);
@@ -1048,8 +1098,20 @@
                 pm.hasSystemFeature(PackageManager.FEATURE_WIFI), isAdmin, pm);
 
         setTileEnabled(new ComponentName(packageName,
+                Settings.EthernetSettingsActivity.class.getName()),
+                pm.hasSystemFeature(PackageManager.FEATURE_ETHERNET), isAdmin, pm);
+        setTileEnabled(new ComponentName(packageName,
+                Settings.PppoeSettingsActivity.class.getName()),
+                pm.hasSystemFeature(PackageManager.FEATURE_PPPOE), isAdmin, pm);
+
+        setTileEnabled(new ComponentName(packageName,
+                Settings.HDRSettingsActivity.class.getName()),
+                true, isAdmin, pm);
+
+
+        setTileEnabled(new ComponentName(packageName,
                 Settings.BluetoothSettingsActivity.class.getName()),
-                pm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH), isAdmin, pm);
+                hasBluetooth(), isAdmin, pm);
 
         setTileEnabled(new ComponentName(packageName,
                 Settings.DataUsageSummaryActivity.class.getName()),
@@ -1061,7 +1123,7 @@
 
         setTileEnabled(new ComponentName(packageName,
                 Settings.PowerUsageSummaryActivity.class.getName()),
-                mBatteryPresent, isAdmin, pm);
+                false, isAdmin, pm);
 
         setTileEnabled(new ComponentName(packageName,
                 Settings.UserSettingsActivity.class.getName()),
diff -ur a/packages/apps/Settings/src/com/android/settings/Settings.java b/packages/apps/Settings/src/com/android/settings/Settings.java
--- a/packages/apps/Settings/src/com/android/settings/Settings.java	2018-08-06 15:43:02.945217505 +0200
+++ b/packages/apps/Settings/src/com/android/settings/Settings.java	2017-11-23 05:22:41.000000000 +0100
@@ -155,4 +155,7 @@
     public static class DeviceSettings extends SettingsActivity { /* empty */ }
     public static class PersonalSettings extends SettingsActivity { /* empty */ }
     public static class SystemSettings extends SettingsActivity { /* empty */ }
+    public static class EthernetSettingsActivity extends SettingsActivity { /* empty */ }
+    public static class PppoeSettingsActivity extends SettingsActivity { /* empty */ }
+    public static class HDRSettingsActivity extends SettingsActivity { /* empty */ }
 }
diff -ur a/packages/apps/Settings/src/com/android/settings/wifi/WifiConfigController.java b/packages/apps/Settings/src/com/android/settings/wifi/WifiConfigController.java
--- a/packages/apps/Settings/src/com/android/settings/wifi/WifiConfigController.java	2018-08-06 15:43:03.037218684 +0200
+++ b/packages/apps/Settings/src/com/android/settings/wifi/WifiConfigController.java	2017-11-23 05:22:41.000000000 +0100
@@ -695,8 +695,8 @@
             staticIpConfiguration.ipAddress = new LinkAddress(inetAddr, networkPrefixLength);
         } catch (NumberFormatException e) {
             // Set the hint as default after user types in ip address
-            mNetworkPrefixLengthView.setText(mConfigUi.getContext().getString(
-                    R.string.wifi_network_prefix_length_hint));
+            //mNetworkPrefixLengthView.setText(mConfigUi.getContext().getString(
+            //        R.string.wifi_network_prefix_length_hint));
         } catch (IllegalArgumentException e) {
             return R.string.wifi_ip_settings_invalid_ip_address;
         }
@@ -708,10 +708,11 @@
                 InetAddress netPart = NetworkUtils.getNetworkPart(inetAddr, networkPrefixLength);
                 byte[] addr = netPart.getAddress();
                 addr[addr.length - 1] = 1;
-                mGatewayView.setText(InetAddress.getByAddress(addr).getHostAddress());
+                //mGatewayView.setText(InetAddress.getByAddress(addr).getHostAddress());
             } catch (RuntimeException ee) {
-            } catch (java.net.UnknownHostException u) {
             }
+            //catch (java.net.UnknownHostException u) {
+            //}
         } else {
             InetAddress gatewayAddr = getIPv4Address(gateway);
             if (gatewayAddr == null) {
@@ -728,7 +729,7 @@
 
         if (TextUtils.isEmpty(dns)) {
             //If everything else is valid, provide hint as a default option
-            mDns1View.setText(mConfigUi.getContext().getString(R.string.wifi_dns1_hint));
+            //mDns1View.setText(mConfigUi.getContext().getString(R.string.wifi_dns1_hint));
         } else {
             dnsAddr = getIPv4Address(dns);
             if (dnsAddr == null) {
diff -ur a/packages/apps/Settings/src/com/android/settings/wifi/WifiSetupActivity.java b/packages/apps/Settings/src/com/android/settings/wifi/WifiSetupActivity.java
--- a/packages/apps/Settings/src/com/android/settings/wifi/WifiSetupActivity.java	2018-08-06 15:43:03.041218736 +0200
+++ b/packages/apps/Settings/src/com/android/settings/wifi/WifiSetupActivity.java	2017-11-23 05:22:41.000000000 +0100
@@ -110,7 +110,6 @@
         super.onRestoreInstanceState(savedInstanceState);
         mUserSelectedNetwork = savedInstanceState.getBoolean(PARAM_USER_SELECTED_NETWORK, true);
     }
-
     private boolean isWifiConnected() {
         final ConnectivityManager connectivity = (ConnectivityManager)
                 getSystemService(Context.CONNECTIVITY_SERVICE);
@@ -121,7 +120,7 @@
     }
 
     private void refreshConnectionState() {
-        if (isWifiConnected()) {
+		if (isWifiConnected()) {
             if (mAutoFinishOnConnection && mUserSelectedNetwork) {
                 Log.d(TAG, "Auto-finishing with connection");
                 finish(Activity.RESULT_OK);
diff -ur a/packages/apps/TvSettings/Settings/AndroidManifest.xml b/packages/apps/TvSettings/Settings/AndroidManifest.xml
--- a/packages/apps/TvSettings/Settings/AndroidManifest.xml	2018-08-06 15:43:12.541340537 +0200
+++ b/packages/apps/TvSettings/Settings/AndroidManifest.xml	2017-11-23 05:22:55.000000000 +0100
@@ -395,12 +395,14 @@
             android:configChanges="keyboard|keyboardHidden|navigation"
             android:excludeFromRecents="true"
             android:exported="true" />
+<!--
         <activity
             android:name=".accessories.BluetoothAccessoryActivity"
             android:theme="@style/Theme.Settings.Transparent"
             android:configChanges="keyboard|keyboardHidden|navigation"
             android:excludeFromRecents="true"
             android:exported="true" />
+-->
         <activity
             android:name=".accessories.AddAccessoryActivity"
             android:configChanges="keyboard|keyboardHidden|navigation"
@@ -416,6 +418,7 @@
             </intent-filter>
         </activity>
 
+<!--
         <receiver android:name=".accessories.BluetoothConnectionsManager" >
             <intent-filter>
                 <action android:name="android.bluetooth.device.action.ACL_CONNECTED" />
@@ -423,13 +426,15 @@
                 <action android:name="android.bluetooth.adapter.action.STATE_CHANGED" />
             </intent-filter>
         </receiver>
-
+-->
+<!--
         <receiver android:name=".accessories.BluetoothPairingRequest" >
             <intent-filter>
                 <action android:name="android.bluetooth.device.action.PAIRING_REQUEST" />
             </intent-filter>
         </receiver>
-
+-->
+<!--
         <activity
             android:name=".accessories.BluetoothPairingDialog"
             android:configChanges="keyboard|keyboardHidden|navigation"
@@ -441,6 +446,8 @@
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </activity>
+-->
+<!--
         <activity
             android:name=".accessories.BluetoothDevicePickerActivity"
             android:configChanges="keyboard|keyboardHidden|navigation"
@@ -452,6 +459,7 @@
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </activity>
+-->
         <activity
             android:name=".about.AboutActivity"
             android:theme="@style/Theme.Settings.Transparent"
@@ -536,6 +544,7 @@
             android:excludeFromRecents="true"
             android:exported="false" />
 
+<!--
         <activity android:name=".accessories.BluetoothRequestPermissionActivity"
             android:label="@string/bluetooth_permission_request"
             android:excludeFromRecents="true"
@@ -547,6 +556,7 @@
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </activity>
+-->
 
         <!-- Triggered when user-selected home app isn't encryption aware -->
         <activity android:name=".system.FallbackHome"
@@ -554,7 +564,7 @@
                   android:theme="@style/FallbackHome">
             <intent-filter android:priority="-1000">
                 <action android:name="android.intent.action.MAIN" />
-                <category android:name="android.intent.category.HOME" />
+                <!--<category android:name="android.intent.category.HOME" /> -->
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
         </activity>
diff -ur a/packages/apps/TvSettings/Settings/res/xml/main_prefs.xml b/packages/apps/TvSettings/Settings/res/xml/main_prefs.xml
--- a/packages/apps/TvSettings/Settings/res/xml/main_prefs.xml	2018-08-06 15:43:12.785343665 +0200
+++ b/packages/apps/TvSettings/Settings/res/xml/main_prefs.xml	2017-11-23 05:22:55.000000000 +0100
@@ -116,6 +116,8 @@
             android:title="@string/system_developer_options"
             android:fragment="com.android.tv.settings.system.development.DevelopmentFragment" />
     </PreferenceCategory>
+
+<!--
     <PreferenceCategory
         android:key="accessories"
         android:title="@string/header_category_accessories">
@@ -128,6 +130,7 @@
                 android:targetPackage="com.android.tv.settings" />
         </Preference>
     </PreferenceCategory>
+-->
 
     <PreferenceCategory
         android:key="personal"
diff -ur a/packages/apps/TvSettings/Settings/src/com/android/tv/settings/device/storage/NewStorageActivity.java b/packages/apps/TvSettings/Settings/src/com/android/tv/settings/device/storage/NewStorageActivity.java
--- a/packages/apps/TvSettings/Settings/src/com/android/tv/settings/device/storage/NewStorageActivity.java	2018-08-06 15:43:12.817344076 +0200
+++ b/packages/apps/TvSettings/Settings/src/com/android/tv/settings/device/storage/NewStorageActivity.java	2017-11-23 05:22:55.000000000 +0100
@@ -444,10 +444,10 @@
                 }
                 final DiskInfo disk = info.getDisk();
                 if (disk.isAdoptable()) {
-                    final Intent i = NewStorageActivity.getNewStorageLaunchIntent(context,
-                            volumeId, disk.getId());
-                    setPopupLaunchFlags(i);
-                    context.startActivity(i);
+                    //final Intent i = NewStorageActivity.getNewStorageLaunchIntent(context,
+                    //        volumeId, disk.getId());
+                    //setPopupLaunchFlags(i);
+                    //context.startActivity(i);
                     break;
                 }
             }
diff -ur a/packages/apps/TvSettings/Settings/src/com/android/tv/settings/MainFragment.java b/packages/apps/TvSettings/Settings/src/com/android/tv/settings/MainFragment.java
--- a/packages/apps/TvSettings/Settings/src/com/android/tv/settings/MainFragment.java	2018-08-06 15:43:12.785343665 +0200
+++ b/packages/apps/TvSettings/Settings/src/com/android/tv/settings/MainFragment.java	2017-11-23 05:22:55.000000000 +0100
@@ -123,11 +123,11 @@
         final TvInputManager manager = (TvInputManager) getContext().getSystemService(
                 Context.TV_INPUT_SERVICE);
         if (manager != null) {
-            for (final TvInputInfo input : manager.getTvInputList()) {
+            /*for (final TvInputInfo input : manager.getTvInputList()) {
                 if (input.isPassthroughInput()) {
                     mInputSettingNeeded = true;
                 }
-            }
+            }*/
         }
         super.onCreate(savedInstanceState);
     }
diff -ur a/packages/apps/TvSettings/Settings/src/com/android/tv/settings/MainSettings.java b/packages/apps/TvSettings/Settings/src/com/android/tv/settings/MainSettings.java
--- a/packages/apps/TvSettings/Settings/src/com/android/tv/settings/MainSettings.java	2018-08-06 15:43:12.785343665 +0200
+++ b/packages/apps/TvSettings/Settings/src/com/android/tv/settings/MainSettings.java	2017-11-23 05:22:55.000000000 +0100
@@ -17,6 +17,7 @@
 package com.android.tv.settings;
 
 import android.app.Fragment;
+import android.view.KeyEvent;
 
 /**
  * Main settings which loads up the top level headers.
@@ -40,4 +41,13 @@
             startPreferenceFragment(fragment);
         }
     }
+
+    @Override
+    public boolean onKeyDown(int keyCode, KeyEvent event) {
+        if(keyCode == KeyEvent.KEYCODE_SETTINGS) {
+            super.finish();
+        }
+        return super.onKeyDown(keyCode,event);
+    }
+
 }
diff -ur a/packages/apps/TvSettings/Settings/src/com/android/tv/settings/system/development/DevelopmentFragment.java b/packages/apps/TvSettings/Settings/src/com/android/tv/settings/system/development/DevelopmentFragment.java
--- a/packages/apps/TvSettings/Settings/src/com/android/tv/settings/system/development/DevelopmentFragment.java	2018-08-06 15:43:12.825344178 +0200
+++ b/packages/apps/TvSettings/Settings/src/com/android/tv/settings/system/development/DevelopmentFragment.java	2017-11-23 05:22:55.000000000 +0100
@@ -670,7 +670,7 @@
 
     private void updatePasswordSummary() {
         try {
-            if (mBackupManager.hasBackupPassword()) {
+            if (mBackupManager!=null&&mBackupManager.hasBackupPassword()) {
                 mPassword.setSummary(R.string.local_backup_password_summary_change);
             } else {
                 mPassword.setSummary(R.string.local_backup_password_summary_none);
diff -ur a/packages/inputmethods/LatinIME/java/res/values/config-common.xml b/packages/inputmethods/LatinIME/java/res/values/config-common.xml
--- a/packages/inputmethods/LatinIME/java/res/values/config-common.xml	2018-08-06 15:43:18.013410691 +0200
+++ b/packages/inputmethods/LatinIME/java/res/values/config-common.xml	2017-11-23 05:22:57.000000000 +0100
@@ -44,9 +44,9 @@
     <bool name="config_default_vibration_enabled">true</bool>
     <integer name="config_max_vibration_duration">100</integer>
 
-    <integer name="config_default_longpress_key_timeout">300</integer>
-    <integer name="config_max_longpress_timeout">700</integer>
-    <integer name="config_min_longpress_timeout">100</integer>
+    <integer name="config_default_longpress_key_timeout">3000</integer>
+    <integer name="config_max_longpress_timeout">3000</integer>
+    <integer name="config_min_longpress_timeout">3000</integer>
     <integer name="config_longpress_timeout_step">10</integer>
     <integer name="config_accessibility_long_press_key_timeout">3000</integer>
     <integer name="config_max_more_keys_column">5</integer>
@@ -107,7 +107,7 @@
     <!-- Common suggestion strip configuration. -->
     <integer name="config_suggestions_count_in_strip">3</integer>
     <fraction name="config_center_suggestion_percentile">36%</fraction>
-    <integer name="config_delay_in_milliseconds_to_update_suggestions">100</integer>
+    <integer name="config_delay_in_milliseconds_to_update_suggestions">3000</integer>
     <integer name="config_delay_in_milliseconds_to_update_old_suggestions">300</integer>
 
     <!-- Common more suggestions configuraion. -->
diff -ur a/packages/inputmethods/LatinIME/java/res/values/config-per-form-factor.xml b/packages/inputmethods/LatinIME/java/res/values/config-per-form-factor.xml
--- a/packages/inputmethods/LatinIME/java/res/values/config-per-form-factor.xml	2018-08-06 15:43:18.013410691 +0200
+++ b/packages/inputmethods/LatinIME/java/res/values/config-per-form-factor.xml	2017-11-23 05:22:57.000000000 +0100
@@ -23,7 +23,7 @@
     <bool name="config_enable_show_key_preview_popup_option">true</bool>
     <!-- Whether or not Popup on key press is enabled by default -->
     <bool name="config_default_key_preview_popup">true</bool>
-    <bool name="config_default_sound_enabled">false</bool>
+    <bool name="config_default_sound_enabled">true</bool>
     <bool name="config_enable_show_voice_key_option">true</bool>
     <bool name="config_key_selection_by_dragging_finger">true</bool>
     <!-- Showing more keys keyboard, just above the touched point if true, aligned to the key if
diff -ur a/packages/inputmethods/LatinIME/java/res/values-sw430dp/config-per-form-factor.xml b/packages/inputmethods/LatinIME/java/res/values-sw430dp/config-per-form-factor.xml
--- a/packages/inputmethods/LatinIME/java/res/values-sw430dp/config-per-form-factor.xml	2018-08-06 15:43:17.993410435 +0200
+++ b/packages/inputmethods/LatinIME/java/res/values-sw430dp/config-per-form-factor.xml	2017-11-23 05:22:57.000000000 +0100
@@ -23,7 +23,7 @@
     <bool name="config_enable_show_key_preview_popup_option">true</bool>
     <!-- Whether or not Popup on key press is enabled by default -->
     <bool name="config_default_key_preview_popup">true</bool>
-    <bool name="config_default_sound_enabled">false</bool>
+    <bool name="config_default_sound_enabled">true</bool>
     <bool name="config_enable_show_voice_key_option">true</bool>
     <bool name="config_key_selection_by_dragging_finger">true</bool>
     <!-- Showing more keys keyboard, just above the touched point if true, aligned to the key if
diff -ur a/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/keyboard/Keyboard.java b/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/keyboard/Keyboard.java
--- a/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/keyboard/Keyboard.java	2018-08-06 15:43:18.041411049 +0200
+++ b/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/keyboard/Keyboard.java	2017-11-23 05:22:57.000000000 +0100
@@ -27,7 +27,7 @@
 import java.util.ArrayList;
 import java.util.Collections;
 import java.util.List;
-
+import android.util.Log;
 import javax.annotation.Nonnull;
 import javax.annotation.Nullable;
 
@@ -91,6 +91,8 @@
     @Nonnull
     public final KeyboardIconsSet mIconsSet;
 
+	private final String TAG = "Keyboard";
+
     private final SparseArray<Key> mKeyCache = new SparseArray<>();
 
     @Nonnull
@@ -119,7 +121,7 @@
         mShiftKeys = Collections.unmodifiableList(params.mShiftKeys);
         mAltCodeKeysWhileTyping = Collections.unmodifiableList(params.mAltCodeKeysWhileTyping);
         mIconsSet = params.mIconsSet;
-
+		mLastKey = null;
         mProximityInfo = new ProximityInfo(params.GRID_WIDTH, params.GRID_HEIGHT,
                 mOccupiedWidth, mOccupiedHeight, mMostCommonKeyWidth, mMostCommonKeyHeight,
                 mSortedKeys, params.mTouchPositionCorrection);
@@ -220,8 +222,46 @@
             }
         }
         return false;
+	}
+    public static boolean isLetterCode(final int code) {
+        return code >= Constants.CODE_SPACE;
+    }
+
+    /* add by Chenjd. start {{---------------------------- */
+    /* 2013-3-4 */
+    /* make LatinIME support key operation */
+    private static Key mLastKey = null;
+    private static Key mCurrentKey = null;
+	
+    /** provide mLastKey access */
+    public Key getLastKey() {
+        if(mLastKey == null && mSortedKeys != null && mSortedKeys.size() != 0){
+			mLastKey = (mCurrentKey == null)?getSortedKeys().get(0):mCurrentKey;
+        }
+        return mLastKey;
+    }
+
+    public int findKeyIndex(Key key){
+        if(mSortedKeys == null) {
+            return -1;
+        }
+        for(int i = 0; i < mSortedKeys.size(); i++){
+            if(key == mSortedKeys.get(i)){
+                return i;
+            }
+        }
+        return -1;
     }
 
+    public void setCurrentKey(Key key) {
+        mCurrentKey = key;
+    }
+
+    /** set key index */
+    public void setLastKey(Key key) {
+        mLastKey = key;
+    }
+    /* add by Chenjd. end --------------------------------}} */
     @Override
     public String toString() {
         return mId.toString();
diff -ur a/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/keyboard/MainKeyboardView.java b/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/keyboard/MainKeyboardView.java
--- a/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/keyboard/MainKeyboardView.java	2018-08-06 15:43:18.041411049 +0200
+++ b/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/keyboard/MainKeyboardView.java	2017-11-23 05:22:57.000000000 +0100
@@ -63,6 +63,12 @@
 import java.util.Locale;
 import java.util.WeakHashMap;
 
+import android.graphics.Rect;
+import android.graphics.Color;
+import android.graphics.Paint.Style;
+import java.util.ArrayList;
+import java.util.List;
+
 import javax.annotation.Nonnull;
 import javax.annotation.Nullable;
 
@@ -151,6 +157,7 @@
 
     // More keys keyboard
     private final Paint mBackgroundDimAlphaPaint = new Paint();
+    private boolean mNeedsToDimEntireKeyboard;
     private final View mMoreKeysKeyboardContainer;
     private final View mMoreKeysKeyboardForActionContainer;
     private final WeakHashMap<Key, Keyboard> mMoreKeysKeyboardCache = new WeakHashMap<>();
@@ -801,6 +808,62 @@
         invalidateKey(mSpaceKey);
     }
 
+    private void dimEntireKeyboard(final boolean dimmed) {
+        final boolean needsRedrawing = mNeedsToDimEntireKeyboard != dimmed;
+        mNeedsToDimEntireKeyboard = dimmed;
+        if (needsRedrawing) {
+            invalidateAllKeys();
+        }
+    }
+
+    private int abs(int value){
+        return value >= 0? value: -value;
+    }
+
+    @Override
+    protected void onDraw(final Canvas canvas) {
+        super.onDraw(canvas);
+        Keyboard currentKeyboard = getKeyboard();
+        List<Key> keys = currentKeyboard.getSortedKeys();
+        Paint p = new Paint();
+        p.setColor(Color.GREEN);
+        p.setStyle(Style.STROKE);
+        p.setStrokeWidth(3.75f);
+		Key mLastKey = currentKeyboard.getLastKey();
+        if(mLastKey == null && keys != null && keys.size() != 0) {
+            mLastKey = keys.get(0);
+        }
+        else {
+            Key mostMatchKey = null;
+            int distX;
+            int distY;
+            int dist=99999;
+            List<Key> nearestKeyIndices = currentKeyboard.getNearestKeys(mLastKey.getX(),mLastKey.getY());
+            for(int i = 0; i < nearestKeyIndices.size(); i++){
+                Key nearKey = nearestKeyIndices.get(i);
+                distX = abs(mLastKey.getX() - nearKey.getX());
+                distY = abs(mLastKey.getY() - nearKey.getY());
+                if ( distX+distY < dist ) {
+                    mostMatchKey = nearKey;
+                    dist = distX+distY;
+                }
+            }
+            if (mostMatchKey != null) {
+                mLastKey = mostMatchKey;
+            }
+        }
+        Rect rect = new Rect(
+                mLastKey.getX(), mLastKey.getY(),
+                mLastKey.getX() + mLastKey.getWidth(),
+                mLastKey.getY() + mLastKey.getHeight()
+            );
+        canvas.drawRect(rect, p);
+        // Overlay a dark rectangle to dim.
+        if (mNeedsToDimEntireKeyboard) {
+            canvas.drawRect(0.0f, 0.0f, getWidth(), getHeight(), mBackgroundDimAlphaPaint);
+        }
+    }
+
     @Override
     protected void onDrawKeyTopVisuals(final Key key, final Canvas canvas, final Paint paint,
             final KeyDrawParams params) {
@@ -892,4 +955,9 @@
         super.deallocateMemory();
         mDrawingPreviewPlacerView.deallocateMemory();
     }
+
+	/* add by Chenjd. start {{----------------------------------- */
+    /* 2013-3-13 */
+    /* make LatinIME support key operations */
+    /* add by Chenjd. end   -----------------------------------}} */
 }
diff -ur a/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/latin/LatinIME.java b/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/latin/LatinIME.java
--- a/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/latin/LatinIME.java	2018-08-06 15:43:18.057411254 +0200
+++ b/packages/inputmethods/LatinIME/java/src/com/android/inputmethod/latin/LatinIME.java	2017-11-23 05:22:57.000000000 +0100
@@ -37,6 +37,7 @@
 import android.os.Debug;
 import android.os.IBinder;
 import android.os.Message;
+import android.os.SystemClock;
 import android.preference.PreferenceManager;
 import android.text.InputType;
 import android.util.Log;
@@ -52,6 +53,8 @@
 import android.view.inputmethod.CompletionInfo;
 import android.view.inputmethod.EditorInfo;
 import android.view.inputmethod.InputMethodSubtype;
+import android.view.MotionEvent;
+import android.widget.TextView;
 
 import com.android.inputmethod.accessibility.AccessibilityUtils;
 import com.android.inputmethod.annotations.UsedForTesting;
@@ -104,7 +107,7 @@
 import java.util.List;
 import java.util.Locale;
 import java.util.concurrent.TimeUnit;
-
+import com.android.inputmethod.keyboard.Key;
 import javax.annotation.Nonnull;
 
 /**
@@ -165,7 +168,40 @@
     private final boolean mIsHardwareAcceleratedDrawingEnabled;
 
     private GestureConsumer mGestureConsumer = GestureConsumer.NULL_GESTURE_CONSUMER;
-
+	
+	/* add by chenjd. start {{----------------------------------- */
+	/* 2013-03-04 */
+	/* make LatinIME support key operations */
+
+	private int mCurKeyboardKeyNums = 0;
+	private Keyboard mCurrentKeyboard;
+	private List<Key> mKeys;
+	private Key mLastKey = null;
+	private Key mPreKey = null;
+	private MainKeyboardView mMainInputView;
+	private int accuracy = 3;
+
+	private boolean setFields(){
+		mMainInputView = mKeyboardSwitcher.getMainKeyboardView();
+		if(mMainInputView == null || !mMainInputView.isShown()){
+			return false;
+		}
+		mCurrentKeyboard = mMainInputView.getKeyboard();
+		mKeys = mCurrentKeyboard.getSortedKeys();
+		if(mKeys != null){
+			mCurKeyboardKeyNums = mKeys.size();
+		}else{
+			mCurKeyboardKeyNums = 0;
+			return false;
+		}
+		
+		mLastKey = mCurrentKeyboard.getLastKey();
+		if(mLastKey == null){
+			return false;
+		}
+		return true;
+	}
+	/* add by Chenjd. end ---------------------------------------}} */
     public final UIHandler mHandler = new UIHandler(this);
 
     public static final class UIHandler extends LeakGuardHandlerWrapper<LatinIME> {
@@ -1265,7 +1301,229 @@
         }
     }
 
-    int getCurrentAutoCapsState() {
+	/* add by chenjd.start {{------------------------------- */
+	/* 2013-3-5 */
+	/* make LatinIME support key operation */
+	private int abs(int value){
+		return value >= 0? value: -value;
+	}
+
+	private static final int UP = 0;
+	private static final int DOWN = 1;
+	private static final int LEFT = 2;
+	private static final int RIGHT = 3;
+	private Key findNearestKey(int direction,Key srcKey){
+		int i = 0;
+		int distX;
+		int tmpX = 9999;
+		int distY;
+		int tmpY = 9999;
+		Key retKey = null;
+		List<Key> nearestKeyIndices = null;
+
+
+		switch(direction){
+		case UP:
+			nearestKeyIndices = mCurrentKeyboard.getNearestKeys(srcKey.getX(),srcKey.getY());
+			for(i = 0; i < nearestKeyIndices.size(); i++){
+				Key nearKey = nearestKeyIndices.get(i);
+				distY = srcKey.getY() - nearKey.getY();
+				if(distY >= nearKey.getHeight()){
+					distX = abs(nearKey.getX() - srcKey.getX());
+					if((distY < tmpY) ||
+						(distY == tmpY && distX <= tmpX)){
+						retKey = nearKey;
+						tmpY = distY;
+						tmpX = distX;
+
+					}
+				}
+			}
+			break;
+		case DOWN:
+			nearestKeyIndices = mCurrentKeyboard.getNearestKeys(srcKey.getX(),srcKey.getY());
+			for(i = 0; i < nearestKeyIndices.size(); i++){
+				Key nearKey = nearestKeyIndices.get(i);
+				distY = nearKey.getY() - srcKey.getY();
+				if(distY >= srcKey.getHeight()){
+					distX = abs(nearKey.getX() - srcKey.getX());
+					if((distY < tmpY) ||
+						(distY == tmpY && distX <= tmpX)){
+						retKey = nearKey;
+						tmpY = distY;
+						tmpX = distX;
+					}
+				}
+			}
+			break;
+		case LEFT:
+			for(i = 0; i < mKeys.size(); i++){
+				Key nearKey = mKeys.get(i);
+				int dY = nearKey.getY() - srcKey.getY();
+				if((dY >= (0 - accuracy)) && (dY <= accuracy)){
+					distX = srcKey.getX() - nearKey.getX();
+					if(distX >= nearKey.getWidth() && distX <= tmpX){
+						retKey= nearKey;
+						tmpX = distX;
+					}
+				}
+			}
+
+			break;
+		case RIGHT:
+			for(i = 0; i < mKeys.size(); i++){
+				Key nearKey = mKeys.get(i);
+				int dY = nearKey.getY() - srcKey.getY();
+				if((dY >= (0 - accuracy)) && (dY <= accuracy)){
+					distX = nearKey.getX() - srcKey.getX();
+					if(distX >= srcKey.getWidth() && distX <= tmpX){
+						retKey= nearKey;
+						tmpX = distX;
+					}
+				}
+			}
+			break;
+		}
+		return retKey;
+	}
+	
+	private Key circleToNextKey(int direction, Key srcKey) {
+		Key retKey = null;
+		int i = 0;
+		int distX;
+		int tmpX = 0;
+		switch (direction) {
+		case LEFT:
+			for (i = 0; i < mKeys.size(); i++) {
+				Key nearKey = mKeys.get(i);
+				int dY = nearKey.getY() - srcKey.getY();
+				if((dY >= (0 - accuracy)) && (dY <= accuracy)){
+					 distX = nearKey.getX() - srcKey.getX();
+					if (distX >= nearKey.getWidth() && distX >= tmpX) {
+						retKey = nearKey;
+						tmpX = distX;
+						}
+				}
+			}
+			
+
+			break;
+		case RIGHT:
+			for (i = 0; i < mKeys.size(); i++) {
+				Key nearKey = mKeys.get(i);
+				int dY = nearKey.getY() - srcKey.getY();
+				if ((dY >= (0 - accuracy)) && (dY <= accuracy)) {
+					distX = srcKey.getX() - nearKey.getX();
+					if (distX >= nearKey.getWidth() && distX >= tmpX) {
+						retKey = nearKey;
+						tmpX = distX;
+						}
+				}
+			}
+			break;
+		}
+		return retKey;
+	}
+
+	@Override
+	public boolean onKeyDown(int keyCode, KeyEvent event){
+		Key nearestKey = null;
+		switch(keyCode){
+		case KeyEvent.KEYCODE_DPAD_DOWN:
+			if(!setFields()){
+				break;
+			}
+			nearestKey = findNearestKey(DOWN, mLastKey);
+			if(nearestKey != null){
+				mCurrentKeyboard.setLastKey(nearestKey);
+				mCurrentKeyboard.setCurrentKey(nearestKey);
+			}
+			mMainInputView.invalidate();
+			return true;
+
+		case KeyEvent.KEYCODE_DPAD_UP:
+			if(!setFields()){
+				break;
+			}
+			nearestKey = findNearestKey(UP, mLastKey);
+			if(nearestKey != null){
+				mCurrentKeyboard.setLastKey(nearestKey);
+				mCurrentKeyboard.setCurrentKey(nearestKey);
+			}
+			mMainInputView.invalidate();
+			return true;
+
+		case KeyEvent.KEYCODE_DPAD_LEFT:
+			if(!setFields()){
+				break;
+			}
+			nearestKey = findNearestKey(LEFT, mLastKey);
+			if(nearestKey != null){
+				mCurrentKeyboard.setLastKey(nearestKey);
+				mCurrentKeyboard.setCurrentKey(nearestKey);
+			} else {
+				nearestKey = circleToNextKey(LEFT, mLastKey);
+				mCurrentKeyboard.setLastKey(nearestKey);
+				mCurrentKeyboard.setCurrentKey(nearestKey);
+			}
+			mMainInputView.invalidate();
+			return true;
+
+		case KeyEvent.KEYCODE_DPAD_RIGHT:
+			if(!setFields()){
+				break;
+			}
+			nearestKey = findNearestKey(RIGHT, mLastKey);
+			if(nearestKey != null){
+				mCurrentKeyboard.setLastKey(nearestKey);
+				mCurrentKeyboard.setCurrentKey(nearestKey);
+			} else {
+				nearestKey = circleToNextKey(RIGHT, mLastKey);
+				mCurrentKeyboard.setLastKey(nearestKey);
+				mCurrentKeyboard.setCurrentKey(nearestKey);
+			}
+			mMainInputView.invalidate();
+			return true;
+
+		case KeyEvent.KEYCODE_DPAD_CENTER:
+			if(!setFields()){
+				break;
+			}
+			if(mPreKey == mLastKey){
+				Log.d(TAG,"return true");
+				return true;
+			}
+			mPreKey = mLastKey;
+			Log.d(TAG,"X = " + mLastKey.getX() + " Y = " + mLastKey.getY());
+			final MotionEvent me = MotionEvent.obtain(SystemClock.uptimeMillis(), SystemClock.uptimeMillis(), MotionEvent.ACTION_DOWN, mLastKey.getX()+mLastKey.getWidth()/2, mLastKey.getY()+mLastKey.getHeight()/2, 0);
+			final MainKeyboardView tempInputView = mMainInputView;
+			if (mPreKey.getCode() == Constants.CODE_ENTER) {
+				mHandler.postDelayed (new Runnable(){
+					public void run(){
+						tempInputView.onTouchEvent(me);
+				}
+				}, 100);
+			} else {
+				tempInputView.onTouchEvent(me);
+			}
+			return true;
+		}
+        //if (!ProductionFlags.IS_HARDWARE_KEYBOARD_SUPPORTED) return super.onKeyDown(keyCode, event);
+        // onHardwareKeyEvent, like onKeyDown returns true if it handled the event, false if
+        // it doesn't know what to do with it and leave it to the application. For example,
+        // hardware key events for adjusting the screen's brightness are passed as is.
+        //if (mEventInterpreter.onHardwareKeyEvent(event)) {
+        //    final long keyIdentifier = event.getDeviceId() << 32 + event.getKeyCode();
+        //    mCurrentlyPressedHardwareKeys.add(keyIdentifier);
+        //    return true;
+        //}
+		return super.onKeyDown(keyCode, event);
+	}
+
+	/* add by Chenjd. end -----------------------------------}} */
+    // This will reset the whole input state to the starting state. It will clear
+    // the composing word, reset the last composed word, tell the inputconnection about it.
+    private int getCurrentAutoCapsState() {
         return mInputLogic.getCurrentAutoCapsState(mSettings.getCurrent());
     }
 
@@ -1686,13 +1944,9 @@
     }
 
     // Hooks for hardware keyboard
-    @Override
+/*    @Override
     public boolean onKeyDown(final int keyCode, final KeyEvent keyEvent) {
-        if (mEmojiAltPhysicalKeyDetector == null) {
-            mEmojiAltPhysicalKeyDetector = new EmojiAltPhysicalKeyDetector(
-                    getApplicationContext().getResources());
-        }
-        mEmojiAltPhysicalKeyDetector.onKeyDown(keyEvent);
+        mSpecialKeyDetector.onKeyDown(keyEvent);
         if (!ProductionFlags.IS_HARDWARE_KEYBOARD_SUPPORTED) {
             return super.onKeyDown(keyCode, keyEvent);
         }
@@ -1710,16 +1964,30 @@
         }
         return super.onKeyDown(keyCode, keyEvent);
     }
-
+*/
     @Override
     public boolean onKeyUp(final int keyCode, final KeyEvent keyEvent) {
-        if (mEmojiAltPhysicalKeyDetector == null) {
-            mEmojiAltPhysicalKeyDetector = new EmojiAltPhysicalKeyDetector(
-                    getApplicationContext().getResources());
-        }
-        mEmojiAltPhysicalKeyDetector.onKeyUp(keyEvent);
-        if (!ProductionFlags.IS_HARDWARE_KEYBOARD_SUPPORTED) {
+        /*if (!ProductionFlags.IS_HARDWARE_KEYBOARD_SUPPORTED) {
+			Log.d(TAG,"!ProductionFlags.IS_HARDWARE_KEYBOARD_SUPPORTED return");
             return super.onKeyUp(keyCode, keyEvent);
+        }*/
+	    switch (keyCode) {
+			case KeyEvent.KEYCODE_DPAD_CENTER:
+            if(!setFields())
+                break;
+            final MotionEvent me = MotionEvent.obtain(SystemClock.uptimeMillis(), SystemClock.uptimeMillis(), MotionEvent.ACTION_UP, mLastKey.getX() + mLastKey.getWidth()/2, mLastKey.getY() + mLastKey.getHeight()/2, 0);
+            final MainKeyboardView tempInputView = mMainInputView;
+            if (mPreKey.getCode() == Constants.CODE_ENTER) {
+                mHandler.postDelayed (new Runnable(){
+                    public void run(){
+                        tempInputView.onTouchEvent(me);
+                    }
+                }, 100);
+            } else {
+                tempInputView.onTouchEvent(me);
+            }
+            mPreKey = null;
+            break;
         }
         final long keyIdentifier = keyEvent.getDeviceId() << 32 + keyEvent.getKeyCode();
         if (mInputLogic.mCurrentlyPressedHardwareKeys.remove(keyIdentifier)) {
diff -ur a/packages/providers/MediaProvider/src/com/android/providers/media/MtpService.java b/packages/providers/MediaProvider/src/com/android/providers/media/MtpService.java
--- a/packages/providers/MediaProvider/src/com/android/providers/media/MtpService.java	2018-08-06 15:43:26.189515503 +0200
+++ b/packages/providers/MediaProvider/src/com/android/providers/media/MtpService.java	2017-11-23 05:22:59.000000000 +0100
@@ -140,7 +140,7 @@
 
     private void updateDisabledStateLocked() {
         final boolean isCurrentUser = UserHandle.myUserId() == ActivityManager.getCurrentUser();
-        mMtpDisabled = !mUnlocked || !isCurrentUser;
+        mMtpDisabled = false;
         if (LOGD) {
             Log.d(TAG, "updating state; isCurrentUser=" + isCurrentUser + ", mMtpLocked="
                     + mMtpDisabled);
